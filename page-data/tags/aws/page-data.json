{"componentChunkName":"component---src-templates-tag-js","path":"/tags/aws/","result":{"data":{"site":{"siteMetadata":{"title":"TOMOSIA VIETNAM","author":"「共に」「幸せ」「灯す」","labels":[{"tag":"javascript","tech":"JavaScript","name":"M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z","size":20,"color":"yellow"},{"tag":"react","tech":"React","name":"M12 9.861A2.139 2.139 0 1 0 12 14.139 2.139 2.139 0 1 0 12 9.861zM6.008 16.255l-.472-.12C2.018 15.246 0 13.737 0 11.996s2.018-3.25 5.536-4.139l.472-.119.133.468a23.53 23.53 0 0 0 1.363 3.578l.101.213-.101.213a23.307 23.307 0 0 0-1.363 3.578l-.133.467zM5.317 8.95c-2.674.751-4.315 1.9-4.315 3.046 0 1.145 1.641 2.294 4.315 3.046a24.95 24.95 0 0 1 1.182-3.046A24.752 24.752 0 0 1 5.317 8.95zM17.992 16.255l-.133-.469a23.357 23.357 0 0 0-1.364-3.577l-.101-.213.101-.213a23.42 23.42 0 0 0 1.364-3.578l.133-.468.473.119c3.517.889 5.535 2.398 5.535 4.14s-2.018 3.25-5.535 4.139l-.473.12zm-.491-4.259c.48 1.039.877 2.06 1.182 3.046 2.675-.752 4.315-1.901 4.315-3.046 0-1.146-1.641-2.294-4.315-3.046a24.788 24.788 0 0 1-1.182 3.046zM5.31 8.945l-.133-.467C4.188 4.992 4.488 2.494 6 1.622c1.483-.856 3.864.155 6.359 2.716l.34.349-.34.349a23.552 23.552 0 0 0-2.422 2.967l-.135.193-.235.02a23.657 23.657 0 0 0-3.785.61l-.472.119zm1.896-6.63c-.268 0-.505.058-.705.173-.994.573-1.17 2.565-.485 5.253a25.122 25.122 0 0 1 3.233-.501 24.847 24.847 0 0 1 2.052-2.544c-1.56-1.519-3.037-2.381-4.095-2.381zM16.795 22.677c-.001 0-.001 0 0 0-1.425 0-3.255-1.073-5.154-3.023l-.34-.349.34-.349a23.53 23.53 0 0 0 2.421-2.968l.135-.193.234-.02a23.63 23.63 0 0 0 3.787-.609l.472-.119.134.468c.987 3.484.688 5.983-.824 6.854a2.38 2.38 0 0 1-1.205.308zm-4.096-3.381c1.56 1.519 3.037 2.381 4.095 2.381h.001c.267 0 .505-.058.704-.173.994-.573 1.171-2.566.485-5.254a25.02 25.02 0 0 1-3.234.501 24.674 24.674 0 0 1-2.051 2.545zM18.69 8.945l-.472-.119a23.479 23.479 0 0 0-3.787-.61l-.234-.02-.135-.193a23.414 23.414 0 0 0-2.421-2.967l-.34-.349.34-.349C14.135 1.778 16.515.767 18 1.622c1.512.872 1.812 3.37.824 6.855l-.134.468zM14.75 7.24c1.142.104 2.227.273 3.234.501.686-2.688.509-4.68-.485-5.253-.988-.571-2.845.304-4.8 2.208A24.849 24.849 0 0 1 14.75 7.24zM7.206 22.677A2.38 2.38 0 0 1 6 22.369c-1.512-.871-1.812-3.369-.823-6.854l.132-.468.472.119c1.155.291 2.429.496 3.785.609l.235.02.134.193a23.596 23.596 0 0 0 2.422 2.968l.34.349-.34.349c-1.898 1.95-3.728 3.023-5.151 3.023zm-1.19-6.427c-.686 2.688-.509 4.681.485 5.254.987.563 2.843-.305 4.8-2.208a24.998 24.998 0 0 1-2.052-2.545 24.976 24.976 0 0 1-3.233-.501zM12 16.878c-.823 0-1.669-.036-2.516-.106l-.235-.02-.135-.193a30.388 30.388 0 0 1-1.35-2.122 30.354 30.354 0 0 1-1.166-2.228l-.1-.213.1-.213a30.3 30.3 0 0 1 1.166-2.228c.414-.716.869-1.43 1.35-2.122l.135-.193.235-.02a29.785 29.785 0 0 1 5.033 0l.234.02.134.193a30.006 30.006 0 0 1 2.517 4.35l.101.213-.101.213a29.6 29.6 0 0 1-2.517 4.35l-.134.193-.234.02c-.847.07-1.694.106-2.517.106zm-2.197-1.084c1.48.111 2.914.111 4.395 0a29.006 29.006 0 0 0 2.196-3.798 28.585 28.585 0 0 0-2.197-3.798 29.031 29.031 0 0 0-4.394 0 28.477 28.477 0 0 0-2.197 3.798 29.114 29.114 0 0 0 2.197 3.798z","size":20,"color":"deepskyblue"},{"tag":"nodejs","tech":"Node.js","name":"M11.177 25.3a1.94 1.94 0 0 1-.969-.259l-3.086-1.826c-.46-.257-.235-.349-.083-.402.614-.213.739-.262 1.394-.635.069-.038.159-.024.231.018l2.37 1.407a.304.304 0 0 0 .287 0l9.241-5.333a.292.292 0 0 0 .141-.25V7.355a.3.3 0 0 0-.143-.255l-9.237-5.329a.29.29 0 0 0-.285 0L1.803 7.102a.296.296 0 0 0-.146.253v10.666c0 .102.056.198.145.247l2.532 1.462c1.374.687 2.215-.122 2.215-.935V8.265c0-.149.12-.266.269-.266H7.99c.146 0 .267.117.267.266v10.53c0 1.833-.998 2.885-2.736 2.885-.534 0-.955 0-2.129-.579L.969 19.706A1.953 1.953 0 0 1 0 18.02V7.355c0-.693.371-1.339.969-1.684l9.242-5.34a2.023 2.023 0 0 1 1.942 0l9.241 5.34c.599.346.971.992.971 1.684V18.02c0 .693-.372 1.337-.971 1.686l-9.241 5.335a1.942 1.942 0 0 1-.973.259zm2.855-7.348c-4.045 0-4.892-1.857-4.892-3.414 0-.148.118-.266.266-.266h1.195c.133 0 .245.096.265.226.18 1.216.717 1.831 3.164 1.831 1.946 0 2.775-.441 2.775-1.473 0-.596-.234-1.037-3.26-1.334-2.528-.25-4.093-.809-4.093-2.831 0-1.865 1.572-2.977 4.207-2.977 2.961 0 4.425 1.027 4.611 3.233a.27.27 0 0 1-.267.291h-1.2a.266.266 0 0 1-.259-.209c-.288-1.28-.988-1.689-2.886-1.689-2.126 0-2.373.74-2.373 1.295 0 .673.292.869 3.161 1.248 2.84.375 4.19.907 4.19 2.902 0 2.014-1.678 3.167-4.606 3.167z","size":20,"color":"lightgreen"},{"tag":"ruby","tech":"Ruby","name":"M20.156.083c3.033.525 3.893 2.598 3.829 4.77L24 4.822 22.635 22.71 4.89 23.926h.016C3.433 23.864.15 23.729 0 19.139l1.645-3 2.819 6.586.503 1.172 2.805-9.144-.03.007.016-.03 9.255 2.956-1.396-5.431-.99-3.9 8.82-.569-.615-.51L16.5 2.114 20.159.073l-.003.01zM0 19.089v.026-.029.003zM5.13 5.073c3.561-3.533 8.157-5.621 9.922-3.84 1.762 1.777-.105 6.105-3.673 9.636-3.563 3.532-8.103 5.734-9.864 3.957-1.766-1.777.045-6.217 3.612-9.75l.003-.003z","size":20,"color":"crimson"},{"tag":"rails","tech":"Ruby on Rails","name":"M20.8848485 15.8107143v1.1635714h1.9818182c.4060606 0 1.1030303-.315 1.1272727-1.19571427v-.45c0-.75214286-.5818182-1.1957143-1.1272727-1.1957143h-.9878788v-.54h1.9575757v-1.17h-1.8787878c-.4848485 0-1.1333334.42428573-1.1333334 1.215v.405c0 .7907143.6424243 1.1957143 1.1333334 1.1957143 1.3636363.00642857-.3272728 0 .9333333 0v.56571428l-2.0060606.0064286zm-10.6181818-.28285716s1.060606-.09642857 1.060606-1.5492857c0-1.45285715-1.2848485-1.58785715-1.2848485-1.58785715H7.72727273v4.5835714H8.8909091v-1.1057143l1.0060606 1.1057142h1.7212121l-1.3515151-1.4464286zm-.44848488-.93857143H8.8909091v-1.0478571h.93333332s.26060608.1028572.26060608.5207143c0 .4178572-.26666668.5271429-.26666668.5271429zM14.2 12.4228572h-1.1818182c-.8424242 0-1.1272727.81-1.1272727 1.1957143v3.35571427h1.1818182v-.8035714h1.1090909v.8035714h1.1454545V13.6185715c0-.97714286-.8363636-1.1957143-1.1272727-1.1957143zm-.0181818 2.44928572h-1.1151515V13.76s0-.2507143.3696969-.2507143h.4060606c.3272728 0 .3333334.2507143.3333334.2507143v1.11214286h.0060606zm1.6848485-2.44928573h1.230303v4.5514285h-1.230303v-4.5514285zm2.9575757 3.375v-3.375H17.6v4.5514285h2.8787879v-1.1764285h-1.6545455zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76969696.16714284-3.93939393 1.87071427-5.2121212 4.12071427C.6 15.0714285.4242424 16.9742857.4242424 16.9742857zM10.4 9.0607143L10.4242424 8.63c-.0545454-.03214286-.2060606-.1092857-.58787876-.225l-.02424243.4242857c.2.0707143.3939394.14785716.5878788.2314286zM9.82424242 10.42357143l-.02424242.405c.2.00642857.4.03214286.6.07714286l.0242424-.3985715c-.2060606-.045-.4060606-.0707143-.59999998-.0835715zm-2.24242424-2.0057143h.06060606l-.12121212-.39214284c-.1878788 0-.38181818.0128571-.58181818.0385714l.1151515.3792857c.1757576-.0192857.35151517-.0257143.52727274-.0257143zm.2909091 2.3657143l.13939393.44357143c.1757576-.09.3515152-.16714286.5272728-.225l-.1333333-.42428572c-.2060606.06428572-.3818182.135-.5333333.2057143zM5.1212121 9.09285713l-.27272727-.44357142c-.15151515.0835715-.3090909.1735715-.47272727.2764286l.27878787.45c.15757576-.1028571.3090909-.1992857.46666667-.2828571zm1.24242424 2.89285716l.2909091.4628571c.1030303-.1607143.22424242-.3085715.35757575-.4564286L6.7393939 11.555c-.13939394.135-.26666667.28285714-.37575758.4307143zm-.87878788 2.07l.4909091.4114285C6 14.2164285 6.04242424 13.9657143 6.1030303 13.715l-.43636363-.36642857c-.07878788.23785714-.13333334.47571428-.1818182.70714286zM2.830303 11.0021428L2.4 10.60357142c-.15757576.1607143-.3090909.32142858-.44848485.48214287L2.41818182 11.51c.12727273-.17357143.26666666-.34714286.4121212-.50785714zM1 13.8757143l-.6969697-.27c-.1151515.27642856-.24242424.59785713-.3030303.77142856l.6969697.27C.77575758 14.42857143.9030303 14.11357143 1 13.8757143zm4.3939394 1.81285713c.0121212.34071428.04242424.61714286.07272727.81L6.1939394 16.775c-.05454546-.2507143-.10909092-.53357143-.14545455-.8357143l-.65454546-.25071427z","size":20,"color":"#CC0000"},{"tag":"php","tech":"php","name":"M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z","size":20,"color":"#777BB4"},{"tag":"laravel","tech":"Laravel","name":"M23.644 5.43c.009.032.014.065.014.099v5.15c0 .135-.073.26-.189.326l-4.323 2.49v4.934c0 .135-.072.258-.188.326L9.931 23.95c-.021.012-.043.02-.066.027-.008.002-.016.008-.024.01-.063.018-.13.018-.192 0-.011-.002-.02-.008-.029-.012-.021-.008-.043-.014-.063-.025L.534 18.755c-.117-.068-.189-.191-.189-.326V2.974c0-.033.005-.066.014-.098.003-.012.01-.021.014-.032.006-.02.014-.04.023-.058.004-.013.015-.022.023-.033.012-.016.021-.031.033-.045.012-.01.025-.018.037-.027.014-.012.027-.024.041-.034h.001L5.044.05c.115-.067.259-.067.375 0l4.512 2.597h.002c.015.01.027.021.041.033.012.009.025.018.037.027.013.014.021.029.033.045.008.011.02.021.025.033.011.019.017.038.024.058.003.011.011.021.013.032.01.031.014.064.014.098v9.652l3.76-2.164V5.527c0-.033.005-.066.014-.098.003-.011.009-.021.013-.032.007-.02.014-.039.024-.059.007-.012.018-.021.025-.033.012-.015.021-.03.033-.043.012-.012.025-.02.037-.028.014-.011.026-.023.041-.032h.001l4.513-2.598c.116-.067.259-.067.375 0l4.513 2.598c.016.01.027.021.042.031.012.01.025.018.036.028.013.014.022.029.034.044.008.012.019.021.024.033.011.02.018.039.024.059.006.011.012.022.015.033zm-.74 5.032V6.179l-1.578.908-2.182 1.256v4.283l3.76-2.164zm-4.511 7.75v-4.287l-2.146 1.225-6.127 3.498v4.326l8.273-4.762zM1.095 3.624v14.588l8.273 4.762v-4.326l-4.322-2.445-.002-.003h-.002c-.014-.01-.025-.021-.04-.031-.011-.01-.024-.018-.035-.027l-.001-.002c-.013-.012-.021-.025-.031-.039-.01-.012-.021-.023-.028-.037h-.002c-.008-.014-.013-.031-.02-.047-.006-.016-.014-.027-.018-.043-.004-.018-.006-.037-.008-.057-.002-.014-.006-.027-.006-.041V5.789l-2.18-1.257-1.578-.908zM5.231.81l-3.76 2.164 3.76 2.164 3.758-2.164L5.231.81zm1.956 13.505l2.182-1.256V3.624l-1.58.909-2.182 1.256v9.435l1.58-.909zM18.769 3.364l-3.76 2.164 3.76 2.163 3.759-2.164-3.759-2.163zm-.376 4.979l-2.182-1.256-1.579-.908v4.283l2.182 1.256 1.579.908V8.343zm-8.65 9.654l5.514-3.148 2.756-1.572-3.757-2.163-4.324 2.489-3.941 2.27 3.752 2.124z","size":20,"color":"#FF2D20"},{"tag":"cakephp","tech":"CakePHP","name":"M0 13.875v3.745c0 2.067 5.37 3.743 12 3.743V17.62c-6.63 0-12-1.68-12-3.743v-.002zm21.384 2.333L12 13.875v3.745l9.384 2.333C23.02 19.313 24 18.503 24 17.62v-3.745c0 .882-.98 1.692-2.616 2.333zM12 10.133v3.742c-6.627 0-12-1.677-12-3.744V6.38c0-2.064 5.37-3.743 12-3.743 6.625 0 12 1.68 12 3.744v3.75c0 .883-.98 1.69-2.616 2.334L12 10.13v.003z","size":20,"color":"#D33C43"},{"tag":"swift","tech":"Swift","name":"M21.984 16.348c.056-.112.056-.224.112-.336 1.346-5.272-1.851-11.44-7.347-14.693 2.412 3.253 3.365 7.122 2.524 10.599-.056.28-.168.617-.28.897a5.173 5.173 0 0 1-.45-.28S11.104 9.17 5.273 3.282c-.169-.168 3.14 4.71 6.841 8.58-1.738-1.01-6.673-4.542-9.758-7.403.337.617.842 1.234 1.346 1.851 2.58 3.309 5.945 7.346 9.983 10.43-2.86 1.74-6.842 1.851-10.88 0-1.01-.448-1.85-1.009-2.804-1.682 1.682 2.636 4.318 5.048 7.459 6.337 3.757 1.627 7.57 1.515 10.318 0h.057c.112-.056.224-.112.336-.224 1.346-.673 3.982-1.402 5.44 1.402.392.785 1.121-2.86-1.626-6.225z","size":20,"color":"#FA7343"},{"tag":"ios","tech":"iOS","name":"M7.078 23.55c-.473-.316-.893-.703-1.244-1.15-.383-.463-.738-.95-1.064-1.454-.766-1.12-1.365-2.345-1.78-3.636-.5-1.502-.743-2.94-.743-4.347 0-1.57.34-2.94 1.002-4.09.49-.9 1.22-1.653 2.1-2.182.85-.53 1.84-.82 2.84-.84.35 0 .73.05 1.13.15.29.08.64.21 1.07.37.55.21.85.34.95.37.32.12.59.17.8.17.16 0 .39-.05.645-.13.145-.05.42-.14.81-.31.386-.14.692-.26.935-.35.37-.11.728-.21 1.05-.26.39-.06.777-.08 1.148-.05.71.05 1.36.2 1.94.42 1.02.41 1.843 1.05 2.457 1.96-.26.16-.5.346-.725.55-.487.43-.9.94-1.23 1.505-.43.77-.65 1.64-.644 2.52.015 1.083.29 2.035.84 2.86.387.6.904 1.114 1.534 1.536.31.21.582.355.84.45-.12.375-.252.74-.405 1.1-.347.807-.76 1.58-1.25 2.31-.432.63-.772 1.1-1.03 1.41-.402.48-.79.84-1.18 1.097-.43.285-.935.436-1.452.436-.35.015-.7-.03-1.034-.127-.29-.095-.576-.202-.856-.323-.293-.134-.596-.248-.905-.34-.38-.1-.77-.148-1.164-.147-.4 0-.79.05-1.16.145-.31.088-.61.196-.907.325-.42.175-.695.29-.855.34-.324.096-.656.154-.99.175-.52 0-1.004-.15-1.486-.45zm6.854-18.46c-.68.34-1.326.484-1.973.436-.1-.646 0-1.31.27-2.037.24-.62.56-1.18 1-1.68.46-.52 1.01-.95 1.63-1.26.66-.34 1.29-.52 1.89-.55.08.68 0 1.35-.25 2.07-.228.64-.568 1.23-1 1.76-.435.52-.975.95-1.586 1.26z","size":20,"color":"#403f3f"},{"tag":"kotlin","tech":"Kotlin","name":"M1.3 24l11.3-11.5L24 24zM0 0h12L0 12.5zM13.4 0L0 14v10l12-12L24 0z","size":20,"color":"#0095D5"},{"tag":"android","tech":"Android","name":"M24 19H0a13.6 13.6 0 0 1 2.21-6.07A11.2 11.2 0 0 1 5.87 9.4l.41-.23-2.02-3.41a.51.51 0 0 1 .17-.7.5.5 0 0 1 .69.18l2.08 3.5a12.62 12.62 0 0 1 4.84-.9 12.2 12.2 0 0 1 4.75.9l2.07-3.5a.5.5 0 0 1 .7-.17.51.51 0 0 1 .16.7L17.7 9.19l.5.28a11.38 11.38 0 0 1 3.63 3.62A14.48 14.48 0 0 1 24 19zm-7.5-4.48a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1zm-11 0a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1z","size":20,"color":"#3DDC84"},{"tag":"git","tech":"Git","name":"M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.215 1.379-.07 1.889.441.516.515.658 1.258.438 1.9l2.658 2.66c.645-.223 1.387-.078 1.9.435.721.72.721 1.884 0 2.604-.719.719-1.881.719-2.6 0-.539-.541-.674-1.337-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348.713.721.713 1.883 0 2.6-.719.721-1.889.721-2.609 0-.719-.719-.719-1.879 0-2.598.182-.18.387-.316.605-.406V8.835c-.217-.091-.424-.222-.6-.401-.545-.545-.676-1.342-.396-2.009L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477c.604.604 1.582.604 2.186 0l10.43-10.43c.605-.603.605-1.582 0-2.187","size":20,"color":"#403f3f"},{"tag":"aws","tech":"AWS","name":"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zM21.698 16.207c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zM22.792 14.961c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z","size":20,"color":"#232F3E"},{"tag":"instagram","tech":"Instagram","name":"M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z","size":20,"color":"#E4405F"},{"tag":"facebook","tech":"Facebook","name":"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z","size":20,"color":"#1877F2"},{"tag":"gitlab ci","tech":"Gitlab CI","name":"M4.844.904a1.007 1.007 0 00-.955.692l-2.53 7.783c0 .007-.005.012-.007.02L.07 13.335a1.437 1.437 0 00.522 1.607l11.072 8.045a.566.566 0 00.67-.004l11.074-8.04a1.436 1.436 0 00.522-1.61l-1.26-3.867a.547.547 0 00-.031-.104l-2.526-7.775a1.004 1.004 0 00-.957-.684.987.987 0 00-.949.69l-2.406 7.408H8.203l-2.41-7.408a.987.987 0 00-.943-.69h-.006zm-.006 1.42l2.174 6.678H2.674l2.164-6.678zm14.328 0l2.168 6.678h-4.342l2.174-6.678zm-10.594 7.81h6.862l-2.15 6.618L12 20.693 8.572 10.135zm-5.515.005h4.322l3.086 9.5-7.408-9.5zm13.568 0h4.326l-6.703 8.588-.709.914 2.959-9.108.127-.394zM2.1 10.762l6.978 8.947-7.818-5.682a.305.305 0 01-.112-.341l.952-2.924zm19.8 0l.952 2.922a.305.305 0 01-.11.341v.002l-7.82 5.68.025-.035 6.953-8.91Z","size":20,"color":"#FCA121"}]}},"allMarkdownRemark":{"totalCount":7,"edges":[{"node":{"excerpt":"Route 53 dịch vụ cung cấp chức năng phân giải và đăng ký tên miền cung cấp bởi AWS. Route 53 được đặt tên theo con đường liên bang lịch sử đầu tiên của đất nước Mỹ  và  chính là port lắng nghe của…","snippet":"<div class=\"custom-block-body\"><p>Route 53 d&#x1ECB;ch v&#x1EE5; cung c&#x1EA5;p ch&#x1EE9;c n&#x103;ng ph&#xE2;n gi&#x1EA3;i v&#xE0; &#x111;&#x103;ng k&#xFD; t&#xEA;n mi&#x1EC1;n cung c&#x1EA5;p b&#x1EDF;i AWS. Route 53 &#x111;&#x1B0;&#x1EE3;c &#x111;&#x1EB7;t t&#xEA;n theo con &#x111;&#x1B0;&#x1EDD;ng li&#xEA;n bang l&#x1ECB;ch s&#x1EED; &#x111;&#x1EA7;u ti&#xEA;n c&#x1EE7;a &#x111;&#x1EA5;t n&#x1B0;&#x1EDB;c M&#x1EF9; <code class=\"language-text\">Route 66</code> v&#xE0; <code class=\"language-text\">53</code> ch&#xED;nh l&#xE0; port l&#x1EAF;ng nghe c&#x1EE7;a d&#x1ECB;ch v&#x1EE5; DNS</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Route 53 dịch vụ cung cấp chức năng phân giải và đăng ký tên miền cung cấp bởi AWS. Route 53 được đặt tên theo con đường liên bang lịch sử đầu tiên của đất nước Mỹ <code class=\"language-text\">Route 66</code> và <code class=\"language-text\">53</code> chính là port lắng nghe của dịch vụ DNS</p></div></div>\n<p>Trước khi tìm hiểu và đi vào sử dụng Route 53 chúng ta hãy cùng ôn lại một số khái niệm cơ bản trước nhé.</p>\n<h3>Domain và DNS là gì?</h3>\n<p>   Đầu tiên là <strong>domain</strong> hay còn gọi là <strong>tên miền,</strong> là địa chỉ trang web mà mọi người nhập vào thanh URL của trình duyệt để truy cập vào một website. Domain có tác dụng để thay thế 1 địa chỉ IP dài và khó nhớ như: <code class=\"language-text\">123.45.67.89</code> trên internet  thành một “<strong>Domain name</strong>” có dạng là <strong>www.example.com</strong>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/08902bd605c6f66ca3494fd4e39f2265/1cfc2/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2UlEQVQoz5WS62rbQBCF8/7Q1ygtJT+KSWloQ1TsNo3t0MYXRZIlW5J3tRdLjrRa3S+bVeJiUWjrwmEZBj525pw5g3F7onAiaCowP3bO/o2xBnLhJWKGy6GdLWmJeAtOgCXWgqT1qI+jTFln5zN2u83lCID9HZZYKrwgoqupFNmH11Y2WPI7WOCkPcCgW6aVk3SKayzVbSW8MCfOg68qO1XB0EFR8d0tLvV0AnqwZBa0NoLaDBqdtToThl9tuSDuihrjnTYim5kXMJSI0SZ9v4zvYG9sEIs3Y/B2gma+MG41fby4p/WcVCTkyHMRITAVnWFxa4e1ua/cqDm6bT22W0x/bnyUi8HH1w+fXmVVNacNfYwAr0EuOrfjDpAzkkR4/ai+2rmyLs/n/GqVv9PdD5qpmNnIyXfBHm9NhABMxIvzdtjI7Zz+z9quUmm9INU9Lq+M4tIoZZ560CBKiWtQbUitHzAsZM43TjZQ+bS/84vP0mHZwkkjnZQFilvABSZ452rEXiKwwSy/tlIJ/x5VJ/brPRTNNhHp+lthfAZRieGG+P7QLi7UeNqP6k+3JX8OKNx7liwgqxErb5z8QuUTcMqFdROJjjxYLaYg/7JO/+e22dFb9OxLP6onSmw9x47nzhAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/08902bd605c6f66ca3494fd4e39f2265/8c557/image-1.png\"\n        srcset=\"/static/08902bd605c6f66ca3494fd4e39f2265/4edbd/image-1.png 175w,\n/static/08902bd605c6f66ca3494fd4e39f2265/13ae7/image-1.png 350w,\n/static/08902bd605c6f66ca3494fd4e39f2265/8c557/image-1.png 700w,\n/static/08902bd605c6f66ca3494fd4e39f2265/1cfc2/image-1.png 900w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><strong>Domain levels</strong></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/26be13af3d76338d84e1e042f00565f6/57dc1/image-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.857142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQY001PXU+DQBDk//8aX0hMxK+TlmqPtIAIYg8KhvMooqShXO84wA1NG+dhM5nd2Z3V+r5XSkEd/6Ft2yiKCCF5nodh2DTNSS/LMpyQpim4tOUExhj0hglAsixDT8icmY7rAKGUglgU7NmyMMau64IFtmtVVXHOz045jmIYhOB8kGr/Uzf1Xh2lPIpuGBvZ0V3ZSQlzp7waQkjXdcMwCInvrd3top3bhw2jj4n7EDvX0fIqtLzkg63wwbxhszvRdZfvNLgOSWzbhgheUDjB72vwvc0/V+n7Oo1wErzE/ibb0sCv/fXXmyekvJj/AKg3Dhz/CtpFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/26be13af3d76338d84e1e042f00565f6/8c557/image-2.png\"\n        srcset=\"/static/26be13af3d76338d84e1e042f00565f6/4edbd/image-2.png 175w,\n/static/26be13af3d76338d84e1e042f00565f6/13ae7/image-2.png 350w,\n/static/26be13af3d76338d84e1e042f00565f6/8c557/image-2.png 700w,\n/static/26be13af3d76338d84e1e042f00565f6/57dc1/image-2.png 718w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n\nTính từ bên phải sang</p>\n<ol>\n<li>Top-level domain ví dụ tên miền như là <code class=\"language-text\">.com</code>, <code class=\"language-text\">.net</code>, <code class=\"language-text\">.org</code>,...</li>\n<li>Second-level domain là tên miền gợi nhớ cho người dùng đến trang web của bạn</li>\n<li>Third-level domain hay thường được gọi là sub domain là tuỳ chọn của bạn ví dụ như <code class=\"language-text\">www</code>, <code class=\"language-text\">admin</code>, <code class=\"language-text\">user</code>, ...</li>\n</ol>\n<p><strong>DNS</strong> (Domain Name System) là hệ thống phân giải tên miền.</p>\n<p>   Cách DNS hoạt động\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b3f44c830b67e2e26d59515acf89d60/50f96/image-3.pbm\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABpUlEQVQoz41SDZOjIAz1//+wm5u7ra1Vq21tBVdQEVEUrCKuR2v3PnZm5zYTQhjmJXlJrOUL8vaQ1SmKIkmSaZrM0zLndrtVtMLpa+h5OIHLPH9Ars6oNELYcXZRFLVt+wRPahwE78u0hYceR/PY/0n3QEYA5UXJq7JjdLvdmszjMDzBn5V6j6s1reqLZ98owjlJ0mzvB4fwjB6+pbXOskwpJUQvpRTCmH5Uk7kAhGl8Vb3Qsp5EI4eJdx1MXj0/MBF5KyxCyOVyAQDs3NB2gh+2Z2xwih1n7/t+mgDeNFeQOv6p4zzPMtd1AbgKIe5lm8fPl5c4OikUTCWYyliReOE4PHg7x8lxqgb51pYDPmo1Ss42mw2EYFg5k5J9+26zulkk06LWHTNFzj0npEwxphmqKDX0asbkbUxxsTOkj1FOqryglmmJmvT873jGUe3coxtEfngeZQePPgRJzbuGdzFIXC8oKWtbaf3dX3PedckJNVQJZfefBqm+qwlBKfI9D4D4yXn5mqyLIjtu2zaE0OzVf+b8e0lWrCnbUN17/vF8YTU3+gvmu6RzFX3MRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/2b3f44c830b67e2e26d59515acf89d60/28310/image-3.pbm\"\n        srcset=\"/static/2b3f44c830b67e2e26d59515acf89d60/64e1d/image-3.pbm 175w,\n/static/2b3f44c830b67e2e26d59515acf89d60/b8ceb/image-3.pbm 350w,\n/static/2b3f44c830b67e2e26d59515acf89d60/28310/image-3.pbm 700w,\n/static/2b3f44c830b67e2e26d59515acf89d60/50f96/image-3.pbm 850w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Khi người dùng có một request từ brower thì request đầu tiên phải đi qua một hệ thống trung gian của nhà mạng gọi là <code class=\"language-text\">Recursive Resolver</code></p>\n<ol>\n<li>Trước tiên <code class=\"language-text\">Recursive Resolver</code> gửi một request đến <code class=\"language-text\">Root nameserver</code> trên toàn cầu để được nhận về Top-lever.</li>\n<li>Tiếp theo <code class=\"language-text\">Recursive Resolver</code> lại gửi request đến <code class=\"language-text\">TDL manaserver</code> (Top-lever namesever) để được nhận được Second-level domain.</li>\n<li>Cuối cùng <code class=\"language-text\">Recursive Resolver</code> lại gửi request đến <code class=\"language-text\">SDL manaserver</code> (Second-lever namesever) để được nhận được địa chỉ IP của trang web chúng ta</li>\n</ol>\n<p>Ngoài ra <code class=\"language-text\">Recursive Resolver</code> sẽ cache thông tin địa chỉ này lại để tăng tốc độ cho những lần request sau</p>\n<h3>Route 53</h3>\n<p>Route 53 cung cấp các dịch vụ </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5d7fe39b741e3a636a2275f3823575db/081ff/image-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABBElEQVQY031R2XKDMAzk/z+wNQRCG6CNwRhsDObeSp7wlikzYmC9hyRHUhsoM6BRCl1vME4TBudgrP237DC8xaLq94kPESPLc4g4wacQ+C5/YN2IgQiXuX192zfYhTMWXYeqbfGUEl3Xw89LwHpjqOsey7pios611gHj2rYNjkJ7moo1y7JgHEdE8zwH8E4dZtkdsq5xnieKoiTsC7c0I6ELJsktRU7Y41Fg33eUVRX+U+Jo3cF7j2iiF7uHAzLkMflhghAJirLEcRzgYA6MaS113QRO06gQysU69or4Eryf6VJa1ETgMTidMUnC3ljsL0PVakji8Dp45JVW4cYpGLHG0ch/C4THhNMj+yUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/5d7fe39b741e3a636a2275f3823575db/8c557/image-4.png\"\n        srcset=\"/static/5d7fe39b741e3a636a2275f3823575db/4edbd/image-4.png 175w,\n/static/5d7fe39b741e3a636a2275f3823575db/13ae7/image-4.png 350w,\n/static/5d7fe39b741e3a636a2275f3823575db/8c557/image-4.png 700w,\n/static/5d7fe39b741e3a636a2275f3823575db/e996b/image-4.png 1050w,\n/static/5d7fe39b741e3a636a2275f3823575db/2cefc/image-4.png 1400w,\n/static/5d7fe39b741e3a636a2275f3823575db/081ff/image-4.png 2182w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>DNS Management hay còn gọi là DNS server chính là dịch vụ <code class=\"language-text\">Recursive Resolver</code> đã đề cập ở trên.</li>\n<li>Traffic management dịch vụ quản lý traffic vào ra của DNS</li>\n<li>Availablity monitoring dịch vụ theo dõi, health check DNS hoạt động</li>\n<li>Domain registration là dịch vụ đăng ký mua tên miền, bạn có thể sử dụng các server khác để mua chẳng hạn như <a href=\"https://www.hostinger.vn/\">hostinger.vn</a></li>\n</ul>\n<h3>Sử dụng Route 53</h3>\n<ol>\n<li>Đầu tiên bạn hãy chuẩn bị cho mình một server bằng dịch vụ EC2 nhé. Sau khi hoàn thành thì IP mà bạn muốn domain định tuyến tới sẽ như thế này</li>\n</ol>\n<p>  <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2515cd1f73851e20f0be9d6dd2661a56/ba4d9/image-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA40lEQVQY041QXUvDMADs//83Q9jLBGUoCKJu1olzS9qxCiZdPxLXJU2bnkmKCCLiwXGXe7hcEjXNCZwfUJYVaiHAWI7jscGhKFG4TEiJtjXwGIbhT3pEUn6AJClougPjOWgy6uuGgNAUmy2Fv/Q/8KWRN1VVQykNrbVTFRYaY4L3mV/pS5XpcXJsewuhOkjdh2y/z1DXYlxorcX1zS3eGXdrCO7uH7B8jLElFPHTKnCxWGJNEkyfOWbrAle0wiRmOFvlOH/huLicI8vexsKvt/+c/pvv3DLrzp0d0Dt6H9R+/+EnDA9+g+bOcYkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/2515cd1f73851e20f0be9d6dd2661a56/ba4d9/image-5.png\"\n        srcset=\"/static/2515cd1f73851e20f0be9d6dd2661a56/4edbd/image-5.png 175w,\n/static/2515cd1f73851e20f0be9d6dd2661a56/13ae7/image-5.png 350w,\n/static/2515cd1f73851e20f0be9d6dd2661a56/ba4d9/image-5.png 564w\"\n        sizes=\"(max-width: 564px) 100vw, 564px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"2\">\n<li>\n<p>Tạo một Hosted Zone</p>\n<p>Hosted Zone là gì? Hosted Zone là một khái niệm trong AWS là nơi quản lý tương ứng với một domain của bạn. Bạn sẽ tạo ra các <code class=\"language-text\">record</code> để tiến hành config và định tuyến cho domain của bạn.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dabd68ed5990aee2eef558fae90cdc78/20c85/image-6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.57142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACgElEQVQ4y4VU227TQBDN1yEh0aai0FKVgITaB5544JEfQjzQ/+AdaElbu3HSxrHXXt+d2M5hZuwtcW9YOppZ7/js2bl48PLgCDuHH7G1f4TnuyMM999j69VbvNg9FLtD6+HeO2y/HonPdnvvA4ZvjrFN3xi7c3CMZ8MRBs7NHGeWg4vJDD8vHFjOFPbEgTO7get5CLVGEN5FCGUQhLL2fB9ZlmPAzng8xqVl4fz8XHybSOOsQFHkyPKMkD+KNMsQJ4mQ8jPgxcWlBcuyYV9NcHr2B7PZNRJ6H8WxBLMfsx+zn4plZERWlqXEKaWwXq8xSNIUrrsQ6QlJ5iA+uSjKDsU95AyKYbLVaiWHqiBoCVnyfO5ien0DFSUSJERk+cO6rrGmq3CwwebDaxalVEfIaph97rpIacMoWNLJvFcul6SiQtM0qDtsEt8jZIULz0dApC5ZneZYEknZgYmbjqS5Q/SowogSHOoIYRQhTjMhNKRsm2YtpGz/q5AJV1UlyWUs5Yqtbz4yyuTanNMnr0yLhR9Ac98RWU4FySiHWV4IaV13udsgepqQFJ7NNX5ZU5zaM0w8DTcu4GcltUMKZ0rvqNE9X0k+KyJ+uMrqH6GbV7AXIUELZjpDuGyEgPuzHa927LidzPWN7fUhLxgc2EPXPsbvN3WHrsFlUm4JaXFpXcFV4e24RVEMTVWPqOrc6KbqD4H3702KDDm1C88p54PfVVR5BhejbZk+amNpv0fIsn2qECedq1pVtRA9/VCF102Lppab9RRquhonnFVynvh0o7AHVkvg4zbBw9BWmX5fkrMOTPwYeD8IFOxrD+rHd4RfPyE8+YLg22do5zd0khNhg78waZakJvdeSAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/dabd68ed5990aee2eef558fae90cdc78/8c557/image-6.png\"\n        srcset=\"/static/dabd68ed5990aee2eef558fae90cdc78/4edbd/image-6.png 175w,\n/static/dabd68ed5990aee2eef558fae90cdc78/13ae7/image-6.png 350w,\n/static/dabd68ed5990aee2eef558fae90cdc78/8c557/image-6.png 700w,\n/static/dabd68ed5990aee2eef558fae90cdc78/20c85/image-6.png 999w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Bạn hãy chọn là <code class=\"language-text\">Public Hosted Zone</code> để DNS của bạn được ra ngoài global.  <code class=\"language-text\">Private hosted zone</code> thì chỉ có tác dụng trong máy ảo VPC.</p>\n<p>Sau khi tạo một Hosted zone thì AWS cung cấp cho bạn  4 <code class=\"language-text\">nameserver</code> phụ trách phân giải domain được rải đều các nơi trên thế giới.</p>\n<blockquote>\n<p>ns-1093.awsdns-08.org.\nns-464.awsdns-58.com.\nns-1816.awsdns-35.co.uk.\nns-812.awsdns-37.net.</p>\n</blockquote>\n</li>\n<li>Nếu bạn đã đăng ký mua domain ở các dịch vụ khác thì bạn phải chuyển quyền quản lý của domain này đến nameserver của AWS. Nhập 4 nameserver của AWS cung cấp vào nameserver. Bạn phải chờ một thời gian dể dịch vụ của bạn cập nhật nameserver mới</li>\n<li>\n<p>Ok! Bây giờ chúng ta tiến hành định tuyến domain đến server đã tạo bằng một record mới nhé</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e752849c843bcad2102b7793c39d0238/5148a/image-7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94.85714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACpklEQVQ4y41USXITQRDUJ7nwAvgRQcAJ+AUXwgfOYDuEZSE8Go1m3/dNSWXNjJEDTGgiUl3dXV1dlVmt1c6JsLEj+HEC04+xtkJs57nhRrgxA9wdQ5hehDiOYVqW4AjP95EXBbI8f0SaZVhleYEoSXQSJ6nYAgnG9aKqkeQlglR8shKx2JkESWafOEn0DOdL8FUuP9++X2Ozucd6/QPb7Ra3t7c4Oh6CvEGUV7h3MxhBjjtHLpV5FEXYmxaM/QHW0VHkkoBmWNU1hmHAOI7o+17tXqDjPB9HwTBhkLVO0J+BPl3Xa5arpm01ddd1ZbEDv9PppBBrHv/9MZAtlTzsTVRCT1lVWNVNgzRNhfAERVmhaIe/DjL7siwVddOiOXNhtkyKwbm/qqVkxxW+wnASpezktkovIb+8kFnajoufux12hokHO3hMgmMhpbZSXcGAjRygykRRlKhk0fV8/HowcJD2iKRVmGHbdqpmKBdTlCAIEcroB4GK0Z0HrOtGDzJDls35Hx7xXx7PPw1IlR3HhpMIR904kT1O49F2sLnfalnM5iBNbRGxcNkNOIkffVkBL50yFEIZNJdJNfN1OhNjaQvX87QbuNb1c2txf24vgpSpyrkY7CFClZbgfClsAx4i4aSB+/TnPsVkMzPQk5KZIXnkYfYSHWkvh5ZMwyhWCjw/UNE4UnkqzQpbiaN9yICXfIt4PLzYzRyEWGwVxTD22iZ704SdTISPM9nKzzBcrjI7PQgjeeA2zIOlii7PahSBGr6MZ6t42k76UhhVS1gwl3WO+myfDUzUbY9aEq/7cYLYWVljlaSpvpJ4fi3xM+AefUmL4chrWV/Bf/MCwcfXCD68QvDuJeLrz/yDzXEp2Da+/FN7UYrMukPy5S3Sr58mXL1HatzgN5/StUqbVeQRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"alt\"\n        title=\"alt\"\n        src=\"/static/e752849c843bcad2102b7793c39d0238/8c557/image-7.png\"\n        srcset=\"/static/e752849c843bcad2102b7793c39d0238/4edbd/image-7.png 175w,\n/static/e752849c843bcad2102b7793c39d0238/13ae7/image-7.png 350w,\n/static/e752849c843bcad2102b7793c39d0238/8c557/image-7.png 700w,\n/static/e752849c843bcad2102b7793c39d0238/e996b/image-7.png 1050w,\n/static/e752849c843bcad2102b7793c39d0238/5148a/image-7.png 1228w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n</li>\n</ol>\n<p>  Trong đó thì:</p>\n<ul>\n<li>TTL (Time to leave) là thời gian dữ liệu được cache lại những request giống nhau trong DNS server mục đích để tăng tốc độ</li>\n<li>Value nơi nhập một địa chỉ IP hoặc danh sách IP các server tương ứng bạn muốn định tuyến tới</li>\n<li>\n<p>Record type:</p>\n<ul>\n<li>A : dùng cho địa chỉ IPv4</li>\n<li>AAAA : dùng cho địa chỉ IPv6</li>\n<li>CNAME : dùng để định tuyến cho một domain khác đến với server của bạn, ngoài ra còn thường được sử dụng để định tuyến subdomain tới domain chính của bạn</li>\n</ul>\n</li>\n<li>\n<p>Routing Policy:</p>\n<ol>\n<li>Simple routing: chỉ có một record cho nhiều IP tương ứng với các server khác nhau. Route 53 định tuyến đến các server ngẫu nhiên trong danh sách IP của bạn</li>\n<li>Weight: phân bố tỷ lệ domain định tuyến đến các IP của server, tất nhiên bạn cũng phải tạo mỗi record cho mỗi IP để phân chia tỉ lệ này</li>\n<li>Latency: định tuyến đến server nhanh nhất. Route 53 sẽ gửi <code class=\"language-text\">Health Check</code> để kiểm tra  server nào sẽ có độ trễ ít nhất</li>\n<li>Geolocation: định tuyến đến server gần với người dùng nhất</li>\n</ol>\n</li>\n</ul>\n<h3>Tóm lại</h3>\n<p>Như vậy mình đã giới thiệu đến các bạn các khái niệm và concept trong Route 53. Cũng thật thú vị phải không nào. Hy vọng các bạn sẽ có cái nhìn tổng quan hơn về dịch vụ này và có thể áp dụng linh hoạt trong từng bài toán, dự án cụ thể của mình. Cám ơn các bạn đã xem.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Huy Nguyen </div><div class=\"custom-block-body\"></div></div>","id":"b1e7b052-4860-5d41-9a7b-3363fa60d7fb","frontmatter":{"title":"Route 53 Overview","date":"14-03-2021","tags":["aws"]},"fields":{"slug":"/route-53-overview/","readingTime":{"text":"5 min read"}}}},{"node":{"excerpt":"Hệ sinh thái AWS khổng lồ cung cấp cho chúng ta vô vàn công cụ giúp đẩy nhanh thời gian đưa ý tưởng thành sản phẩm. Trong đó có Elastic Beanstalk (EB). EB là nền tảng giúp ta quản lý tất cả mọi thứ…","snippet":"<div class=\"custom-block-body\"><p>H&#x1EC7; sinh th&#xE1;i AWS kh&#x1ED5;ng l&#x1ED3; cung c&#x1EA5;p cho ch&#xFA;ng ta v&#xF4; v&#xE0;n c&#xF4;ng c&#x1EE5; gi&#xFA;p &#x111;&#x1EA9;y nhanh th&#x1EDD;i gian &#x111;&#x1B0;a &#xFD; t&#x1B0;&#x1EDF;ng th&#xE0;nh s&#x1EA3;n ph&#x1EA9;m. Trong &#x111;&#xF3; c&#xF3; Elastic Beanstalk (EB). EB l&#xE0; n&#x1EC1;n t&#x1EA3;ng gi&#xFA;p ta qu&#x1EA3;n l&#xFD; t&#x1EA5;t c&#x1EA3; m&#x1ECD;i th&#x1EE9;, nh&#x1B0; server,load balancer,autoscale,deploy, monitoring, vv... m&#x1ED9;t c&#xE1;ch tr&#x1EF1;c quan v&#xE0; d&#x1EC5; hi&#x1EC3;u nh&#x1EA5;t. Ch&#x1EC9; m&#x1EA5;t 1,2 ng&#xE0;y setup l&#xE0; t&#x1EA5;t c&#x1EA3; m&#x1ECD;i th&#x1EE9; ready. B&#xE0;i vi&#x1EBF;t n&#xE0;y h&#x1B0;&#x1EDB;ng d&#x1EAB;n c&#xE1;ch g&#x1EAF;n m&#x1ED9;t IP t&#xED;nh cho t&#x1EA5;t c&#x1EA3; c&#xE1;c instances trong 1 load balanced EB environment.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Hệ sinh thái AWS khổng lồ cung cấp cho chúng ta vô vàn công cụ giúp đẩy nhanh thời gian đưa ý tưởng thành sản phẩm. Trong đó có Elastic Beanstalk (EB). EB là nền tảng giúp ta quản lý tất cả mọi thứ, như server,load balancer,autoscale,deploy, monitoring, vv... một cách trực quan và dễ hiểu nhất. Chỉ mất 1,2 ngày setup là tất cả mọi thứ ready. Bài viết này hướng dẫn cách gắn một IP tính cho tất cả các instances trong 1 load balanced EB environment.</p></div></div>\n<h2>Mở đầu</h2>\n<p>Với 1 load balanced EB environment, có rất nhiều thứ có thể làm thay đổi IP server của bạn.</p>\n<ul>\n<li>deploy</li>\n<li>auto scaling</li>\n<li>stop &#x26; start server</li>\n<li>update config, settings ...</li>\n</ul>\n<p>EB rất linh hoạt, nên server của bạn cũng sẽ rất \"linh hoạt\".\nVậy nếu tôi muốn gắn 1 IP cố định duy nhất cho tất cả các server của tôi thì sao?\nCó nhiều kịch bản yêu cầu một IP cố định cho server. Tóm lại là không muốn công khai thông tin với người ngoài, tôi chỉ cho ông này với IP này truy cập dữ liệu của tôi thôi.</p>\n<p><em>Một số khái niệm trong bài viết có thể lạ lẫm với một số bạn chưa có kinh nghiệm làm việc với AWS.</em></p>\n<h2>Làm thế nào để cố định IP servers trong Loadbalanced EB</h2>\n<p>Trả lời luôn là dùng NAT Gateway. NAT Gateway dùng để làm gì? Theo tài liệu, NAT Gateway cho phép server của bạn kết nối với internet nhưng không cho internet kết nối trực tiếp tới server.</p>\n<blockquote>\n<p>You can use a network address translation (NAT) gateway to enable instances in a private subnet to connect to the internet or other AWS services, but prevent the internet from initiating a connection with those instances.\nrefs <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html\">https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html</a></p>\n</blockquote>\n<p>nat gateway diagram | nguồn: <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html\">https://docs.aws.amazon.com/vpc/latest/userguide/vpc-nat-gateway.html</a>\n<img src=\"https://docs.aws.amazon.com/vpc/latest/userguide/images/nat-gateway-diagram.png\" alt=\"nat gateway diagram\"></p>\n<p>Hệ thống sẽ hoạt động như sau:</p>\n<ul>\n<li>NAT gateway nằm giữa server và Internet (chiều kết nối từ server ra internet)</li>\n<li>NAT gateway được gắn 1 IP cố đinh</li>\n<li>Tất cả các kết nối từ server tới internet được router điều hướng qua NAT Gateway trước khi tới Internet</li>\n</ul>\n<p>Như vậy suy ra việc bạn cần phải làm là:</p>\n<ul>\n<li>NAT Gateway cần được thiết lập để truy cập được internet</li>\n<li>Cần gắn một IP tĩnh cho NAT Gateway</li>\n<li>Cần điều hướng tất cả các kết nối của server qua NAT Gateway</li>\n</ul>\n<p>Tiếp theo sẽ là các bước cụ thể, phải làm thế nào</p>\n<h3>Bước 1: Chuẩn bị sẵn các tài nguyên cần thiết</h3>\n<ul>\n<li>1 VPC</li>\n<li>1 EIP (Elastic IP) chưa được sử dụng</li>\n<li>1 Route table cho internet access (public)</li>\n<li>1 Route table cho NAT Gateway (private)</li>\n<li>2 subnet (1 private, 1 public)</li>\n<li>servers (ở đây dùng luôn Loadbalanced EB servers)</li>\n</ul>\n<h3>Bước 2: Tạo 1 NAT Gateway mới</h3>\n<ul>\n<li>Subnet: chọn public subnet</li>\n<li>Elastic IP allocation ID: chọn EIP đã chuẩn bị</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1bb8b342b68abfd4cc401ec69333ff6c/b2b2c/create-gateway.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACE0lEQVQ4y51Uy5LaMBDkm3PMMfd8SC45pCqH/EQ2WXYrN8DGLPiB5adsY0xnevyAQIpQUVV7bGvU6nlIs+f5C+Yvr/j5PFd8f/qB+esv+CZFXhTI8hxplj0E+s7ctQfX28DbvCmWjoPFyoG33WGz3SJOkoE0V3sPJJ2tSeiu4bguFosldr6Puq5RliUKQVVV+l3dgfpb2xMaYxAEAfb7PRJRU0iYp9MJXdeJ7XA8Hh9C0zQ9YSREm7etKAtgq1pQqbIxf4e2RTdscIlxcHOOVvyUkJIzWZzKYpJQOom5azsq6G6VjkQ3hEEYwphEcsW8WVVHezgc1OneINkNIR+JoBASTbKETJV5UaodlY5qubCWfI1kN4RUM5a8FJVNy/yI46DgOnfdEP71mAhZDE+KspZe3AYRTF7qBqza6SKsESwQc8pINLo0g7XVmbCRFzuEyVCa5rK/Gu2xCTLP/yQgURBG8AOpQZJOG8x2Ox+ZvPSOVp3PxfkT0z/1s0qi68SyQ5RwsVyBx4+7MXyelH0cS5OnWn2CDU8byyEwSdLPJf13HBtRe6GQ7ZLnwyWQZtPkWNFHQF+mZKoyDz5JKd3q2W3wz8F2+VvbMBRHLgfeNMzH/45WeJWwKM7nllZV2mpSew0WpOB8GqEMVrDhWuCgCL3zScny7KGLlD5RFMELpDhPX2E+vYP58gHm83uYbx+lBgl+A845bePtgIFEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"create new gateway\"\n        title=\"create new gateway\"\n        src=\"/static/1bb8b342b68abfd4cc401ec69333ff6c/8c557/create-gateway.png\"\n        srcset=\"/static/1bb8b342b68abfd4cc401ec69333ff6c/4edbd/create-gateway.png 175w,\n/static/1bb8b342b68abfd4cc401ec69333ff6c/13ae7/create-gateway.png 350w,\n/static/1bb8b342b68abfd4cc401ec69333ff6c/8c557/create-gateway.png 700w,\n/static/1bb8b342b68abfd4cc401ec69333ff6c/e996b/create-gateway.png 1050w,\n/static/1bb8b342b68abfd4cc401ec69333ff6c/2cefc/create-gateway.png 1400w,\n/static/1bb8b342b68abfd4cc401ec69333ff6c/b2b2c/create-gateway.png 1708w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>NAT Gateway phải truy cập được internet nên phải chọn public subnet</p>\n<h3>Bước 3: Thiết lập Route table private</h3>\n<p>Tạo một route table mới, sau đó edit routes, thêm routes sau</p>\n<ul>\n<li>Destination: 0.0.0.0/0</li>\n<li>Target: chọn NAT gateway vừa tạo.</li>\n</ul>\n<p>Route table này có nhiệm vụ điều hướng tất cả kết nối đến và gửi tới NAT Gateway</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8c94e24b79205ea9ec382198a6b464ce/95be1/route-table-private.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAwklEQVQY032QXQ6DIBCEvf9lmvQQPmjTW9RWaBXlTy0w3aVGTR+64SPAbmZ3KIwxGMcRy7IgpYQY40YIYeP4/o+ibVswahjQ9yqjlELXdZBSghtqrfObkCIzUG2+C4GmafK5J7z3KG4Pibt4wc0BdnqvBGg7oa5rlGWJqqqy6OA09GSReHrCObc6i/DOghIohJDQNAUHW6a1kmCtzd/BYmwncU3esdVzhJhgPA0yk6D33y674M4xfnNHDDk6X584XQQ+Lm2DqvwDOisAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"route table\"\n        title=\"route table\"\n        src=\"/static/8c94e24b79205ea9ec382198a6b464ce/8c557/route-table-private.png\"\n        srcset=\"/static/8c94e24b79205ea9ec382198a6b464ce/4edbd/route-table-private.png 175w,\n/static/8c94e24b79205ea9ec382198a6b464ce/13ae7/route-table-private.png 350w,\n/static/8c94e24b79205ea9ec382198a6b464ce/8c557/route-table-private.png 700w,\n/static/8c94e24b79205ea9ec382198a6b464ce/e996b/route-table-private.png 1050w,\n/static/8c94e24b79205ea9ec382198a6b464ce/2cefc/route-table-private.png 1400w,\n/static/8c94e24b79205ea9ec382198a6b464ce/95be1/route-table-private.png 2574w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Sau khi tạo routes thì qua subnets. Click vào private subnet đã chuẩn bị và \"Edit route table association\".\nChọn lại Route table private vừa tạo</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/caa7d1e07a1301eaec7e62b94223d532/3162c/private-subnet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB4ElEQVQoz3WSbWvTUBTH820r070o/QDzQ5Qy+wAW0Q3xleiroQgyMWkzu2Z2Ky1FZ9c2aXJvcvP8sP49N0rpxnbhxz3hnJz7Pw+Kwxhs20GcZthsNltuiSRJiQRFUUCerZ/sorhFEARgXgAxUSFOuxBTDUoYhpjNZhicDzEej3F5Ncbo8gqTyRRxEiHPM8zncwwNA6PRaIthXJT/5XmOVDhI7D8ImEUJ8w2O377Dk0oFtVoN1WoVz/b3cXDwHNfOEovYwqvXb1DZ8cv76d4eGoeHyEitzBGT7IgKUXiU4MvXUzSbL/Cy2y3pdDo4OjrG3LFw41s4+fQZ9Xod7XYbzVYLLbobjQbef/gIP8nAgwjMD2F7PhTTNHGzWMCiPjLmwF5bcD0PaZYhiiIIT0D4PgJqzX186qEQAj75GZezsCmhtcav39c4Gwxw1vsOXfsG/ccA58MhjIufWFn/HngMxl3YDoMcLnddKMvVCpPpFP1+H6qqQdU09Ho9slXoul4qiOIYcnghKd5FVlCqY5wS8vIBxaOSpPHYSdMUOZWfEdLO/tslO9/SJ9ugcJJsmtbdQEImkXvIXFJIO5rResh9fAi5OuX6UFKFcV7WLxt8H+EHWHOBpeOB0wSDB2Luxvv4C1Jg2ssLKoDZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"private subnet\"\n        title=\"private subnet\"\n        src=\"/static/caa7d1e07a1301eaec7e62b94223d532/8c557/private-subnet.png\"\n        srcset=\"/static/caa7d1e07a1301eaec7e62b94223d532/4edbd/private-subnet.png 175w,\n/static/caa7d1e07a1301eaec7e62b94223d532/13ae7/private-subnet.png 350w,\n/static/caa7d1e07a1301eaec7e62b94223d532/8c557/private-subnet.png 700w,\n/static/caa7d1e07a1301eaec7e62b94223d532/e996b/private-subnet.png 1050w,\n/static/caa7d1e07a1301eaec7e62b94223d532/2cefc/private-subnet.png 1400w,\n/static/caa7d1e07a1301eaec7e62b94223d532/3162c/private-subnet.png 2750w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Như vậy tất cả server trong subnet private, kết nối tới internet sẽ đều được điều hướng thông qua NAT Gateway</p>\n<h3>Bước 4: Chuyển tất cả servers sang private subnet (DONE)</h3>\n<p>Khi tạo EB environment mới cần thực hiện đẩy đủ 1,2,3\nnhưng với EB có sẵn thì chỉ cần thực hiện bước 3 thôi.</p>\n<ol>\n<li>Phần Network: chọn VPC</li>\n<li>\n<p>Load balancer setting</p>\n<ul>\n<li>Visibility: chọn public</li>\n<li>Chọn public subnets.</li>\n</ul>\n</li>\n<li>\n<p>Instance settings</p>\n<ul>\n<li>Public IP addres: bỏ chọn</li>\n<li>Instance subnets: chọn private subnet</li>\n</ul>\n</li>\n</ol>\n<p>Như vậy ta đã hoàn tất các bước thiết lập IP cố định cho tất cả server trong 1 load balanced EB environment.\nĐể test thử thành quả thì rất đơn giản</p>\n<ul>\n<li>ssh vào server</li>\n<li>run <code class=\"language-text\">curl ipinfo.io</code> để kiểm tra IP của server</li>\n</ul>\n<h2>Kết</h2>\n<p>Bài viết đã</p>\n<ul>\n<li>trình bày cách làm thế nào để gắn IP cố định cho servers trong loadbalanced EB env</li>\n<li>giải thích ngắn gọn về cách hoạt động cũng như tại sao lại setting thế này, setting thế kia.</li>\n</ul>\n<p>Do ít thời gian nên bài viết chưa giải thích hết được các khái niệm được đề cập đến, một số bạn chưa có kinh nghiệm aws sẽ thấy khó hiểu. Thời gian tới tác giả sẽ cố gắng có nhiều bài chủ đề liên quan tới aws hơn.</p>\n<p>Cảm ơn mọi người đã đọc bài viết, nếu có comments thì liên lạc với mình qua email anh.nguyen@tomosia.com.</p>\n<p>[[author | Nguyen Tuan Anh ]]</p>","id":"9a7eaf02-7193-542e-b4e7-299864a2d04b","frontmatter":{"title":"Tạo IP tĩnh cho Elastic Beanstalk","date":"28-02-2021","tags":["aws"]},"fields":{"slug":"/tao-ip-tinh-cho-elastic-beanstalk/","readingTime":{"text":"5 min read"}}}},{"node":{"excerpt":"Trong bài này tôi sẽ hướng dẫn làm thế nào để Lambda (hay các resources khác trong AWS) thuộc private subnet có thể truy cập Internet. Ngoài ra, ta có thể chỉ định được IP cố định khi lambda truy cập…","snippet":"<div class=\"custom-block-body\"><p>Trong b&#xE0;i n&#xE0;y t&#xF4;i s&#x1EBD; h&#x1B0;&#x1EDB;ng d&#x1EAB;n l&#xE0;m th&#x1EBF; n&#xE0;o &#x111;&#x1EC3; Lambda (hay c&#xE1;c resources kh&#xE1;c trong AWS) thu&#x1ED9;c private subnet c&#xF3; th&#x1EC3; truy c&#x1EAD;p Internet. Ngo&#xE0;i ra, ta c&#xF3; th&#x1EC3; ch&#x1EC9; &#x111;&#x1ECB;nh &#x111;&#x1B0;&#x1EE3;c IP c&#x1ED1; &#x111;&#x1ECB;nh khi lambda truy c&#x1EAD;p internet</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Trong bài này tôi sẽ hướng dẫn làm thế nào để Lambda (hay các resources khác trong AWS) thuộc private subnet có thể truy cập Internet. Ngoài ra, ta có thể chỉ định được IP cố định khi lambda truy cập internet</p></div></div>\n<p><img src=\"https://blog.theodo.com/static/ab8c61557bfb8bb1310933f58d76e74c/a79d3/aws-vpc-internet-access-thumbnail-image.png\" alt=\"AWS VPC with Internet Access\"></p>\n<h2>1 - Create a VPC</h2>\n<blockquote>\n<p><strong>VPC</strong> (<strong>Virtual Private Cloud</strong>) Là mạng riêng ảo trên Cloud nơi mà bạn có thể tạo ra các tài nguyên cho hệ thống của mình, nó giúp bạn tạo ra một môi trường tách biệt, nơi mà bạn có thể triển khai hệ thống trong một hệ thống mạng ảo riêng mà bạn định nghĩa. Bạn có toàn quyền quyết định môi trường mạng ảo này sẽ như thế nào, bao gồm lựa chọn dải IP của riêng bạn, tạo mạng con (<strong>subnet</strong>), bảng định tuyến (<strong>route table</strong>) và cổng kết nối mạng (<strong>net gateway</strong>), cũng có thể sử dụng cả <strong>IPv4</strong> và <strong>IPv6</strong> cho bảo mật và dễ dàng truy cập ứng dụng, tài nguyên của bạn.</p>\n</blockquote>\n<p>Nếu bạn chưa có VPC thì bạn cần tạo 1 cái.\nĐể làm điều đó, đi đến tab Services, chọn VPC, click Your VPC phía bên trái menu và tạo 1 cái</p>\n<ul>\n<li>Nhập tên VPC, ví dụ <code class=\"language-text\">my-wonderful-vpc</code></li>\n<li>\n<p>Trong khối CIDR (class inter-domain routing) nhập 1 dải địa chỉ IP cho VPC của bạn, ví dụ 172.30.0.0/16\n<img src=\"https://blog.theodo.com/static/12dddc4cf6be0009fc21ad56da5414af/50383/create-vpc-image.png\" alt=\"create-vpc-image.png\"></p>\n<blockquote>\n<p>172.30.0.0/16 chúng ta gọi là network mask. Có nghĩa là tất cả IP sẽ bắt đầu từ 172.30.0.0 đến 172.30.255.255\n<img src=\"https://blog.theodo.com/static/49d09eacdd40b1b6616f6b32af3fa0ad/50383/infra-step-1-image.png\" alt=\"infra-step-1-image.png\"></p>\n</blockquote>\n</li>\n</ul>\n<h2>2 - Create private and public subnets in your VPC</h2>\n<blockquote>\n<p>Subnet đơn giản là 1 dải địa chỉ IP trong VPC. Subnet có thể được coi là phân chia các mạng lớn thành các mạng nhỏ hơn. Về việc chia các mạng nhỏ hơn sẽ giúp ta dễ dàng bảo trì, bảo mật tốt hơn.</p>\n</blockquote>\n<p>Để dùng lambda, bạn cần tạo 1 private subnet bên trong VPC.\nClick on Subnets bên trái menu VPC service và sau đó click Create Subnet:</p>\n<ul>\n<li>Nhập tên subnet của bạn, ví dụ <code class=\"language-text\">my-wonderful-vpc-private-subnet</code></li>\n<li>Chọn VPC mà bạn tạo ở bước trên (<code class=\"language-text\">my-wonder-vpc</code>)</li>\n<li>\n<p>Trong khối CIDR, chọn 1 dải IP con (subrange IPs addresses) trong dải IP của VPC, ví dụ 172.30.1.0/24 (từ 173.30.1.0 đến 172.30.1.25)\n<img src=\"https://blog.theodo.com/static/19139e2d6109ddc2f4335db22e427c4c/50383/create-subnet-image.png\" alt=\"create-subnet-image.png\"></p>\n<blockquote>\n<p>Để dễ trực quan hơn về CIDR bạn truy cập vào trang <a href=\"https://cidr.xyz/\">https://cidr.xyz/</a> để có thể biết được lớp mạng của bạn bắt đầu từ đầu và kết thúc ở đâu, có bao nhiêu IP.</p>\n</blockquote>\n</li>\n</ul>\n<p>Lặp lại bước trên, ta sẽ tạo public subnets, ví dụ <code class=\"language-text\">my-wonderfull-vpc-public</code> subnet với 1 dải IP con là 172.30.2.0/24.\nBạn sẽ thiết lập public subnet và private subnet ở bước thứ 4.\n<img src=\"https://blog.theodo.com/static/08e12c442dc676f731fb65be57f54f49/50383/infra-step-2-image.png\" alt=\"infra-step-2-image.png\"></p>\n<h2>3 - Create an Internet Gateway and a NAT Gateway in the VPC</h2>\n<blockquote>\n<p>Internet Gateway (IGW) là 1 kết nối logical giữa VPC và Internet. Nó không phải là 1 thiết bị vật lý. Nếu VPC không có IGW thì các resources trong VPC không thể truy cập Internet.</p>\n</blockquote>\n<blockquote>\n<p>A Network Address Translation (NAT) giúp các instance trong private subnet có thể kết nối đến Internet, nhưng sẽ tránh Internet kết nối trực tiếp đến các instance bên trong VPC. Đề làm được điều này, NAT sẽ ánh xạ tất cả các địa chỉ IP private đã được chỉ định cho các Instance thành một địa chỉ IPv4 public được gọi là địa chỉ Elastic IP (EIP).</p>\n</blockquote>\n<p>Để truy cập Internet, bạn sẽ cần gắn IGW đến VPC.\nChọn Internet Gateways bên menu trái và sau đó click button Create internet gateway:</p>\n<ul>\n<li>Nhập tên IGW, ví dụ <code class=\"language-text\">my-wonderful-vpc-igw</code>\n<img src=\"https://blog.theodo.com/static/41ce266991f341fdb961aadce3a59dc0/50383/create-internet-gateway-image.png\" alt=\"create-internet-gateway-image.png\"></li>\n</ul>\n<p>Bạn sẽ cần gắn (attach) IGW cho VPC. Mở lại tab IGW, chọn IGW mà bạn vừa tạo (<code class=\"language-text\">my-wonderful-vpc-igw</code>), click vào Action, chọn Attach to VPC và chọn VPC của bạn (<code class=\"language-text\">my-wonderful-vpc</code>).\nBạn cũng cần tạo NAT Gateway. Click NAT Gateways bên trái menu và sau đó click button Create NAT Gateway:</p>\n<ul>\n<li>Chọn subnet mà bạn muốn public (<code class=\"language-text\">my-vonderful-vpc-public-subnet</code>)</li>\n<li>Chọn 1 Elastic IPs. Nếu bạn chưa có, thì click Create New EIP.\n<img src=\"https://blog.theodo.com/static/7aa827098d17caed31765460b403b981/50383/create-nat-gateway-image.png\" alt=\"create-nat-gateway-image.png\"></li>\n</ul>\n<p>Bây giờ, Infra của bạn sẽ trông như thế này:\n<img src=\"https://blog.theodo.com/static/803d02f074409334a01dae329754468b/50383/infra-step-3-image.png\" alt=\"infra-step-3-image.png\"></p>\n<h2>4 - Associate the right route tables to the subnets</h2>\n<blockquote>\n<p>Route table là một tập hợp các quy tắc routes, nó sẽ định tuyến đường đi cho traffic. Bạn có thể tạo ra nhiều Route table trong VPC nếu bạn muốn. Route table có thể liên kết đến một hoặc nhiều subnets.\nRemarks:</p>\n<ul>\n<li>Mặc dù nếu bạn không tạo route table, thì mặc định sẽ có một main route table default và tất cả các subnets trong VPC sẽ liên kết đến main route table này.\nNếu subnet liên kết đến route table có gắn IGW thì nó được gọi là public subnet.</li>\n</ul>\n</blockquote>\n<p>Chúng ta sẽ tạo 2 custom route table cho mỗi subnets.\nTrong VPC service, click Route Tables bên menu trái và click button Create route table:</p>\n<ul>\n<li>Nhập tên route table, ví dụ <code class=\"language-text\">my-wonderful-vpc-public-route-table</code> và <code class=\"language-text\">my-wonderful-vpc-private-route-table</code></li>\n<li>Chọn VPC đã tạo ở bước 1 (<code class=\"language-text\">my-wonderful-vpc</code>)\n<img src=\"https://blog.theodo.com/static/68f753b7d01ec4f6c004db14956c2331/50383/create-route-table-image.png\" alt=\"create-route-table-image.png\"></li>\n</ul>\n<p>Bây giờ bạn có 2 route tables, chúng ta sẽ thiết lập chúng. Đầu tiên là public subnet.\nQuay trở lại Route Table và chọn tạo route table <code class=\"language-text\">my-wonderful-vpc-public-route-table</code>:</p>\n<ul>\n<li>Click tab Route</li>\n<li>Click button Edit routes</li>\n<li>Thêm 1 route mới với destination 0.0.0.0/0 và Target là IGW ID <code class=\"language-text\">igw-...</code> đã tạo ở bước 3 và click Save Routes\n<img src=\"https://blog.theodo.com/static/307cc080b0692cdf810187dfd87fb3c1/50383/configure-public-route-table-routes-image.png\" alt=\"configure-public-route-table-routes-image.png\"></li>\n<li>Sau đó, click tab Subnet Associations</li>\n<li>Click button Edit subnet associations</li>\n<li>Thêm public subnet <code class=\"language-text\">my-wonderful-vpc-public-subnet</code> đã tạo ở bước 2 và click Save.\n<img src=\"https://blog.theodo.com/static/051d00934b4a2e260d9db69048d3d22f/50383/configure-public-route-table-subnet-association-image.png\" alt=\"configure-public-route-table-subnet-association-image.png\"></li>\n</ul>\n<p>Với cách làm như trên, bạn đã điều hướng tất cả các outgoing traffic (Traffic đầu ra) của public subnet đến IGW, điều này sẽ làm cho subnet này thành public subnet.</p>\n<p>Bây giờ, sẽ thiết lập private route table. Quay lại tab Route Tables và chọn route table <code class=\"language-text\">my-wonderful-vpc-private-route-table</code>:</p>\n<ul>\n<li>Click tab Routes</li>\n<li>Click button Edit routes</li>\n<li>Thêm route với Destination 0.0.0.0/0 và Target là NAT Gateway ID <code class=\"language-text\">nat-...</code> tạo ở bước 3 và click Save Routes.</li>\n<li>Click tab Subnet Associations</li>\n<li>Click button Edit subnet associations</li>\n<li>Add private subnet <code class=\"language-text\">my-wonderful-vpc-private-subnet</code> ở bước 2 và click Save.</li>\n</ul>\n<p>Với cách làm này, bạn đã điều hướng tất cả traffic của private subnet đến NAT Gateway.\n<img src=\"https://blog.theodo.com/static/f031e446d606674453849748d76df61c/50383/infra-step-4-image.png\" alt=\"infra-step-4-image.png\"></p>\n<h2>5 - Create the lambda function and configure it</h2>\n<p>Phần khó nhất đã xong\nNếu bạn chưa tạo Lambda thì đi đến tab Lambda service, sau đó click button Create function:</p>\n<ul>\n<li>Chọn tên Lambda, ví dụ <code class=\"language-text\">my-wonderful-lambda</code></li>\n<li>Chọn Node.js runtime</li>\n<li>Trong section Permission, chọn <code class=\"language-text\">create a new role with basic lambda permissions</code>\n<img src=\"https://blog.theodo.com/static/a94a4a7cf62d680e58e0af7d130f7e64/50383/configure-lambda-permissions-image.png\" alt=\"configure-lambda-permissions-image.png\"></li>\n</ul>\n<p>Click vào function lambda vừa tạo, nó sẽ mở ra 1 trang thiết lập. Kéo xuống tab Network và bạn phải điền 3 thứ:</p>\n<ul>\n<li>VPC đã tạo ở bước 1 (<code class=\"language-text\">my-wonderful-vpc</code>)</li>\n<li>Private subnet đã tạo ở bước 2 (<code class=\"language-text\">my-wonderful-vpc-private-subnet</code>)</li>\n<li>Security Group là default hoặc Security Group mà bạn tự custom <code class=\"language-text\">**your-vpc-name**-default-security-group</code>\n<img src=\"https://blog.theodo.com/static/b2e31ea61377158c21380d99bb121885/50383/configure-lambda-vpc-image.png\" alt=\"configure-lambda-vpc-image.png\"></li>\n</ul>\n<h3>🔥🔥 Congrats, that's all, your AWS lambda function has access to Internet! 🔥🔥</h3>\n<p><img src=\"https://blog.theodo.com/static/ed3e678879d7cd543ba42ce4566b8c9e/50383/infra-step-5-image.png\" alt=\"infra-step-5-image.png\"></p>\n<p><em>Nguồn: <a href=\"https://blog.theodo.com/2020/01/internet-access-to-lambda-in-vpc/\">https://blog.theodo.com/2020/01/internet-access-to-lambda-in-vpc/</a></em></p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Minh Tang Q. </div><div class=\"custom-block-body\"></div></div>","id":"c33ecae0-654e-5070-91f2-aef77d66722a","frontmatter":{"title":"[AWS] Why my Lambda cannot access Internet anymore from its AWS VPC?","date":"19-02-2021","tags":["aws"]},"fields":{"slug":"/aws-why-my-lambda-cannot-access-internet-anymore-from-its-aws-vpc/","readingTime":{"text":"6 min read"}}}},{"node":{"excerpt":"Amazon Elastic Container Registry (ECR) là dịch vụ lưu trữ bộ chứa Docker được quản lý đầy đủ giúp các nhà phát triển dễ dàng lưu trữ, quản lý và triển khai hình ảnh bộ chứa Docker. Amazon ECR được…","snippet":"<html><head></head><body><p>Amazon Elastic Container Registry (<strong>ECR</strong>) l&#xE0; d&#x1ECB;ch v&#x1EE5; l&#x1B0;u tr&#x1EEF; b&#x1ED9; ch&#x1EE9;a Docker &#x111;&#x1B0;&#x1EE3;c qu&#x1EA3;n l&#xFD; &#x111;&#x1EA7;y &#x111;&#x1EE7; gi&#xFA;p c&#xE1;c nh&#xE0; ph&#xE1;t tri&#x1EC3;n d&#x1EC5; d&#xE0;ng l&#x1B0;u tr&#x1EEF;, qu&#x1EA3;n l&#xFD; v&#xE0; tri&#x1EC3;n khai h&#xEC;nh &#x1EA3;nh b&#x1ED9; ch&#x1EE9;a Docker. Amazon <strong>ECR</strong> &#x111;&#x1B0;&#x1EE3;c t&#xED;ch h&#x1EE3;p v&#x1EDB;i Amazon Elastic Container Service (ECS),&#x2026;</p></body></html>","html":"<p>Amazon Elastic Container Registry (<strong>ECR</strong>) là dịch vụ lưu trữ bộ chứa <a href=\"https://aws.amazon.com/vi/docker/\">Docker</a> được quản lý đầy đủ giúp các nhà phát triển dễ dàng lưu trữ, quản lý và triển khai hình ảnh bộ chứa Docker. Amazon <strong>ECR</strong> được tích hợp với <a href=\"https://aws.amazon.com/vi/ecs/\">Amazon Elastic Container Service (ECS)</a>, giúp đơn giản hóa quy trình công việc từ khi khâu phát triển đến khâu sản xuất. Amazon ECR giúp bạn không phải vận hành các kho bộ chứa riêng hay thay đổi quy mô cơ sở hạ tầng ngầm. Amazon ECR sẽ trở thành máy chủ lưu trữ hình ảnh của bạn trong kiến trúc có độ sẵn sàng cao và quy mô linh hoạt, cho phép bạn triển khai các bộ chứa cho ứng dụng của mình một cách ổn định. Khả năng tích hợp với AWS Identity and Access Management (<strong>IAM</strong>) đem đến cho bạn khả năng kiểm soát từng kho ở cấp tài nguyên. Với Amazon <strong>ECR</strong>, bạn sẽ không phải trả tiền trước hay có cam kết gì. Bạn chỉ phải chi trả chi phí cho lượng dữ liệu bạn lưu trong các kho cũng như dữ liệu được truyền lên Internet.\n<img src=\"https://d1.awsstatic.com/diagrams/product-page-diagrams/Product-Page-Diagram_Amazon-ECR.bf2e7a03447ed3aba97a70e5f4aead46a5e04547.png\" alt=\"enter image description here\"></p>\n<h1>Lợi ích</h1>\n<ul>\n<li>Đây là dịch vụ lưu trữ Docker image cho các dự án và nhiều môi trường sử dụng nền tảng đám mây <strong>AWS</strong>, ECR cho phép bạn tạo phân vùng theo <a href=\"https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html\">region</a> định sẵn.</li>\n<li>Sự kết hợp tuyệt vời với <strong>AWS \u001dBeanstalk</strong>, đối với các dự án tích hợp deploy bằng CI/CD khi \u001c sử dụng đến <em>Beanstalk</em> thì Docker ECR là một trong những sự lựa tối ưu và đa dụng \u001dnhất trong hệ sinh thái đám mây AWS.</li>\n<li><strong>Docker ECR</strong> được mã hoá file và sử dụng AWS Identity nên chỉ có thể truy cập và sử dụng nếu có Identity, bạn không thể copy nguyên link của Docker image này rồi truy cập ở một nơi khác khi không có Identity được. Bạn có thể build image từ local, CI/CD và pust lên Docker ECR kèm theo <strong>Identity</strong> đã cho.</li>\n<li>\n<p>Dựa vào region đã định sẵn nên tốc độ build/deploy dự án sẽ nhanh hơn là dùng Docker hub, bạn có thể sử dụng một repo chứa nhiều môi trường(test, develop, staging).</p>\n<h2>Được quản lý toàn phần</h2>\n</li>\n</ul>\n<p>Amazon Elastic Container Registry giúp bạn không phải vận hành và thay đổi quy mô cơ sở hạ tầng để làm nền tảng hoạt động cho sổ đăng ký bộ chứa của mình. Bạn sẽ không cần phải cài đặt và quản lý phần mềm hay thay đổi quy mô cơ sở hạ tầng. Chỉ cần đẩy hình ảnh trong bộ chứa của bạn lên Amazon ECR và lấy hình ảnh ra bằng bất kỳ công cụ quản lý bộ chứa nào khi bạn cần triển khai.</p>\n<h2>Độ sẵn sàng cao</h2>\n<p>Amazon Elastic Container Registry có kiến trúc bền bỉ, dư thừa và có quy mô cực kỳ linh hoạt. Các hình ảnh trong bộ chứa của bạn rất dễ sử dụng và truy cập, nên bạn có thể triển khai ổn định các bộ chứa mới cho ứng dụng của mình.</p>\n<h2>Bảo mật</h2>\n<p>Amazon Elastic Container Registry truyền hình ảnh của bạn qua kết nối HTTPS và tự động mã hóa hình ảnh được lưu trữ của bạn. Bạn có thể cấu hình các chính sách để quản lý quyền và kiểm soát truy cập vào hình ảnh của bạn bằng cách sử dụng người dùng và vai trò của AWS Identity and Access Management (IAM) mà không phải trực tiếp quản lý thông tin xác thực trên phiên bản EC2.</p>\n<h2>Quy trình công việc đơn giản hoá nhất có thể</h2>\n<p>Amazon Elastic Container Registry được tích hợp với Amazon ECS và CLI Docker, đem đến cho bạn khả năng đơn giản hóa quy trình công việc phát triển và sản xuất. Bạn có thể dễ dàng đẩy hình ảnh trong bộ chứa của bạn lên Amazon ECR bằng cách sử dụng CLI Docker từ bộ máy phát triển của bạn rồi Amazon ECS sẽ có thể lấy trực tiếp từ đó để phục vụ quá trình triển khai sản xuất.</p>\n<h1>Kết hợp với CI/CD</h1>\n<h2>Ưu điểm:</h2>\n<ul>\n<li>Từ các ứng dụng CI/CD hot nhất hiện nay như: Circleci, Github Action, Gitlab Action,... có thể sử dụng để build các Docker image <strong>ECR</strong> và thực hiện testing trong các Docker container đó rất tiện dụng và giảm thiểu khả năng rủi do cho môi trường production.</li>\n<li>Chúng ta có thể linh động để build các job theo quy trình để kiểm thử code, docker hoạt động có chơn chu hay không trước khi tiến đến bước deploy dự án,...</li>\n<li>Sử dụng Docker ECR trong CI bạn sẽ không cần phải mất nhiều thời gian để đi chỉ cho các thanh niên develop khác rằng đoạn code này có thể lỗi hay không và lỗi đó ở đâu, cách fix như thế nào, các thanh niên đó sẽ tự biết cách fix và tìm hiểu,... Bạn có thể dành time làm các công việc khác trong một mớ công việc được giao :D.</li>\n<li>\n<p>Bạn có thể kết nối đến các <strong>RDS</strong> từ bên trong mỗi container.</p>\n<h2>Nhược điểm:</h2>\n</li>\n<li>Docker ECR chỉ dành cho khách hàng chịu chơi, bạn sẽ phải tốn thêm chi phí cho mỗi lần build và deploy dự án.</li>\n<li>Chỉ dành cho người về Docker mới có thể build và sử dụng.</li>\n<li>Chỉ dành cho các dự án có sử dụng đến nền tảng đám mây AWS.</li>\n<li>Tài liệu về Docker ECR còn ít đòi hỏi khả năng research của bạn phải đạt mức thượng thừa :D.</li>\n<li>Bạn phải am hiểu về AWS mới có thể cấu hình cho dự án hoạt động đúng yêu cầu.</li>\n</ul>\n<h1>Kết luận</h1>\n<p>Từ bài viết này bạn đã phần nào hình dung về <strong>AWS Docker ECR</strong> rồi đúng không nào, đừng ngại ngần hãy đề xuất và áp dụng vào dự án nhé, nó sẽ rất linh hoạt cho dự án của bạn đó.\nBạn sẽ cần tốn chút time tìm hiểu xem cơ chế hoạt động của nó thế nào,.. :D  đừng lo lắng, nó đơn giản lắm:</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Lê Văn Chiến </div><div class=\"custom-block-body\"></div></div>","id":"c4f936a4-80ba-5a9e-9798-d18167228a62","frontmatter":{"title":"About Amazon Elastic Container Registry (ECR)","date":"18-10-2020","tags":["docker","aws","erc","ci","git"]},"fields":{"slug":"/about-amazon-elastic-container-registry-ecr/","readingTime":{"text":"6 min read"}}}},{"node":{"excerpt":"Crawling dữ liệu không phải là khái niệm quá xa lạ, nhưng để lấy dữ liệu từ một website đôi khi chúng ta cũng hay gặp tình trạng bị chặn IP dẫn đến server không thể tiếp lục dữ liệu. Ý tưởng. Ý tưởng…","snippet":"<html><head></head><body><p>Crawling d&#x1EEF; li&#x1EC7;u kh&#xF4;ng ph&#x1EA3;i l&#xE0; kh&#xE1;i ni&#x1EC7;m qu&#xE1; xa l&#x1EA1;, nh&#x1B0;ng &#x111;&#x1EC3; l&#x1EA5;y d&#x1EEF; li&#x1EC7;u t&#x1EEB; m&#x1ED9;t website &#x111;&#xF4;i khi ch&#xFA;ng ta c&#x169;ng hay g&#x1EB7;p t&#xEC;nh tr&#x1EA1;ng b&#x1ECB; ch&#x1EB7;n IP d&#x1EAB;n &#x111;&#x1EBF;n server kh&#xF4;ng th&#x1EC3; ti&#x1EBF;p l&#x1EE5;c d&#x1EEF; li&#x1EC7;u.</p> <h5>&#xDD; t&#x1B0;&#x1EDF;ng.</h5> <p>&#xDD; t&#x1B0;&#x1EDF;ng &#x111;&#x1EC3; gi&#x1EA3;i quy&#x1EBF;t v&#x1EA5;n &#x111;&#x1EC1; &#x111;&#x1EA5;y&#x2026;</p></body></html>","html":"<p>Crawling dữ liệu không phải là khái niệm quá xa lạ, nhưng để lấy dữ liệu từ một website đôi khi chúng ta cũng hay gặp tình trạng bị chặn IP dẫn đến server không thể tiếp lục dữ liệu.</p>\n<h4>Ý tưởng.</h4>\n<p>Ý tưởng để giải quyết vấn đề đấy là chúng ta sẽ tiến hành tạo một service IP rotator để renew lại IP khi website hoặc API chúng ta muốn lấy dữ liệu chặn IP.</p>\n<p>Ý tưởng có vẻ hay nhưng vấn đề là làm sao chúng ta có một lượng địa chỉ IP đủ lớn để thay đổi cho server và thời gian thay đổi IP cho server có quá mất thời gian hay khó khăn.</p>\n<p>Rất may là AWS có một dịch vụ với tên gọi là <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html\">Elastic I\u001dP</a> , cho phép tạo ra một IP và đính kèm vào server, tất nhiên server trong trường hợp này chúng ta phải sử dụng EC2 :))).</p>\n<p>Với <code class=\"language-text\">Elastic I\u001dP</code> thì sẽ không bị tính phí phát sinh nếu bạn tạo ra một địa chỉ ip mới được gán vào cho EC2 và phải xoá ip cũ đi.</p>\n<h4>Giải pháp.</h4>\n<p>Thiên Thời Địa Lợi Nhân Hòa đều hội tụ ở đây cả chứ đâu, hay tiến hành thiết kế một sơ đồ để chúng ta có cái nhìn rõ hơn.</p>\n<div class=\"mermaid\" data-processed=\"true\"><svg id=\"mermaid-1617000207712\" width=\"261.796875\" xmlns=\"http://www.w3.org/2000/svg\" height=\"383\" viewBox=\"0 0 261.796875 383\"><style>#mermaid-1617000207712 .label{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);color:#333}#mermaid-1617000207712 .label text{fill:#333}#mermaid-1617000207712 .node rect,#mermaid-1617000207712 .node circle,#mermaid-1617000207712 .node ellipse,#mermaid-1617000207712 .node polygon,#mermaid-1617000207712 .node path{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-1617000207712 .node .label{text-align:center}#mermaid-1617000207712 .node.clickable{cursor:pointer}#mermaid-1617000207712 .arrowheadPath{fill:#333}#mermaid-1617000207712 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1617000207712 .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-1617000207712 .edgeLabel rect{opacity:0.5}#mermaid-1617000207712 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mermaid-1617000207712 .cluster text{fill:#333}#mermaid-1617000207712 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1617000207712 .actor{stroke:#ccf;fill:#ECECFF}#mermaid-1617000207712 text.actor{fill:#000;stroke:none}#mermaid-1617000207712 .actor-line{stroke:grey}#mermaid-1617000207712 .messageLine0{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1617000207712 .messageLine1{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mermaid-1617000207712 #arrowhead{fill:#333}#mermaid-1617000207712 .sequenceNumber{fill:#fff}#mermaid-1617000207712 #sequencenumber{fill:#333}#mermaid-1617000207712 #crosshead path{fill:#333 !important;stroke:#333 !important}#mermaid-1617000207712 .messageText{fill:#333;stroke:none}#mermaid-1617000207712 .labelBox{stroke:#ccf;fill:#ECECFF}#mermaid-1617000207712 .labelText{fill:#000;stroke:none}#mermaid-1617000207712 .loopText{fill:#000;stroke:none}#mermaid-1617000207712 .loopLine{stroke-width:2;stroke-dasharray:'2 2';stroke:#ccf}#mermaid-1617000207712 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1617000207712 .noteText{fill:black;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:14px}#mermaid-1617000207712 .activation0{fill:#f4f4f4;stroke:#666}#mermaid-1617000207712 .activation1{fill:#f4f4f4;stroke:#666}#mermaid-1617000207712 .activation2{fill:#f4f4f4;stroke:#666}#mermaid-1617000207712 .mermaid-main-font{font-family:\"trebuchet ms\", verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .section{stroke:none;opacity:0.2}#mermaid-1617000207712 .section0{fill:rgba(102,102,255,0.49)}#mermaid-1617000207712 .section2{fill:#fff400}#mermaid-1617000207712 .section1,#mermaid-1617000207712 .section3{fill:#fff;opacity:0.2}#mermaid-1617000207712 .sectionTitle0{fill:#333}#mermaid-1617000207712 .sectionTitle1{fill:#333}#mermaid-1617000207712 .sectionTitle2{fill:#333}#mermaid-1617000207712 .sectionTitle3{fill:#333}#mermaid-1617000207712 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .grid .tick{stroke:#d3d3d3;opacity:0.8;shape-rendering:crispEdges}#mermaid-1617000207712 .grid .tick text{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .grid path{stroke-width:0}#mermaid-1617000207712 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1617000207712 .task{stroke-width:2}#mermaid-1617000207712 .taskText{text-anchor:middle;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .taskText:not([font-size]){font-size:11px}#mermaid-1617000207712 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1617000207712 .task.clickable{cursor:pointer}#mermaid-1617000207712 .taskText.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1617000207712 .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1617000207712 .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mermaid-1617000207712 .taskText0,#mermaid-1617000207712 .taskText1,#mermaid-1617000207712 .taskText2,#mermaid-1617000207712 .taskText3{fill:#fff}#mermaid-1617000207712 .task0,#mermaid-1617000207712 .task1,#mermaid-1617000207712 .task2,#mermaid-1617000207712 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1617000207712 .taskTextOutside0,#mermaid-1617000207712 .taskTextOutside2{fill:#000}#mermaid-1617000207712 .taskTextOutside1,#mermaid-1617000207712 .taskTextOutside3{fill:#000}#mermaid-1617000207712 .active0,#mermaid-1617000207712 .active1,#mermaid-1617000207712 .active2,#mermaid-1617000207712 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1617000207712 .activeText0,#mermaid-1617000207712 .activeText1,#mermaid-1617000207712 .activeText2,#mermaid-1617000207712 .activeText3{fill:#000 !important}#mermaid-1617000207712 .done0,#mermaid-1617000207712 .done1,#mermaid-1617000207712 .done2,#mermaid-1617000207712 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1617000207712 .doneText0,#mermaid-1617000207712 .doneText1,#mermaid-1617000207712 .doneText2,#mermaid-1617000207712 .doneText3{fill:#000 !important}#mermaid-1617000207712 .crit0,#mermaid-1617000207712 .crit1,#mermaid-1617000207712 .crit2,#mermaid-1617000207712 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1617000207712 .activeCrit0,#mermaid-1617000207712 .activeCrit1,#mermaid-1617000207712 .activeCrit2,#mermaid-1617000207712 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1617000207712 .doneCrit0,#mermaid-1617000207712 .doneCrit1,#mermaid-1617000207712 .doneCrit2,#mermaid-1617000207712 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1617000207712 .milestone{transform:rotate(45deg) scale(0.8, 0.8)}#mermaid-1617000207712 .milestoneText{font-style:italic}#mermaid-1617000207712 .doneCritText0,#mermaid-1617000207712 .doneCritText1,#mermaid-1617000207712 .doneCritText2,#mermaid-1617000207712 .doneCritText3{fill:#000 !important}#mermaid-1617000207712 .activeCritText0,#mermaid-1617000207712 .activeCritText1,#mermaid-1617000207712 .activeCritText2,#mermaid-1617000207712 .activeCritText3{fill:#000 !important}#mermaid-1617000207712 .titleText{text-anchor:middle;font-size:18px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:10px}#mermaid-1617000207712 g.classGroup text .title{font-weight:bolder}#mermaid-1617000207712 g.clickable{cursor:pointer}#mermaid-1617000207712 g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-1617000207712 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1617000207712 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-1617000207712 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1617000207712 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1617000207712 .dashed-line{stroke-dasharray:3}#mermaid-1617000207712 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1617000207712 .commit-id,#mermaid-1617000207712 .commit-msg,#mermaid-1617000207712 .branch-label{fill:lightgrey;color:lightgrey;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .pieTitleText{text-anchor:middle;font-size:25px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .slice{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 g.stateGroup text{fill:#9370db;stroke:none;font-size:10px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 g.stateGroup text{fill:#9370db;stroke:none;font-size:10px}#mermaid-1617000207712 g.stateGroup .state-title{font-weight:bolder;fill:#000}#mermaid-1617000207712 g.stateGroup rect{fill:#ECECFF;stroke:#9370db}#mermaid-1617000207712 g.stateGroup line{stroke:#9370db;stroke-width:1}#mermaid-1617000207712 .transition{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1617000207712 .stateGroup .composit{fill:white;border-bottom:1px}#mermaid-1617000207712 .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px}#mermaid-1617000207712 .state-note{stroke:#aa3;fill:#fff5ad}#mermaid-1617000207712 .state-note text{fill:black;stroke:none;font-size:10px}#mermaid-1617000207712 .stateLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mermaid-1617000207712 .stateLabel text{fill:#000;font-size:10px;font-weight:bold;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mermaid-1617000207712 .node circle.state-start{fill:black;stroke:black}#mermaid-1617000207712 .node circle.state-end{fill:black;stroke:white;stroke-width:1.5}#mermaid-1617000207712 #statediagram-barbEnd{fill:#9370db}#mermaid-1617000207712 .statediagram-cluster rect{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mermaid-1617000207712 .statediagram-cluster rect.outer{rx:5px;ry:5px}#mermaid-1617000207712 .statediagram-state .divider{stroke:#9370db}#mermaid-1617000207712 .statediagram-state .title-state{rx:5px;ry:5px}#mermaid-1617000207712 .statediagram-cluster.statediagram-cluster .inner{fill:white}#mermaid-1617000207712 .statediagram-cluster.statediagram-cluster-alt .inner{fill:#e0e0e0}#mermaid-1617000207712 .statediagram-cluster .inner{rx:0;ry:0}#mermaid-1617000207712 .statediagram-state rect.basic{rx:5px;ry:5px}#mermaid-1617000207712 .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#efefef}#mermaid-1617000207712 .note-edge{stroke-dasharray:5}#mermaid-1617000207712 .statediagram-note rect{fill:#fff5ad;stroke:#aa3;stroke-width:1px;rx:0;ry:0}:root{--mermaid-font-family: '\"trebuchet ms\", verdana, arial';--mermaid-font-family: \"Comic Sans MS\", \"Comic Sans\", cursive}\n\n:root { --mermaid-font-family: \"trebuchet ms\", verdana, arial;}</style><style>#mermaid-1617000207712 {\n    color: rgb(0, 0, 0);\n    font: 16px \"trebuchet ms\", verdana, arial;\n  }</style><g transform=\"translate(0, 0)\"><marker id=\"flowchart-pointEnd\" class=\"flowchart\" viewBox=\"0 0 10 10\" refX=\"10\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 0 L 10 5 L 0 10 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-pointStart\" class=\"flowchart\" viewBox=\"0 0 10 10\" refX=\"0\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\"><path d=\"M 0 5 L 10 10 L 10 0 z\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-circleEnd\" class=\"flowchart\" viewBox=\"0 0 10 10\" refX=\"11\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"7\" markerHeight=\"7\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"flowchart-circleStart\" class=\"flowchart\" viewBox=\"0 0 10 10\" refX=\"-1\" refY=\"5\" markerUnits=\"strokeWidth\" markerWidth=\"7\" markerHeight=\"7\" orient=\"auto\"><circle cx=\"5\" cy=\"5\" r=\"5\" class=\"arrowMarkerPath\" style=\"stroke-width: 1; stroke-dasharray: 1, 0;\"></circle></marker><marker id=\"flowchart-crossEnd\" class=\"flowchart\" viewBox=\"0 0 11 11\" refX=\"12\" refY=\"5.2\" markerUnits=\"strokeWidth\" markerWidth=\"7\" markerHeight=\"7\" orient=\"auto\"><path stroke=\"black\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><marker id=\"flowchart-crossStart\" class=\"flowchart\" viewBox=\"0 0 11 11\" refX=\"-1\" refY=\"5.2\" markerUnits=\"strokeWidth\" markerWidth=\"7\" markerHeight=\"7\" orient=\"auto\"><path stroke=\"black\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\" class=\"arrowMarkerPath\" style=\"stroke-width: 2; stroke-dasharray: 1, 0;\"></path></marker><g class=\"root\"><g class=\"clusters\"></g><g class=\"edgePaths\"><path d=\"M133.31677827380952,42L127.18846106150794,46.166666666666664C121.06014384920634,50.333333333333336,108.80350942460318,58.666666666666664,102.67519221230158,67C96.546875,75.33333333333333,96.546875,83.66666666666667,96.546875,87.83333333333333L96.546875,92\" id=\"id1\" class=\"transition\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M96.546875,125L96.546875,129.16666666666666C96.546875,133.33333333333334,96.546875,141.66666666666666,96.546875,150C96.546875,158.33333333333334,96.546875,166.66666666666666,96.546875,170.83333333333334L96.546875,175\" id=\"id2\" class=\"transition\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M96.546875,208L96.546875,212.16666666666666C96.546875,216.33333333333334,96.546875,224.66666666666666,96.546875,233C96.546875,241.33333333333334,96.546875,249.66666666666666,96.546875,253.83333333333334L96.546875,258\" id=\"id3\" class=\"transition\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M96.546875,291L96.546875,295.1666666666667C96.546875,299.3333333333333,96.546875,307.6666666666667,102.67519221230158,316C108.80350942460318,324.3333333333333,121.06014384920634,332.6666666666667,127.18846106150794,336.8333333333333L133.31677827380952,341\" id=\"id4\" class=\"transition\" marker-end=\"url(#flowchart-pointEnd)\"></path><path d=\"M183.32384672619048,341L189.45216393849205,336.8333333333333C195.58048115079364,332.6666666666667,207.83711557539684,324.3333333333333,213.9654327876984,313.25C220.09375,302.1666666666667,220.09375,288.3333333333333,220.09375,274.5C220.09375,260.6666666666667,220.09375,246.83333333333334,220.09375,233C220.09375,219.16666666666666,220.09375,205.33333333333334,220.09375,191.5C220.09375,177.66666666666666,220.09375,163.83333333333334,220.09375,150C220.09375,136.16666666666666,220.09375,122.33333333333333,220.09375,108.5C220.09375,94.66666666666667,220.09375,80.83333333333333,213.9654327876984,69.75C207.83711557539684,58.666666666666664,195.58048115079364,50.333333333333336,189.45216393849205,46.166666666666664L183.32384672619048,42\" id=\"id5\" class=\"transition\" marker-end=\"url(#flowchart-pointEnd)\"></path></g><g class=\"edgeLabels\"><g class=\"edgeLabel\"><g class=\"label\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g><g class=\"edgeLabel\"><g class=\"label\" transform=\"translate(0, 0)\"><foreignObject width=\"0\" height=\"0\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"edgeLabel\"></span></div></foreignObject></g></g></g><g class=\"nodes\"><g class=\"node default\" id=\"id1\" transform=\"translate(158.3203125, 25)\"><rect rx=\"17\" ry=\"17\" x=\"-82.34375\" y=\"-17\" width=\"164.6875\" height=\"34\"></rect><g class=\"label\" transform=\"translate(-70.59375, -9.5)\"><foreignObject width=\"141.1875\" height=\"19\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">1. Detect bị chặn IP</span></div></foreignObject></g></g><g class=\"node default\" id=\"id2\" transform=\"translate(96.546875, 108.5)\"><rect rx=\"16.5\" ry=\"16.5\" x=\"-82.328125\" y=\"-16.5\" width=\"164.65625\" height=\"33\"></rect><g class=\"label\" transform=\"translate(-70.703125, -9)\"><foreignObject width=\"141.40625\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">2.Allocate Elastic IP</span></div></foreignObject></g></g><g class=\"node default\" id=\"id3\" transform=\"translate(96.546875, 191.5)\"><rect rx=\"16.5\" ry=\"16.5\" x=\"-88.546875\" y=\"-16.5\" width=\"177.09375\" height=\"33\"></rect><g class=\"label\" transform=\"translate(-76.921875, -9)\"><foreignObject width=\"153.84375\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">3.Associate Elastic IP</span></div></foreignObject></g></g><g class=\"node default\" id=\"id4\" transform=\"translate(96.546875, 274.5)\"><rect rx=\"16.5\" ry=\"16.5\" x=\"-83.21875\" y=\"-16.5\" width=\"166.4375\" height=\"33\"></rect><g class=\"label\" transform=\"translate(-71.59375, -9)\"><foreignObject width=\"143.1875\" height=\"18\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">4.Release Elastic IP</span></div></foreignObject></g></g><g class=\"node default\" id=\"id5\" transform=\"translate(158.3203125, 358)\"><rect rx=\"17\" ry=\"17\" x=\"-95.4765625\" y=\"-17\" width=\"190.953125\" height=\"34\"></rect><g class=\"label\" transform=\"translate(-83.7265625, -9.5)\"><foreignObject width=\"167.453125\" height=\"19\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: inline-block; white-space: nowrap;\"><span class=\"nodeLabel\">5.Tiếp tục crawl dữ liệu</span></div></foreignObject></g></g></g></g></g></svg></div>\n<h4>Viết code để triển khai ý tưởng.</h4>\n<p> Tôi tạo một file mới đặt tên <code class=\"language-text\">aws-ip-rotator.sh</code>. Ở đây mình dùng <code class=\"language-text\">shell script</code> và <code class=\"language-text\">aws-cli</code> để viết code, các dịch vụ của aws hầu như đều có thư viện cho hầu hết các ngôn ngữ lập trình hay dùng. Nên chúng ta hoàn toàn có thể triển khai ý tưởng bằng các ngôn ngữ khác như ruby, php, nodejs,...</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token assign-left variable\"><span class=\"token environment constant\">INSTANCE</span></span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> -s http://169.254.169.254/latest/meta-data/instance-id<span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">OLD_IP</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> -s http://169.254.169.254/latest/meta-data/public-ipv4<span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">OLD_ALLOCATION_ID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws ec2 describe-addresses --public-ips $OLD_IP --query <span class=\"token string\">\"Addresses[0].AllocationId\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">tr</span> -d <span class=\"token string\">'\"'</span><span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">NEW_IP</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws ec2 allocate-address --query PublicIp <span class=\"token operator\">|</span> <span class=\"token function\">tr</span> -d <span class=\"token string\">'\"'</span><span class=\"token variable\">)</span></span>\naws ec2 associate-address --instance-id <span class=\"token environment constant\">$INSTANCE</span> --public-ip <span class=\"token variable\">$NEW_IP</span>\naws ec2 release-address --allocation-id <span class=\"token variable\">$OLD_ALLOCATION_ID</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>Giải thích chi tiết 6 dòng code.</h4>\n<ul>\n<li>\bDòng 3: Lấy giá trị Instance ID của EC2 hiện tại đang request.</li>\n<li>Dòng 4: Lấy địa chỉ IP hiện tại của EC2.</li>\n<li>Dòng 5: Lấy Allocation ID của IP hiện tại liên kết với EC2.</li>\n<li>Dòng 6: Tạo ra một địa chỉ IP hoàn toàn mới để thay thế cho IP hiện tại.</li>\n<li>Dòng 7: Đính kèm IP mới vào EC2.</li>\n<li>Dòng 8: Xoá IP cũ để tránh \u001dAWS tính thêm phí phát sinh.</li>\n</ul>\n<p> Vậy là chúng ta đã tạo ra một IP rotator chỉ với 6 dòng code, với đoạn code trên nó có thể hoạt động đối với EC2-Classic và cả EC2-VPC. Chúng ta cũng có thể chạy trực tiếp file code ở trên trong  dự án hoặc  cũng có thể setting một con cronjob.</p>","id":"e3ab2296-90b6-553a-be63-c728aa23da72","frontmatter":{"title":"[Aws] Tạo IP rotator cho server với Elastic IP AWS chỉ 6 dòng code","date":"21-07-2020","tags":["aws"]},"fields":{"slug":"/aws-tao-ip-rotator-cho-server-voi-elastic-ip-aws-chi-6-dong-code/","readingTime":{"text":"3 min read"}}}},{"node":{"excerpt":"Vấn đề đặt ra Thứ nhất: Làm thế nào để hiển thị 100 tấm ảnh/1 trang một cách nhanh nhất? Đảm bảo tối ưu tốc độ load ảnh, nâng cao hiệu quả SEO Google và trải nghiệm người dùng tốt hơn. Thứ hai: Để…","snippet":"<html><head></head><body><h3>V&#x1EA5;n &#x111;&#x1EC1; &#x111;&#x1EB7;t ra</h3> <ul> <li>Th&#x1EE9; nh&#x1EA5;t: L&#xE0;m th&#x1EBF; n&#xE0;o &#x111;&#x1EC3; hi&#x1EC3;n th&#x1ECB; 100 t&#x1EA5;m &#x1EA3;nh/1 trang m&#x1ED9;t c&#xE1;ch nhanh nh&#x1EA5;t? &#x110;&#x1EA3;m b&#x1EA3;o t&#x1ED1;i &#x1B0;u t&#x1ED1;c &#x111;&#x1ED9; load &#x1EA3;nh, n&#xE2;ng cao hi&#x1EC7;u qu&#x1EA3; SEO Google v&#xE0; tr&#x1EA3;i nghi&#x1EC7;m ng&#x1B0;&#x1EDD;i d&#xF9;ng t&#x1ED1;t h&#x1A1;n.</li> <li>Th&#x1EE9; hai: &#x110;&#x1EC3; ng&#x1B0;&#x1EDD;i d&#xF9;ng \u001dupload &#x1EA3;nh l&#xEA;n server&#x2026;</li></ul></body></html>","html":"<h2>Vấn đề đặt ra</h2>\n<ul>\n<li>Thứ nhất: Làm thế nào để hiển thị 100 tấm ảnh/1 trang một cách nhanh nhất? Đảm bảo tối ưu tốc độ load ảnh, nâng cao hiệu quả SEO Google và trải nghiệm người dùng tốt hơn.</li>\n<li>Thứ hai: Để người dùng \u001dupload ảnh lên server với dung lượng trên 500MB. Nếu để web server xử lý quá trình nhận dữ liệu từ user upload lên, sau đó convert đối với file có dung lượng lớn thì không hề ổn chút nào. Vậy để giảm tải cho web server thì ta sẽ sử dụng serverless trong tình huống này. <a href=\"https://aws.amazon.com/vi/serverless/\">(Vì sao sử dụng serverless?)</a></li>\n</ul>\n<h2>Sự trổi dậy của Webp</h2>\n<p><img src=\"https://miro.medium.com/max/1698/1*fRLZo9RWFkC2rkHXJzrdQA.png\" alt=\"Compare\"></p>\n<p>Định dạng WebP đã trở nên ngày càng phổ biến kể từ khi Google giới thiệu nó vào năm 2010. Điểm mạnh lớn nhất của nó nằm ở khả năng tạo kích thước tệp nhỏ hơn nhiều trong khi vẫn duy trì chất lượng hình ảnh tương tự.</p>\n<p>Định dạng Webp sẽ giúp bạn giảm 26%  dung lượng so với PNG. và  25 – 34% so với định dạng JPEG, mà vẫn vẫn giữ được chất lượng hiển thị. Điều này giúp web giảm thời gian tải ảnh, tăng tốc độ trải nghiệm người dùng.</p>\n<div class=\"custom-block image-caption\"><div class=\"custom-block-heading\">Nguồn từ: <a href=\"https://bitsofco.de/why-and-how-to-use-webp-images-today/\">https://bitsofco.de/why-and-how-to-use-webp-images-today/</a> </div><div class=\"custom-block-body\"><p><img src=\"https://user-images.githubusercontent.com/59222278/85985771-616f8700-ba15-11ea-9f7c-0b2161fa86f9.png\" alt=\"Compare\"></p></div></div>\n<p>Tuy nhiên với định dạng Webp thì không phải tất cả các trình duyệt đều hỗ trợ. Hiện tại, WebP thực sự được hỗ trợ trong các phiên bản mới nhất của Google Chrome, Firefox, Edge, trình duyệt Opera, Trình duyệt Android và Samsung internet.</p>\n<div class=\"custom-block image-caption\"><div class=\"custom-block-heading\">WebP support table: <a href=\"https://bitsofco.de/why-and-how-to-use-webp-images-today/\">https://bitsofco.de/why-and-how-to-use-webp-images-today/</a> </div><div class=\"custom-block-body\"><p><img src=\"https://user-images.githubusercontent.com/59222278/85986227-19049900-ba16-11ea-8707-5e09c467ba4f.png\" alt=\"Compare\"></p></div></div>\n<h2>Triển khai ý tưởng</h2>\n<p>Ở browser, khi người dùng upload ảnh thì web server sẽ có nhiệm vụ gián tiếp nhận hình ảnh, xác thực và đẩy ảnh lên S3 để lưu trữ. Khi S3 nhận thấy rằng có ảnh mới được đẩy lên sẽ gọi (trigger) đến lambda để tiến hành convert sang dạng webp. Sau khi convert ảnh thì sẽ được lưu tại thư mục mới mà ta chỉ định (dĩ nhiên ta sẽ không override lại ảnh gốc mà user đẩy lên, mà là tạo ra 1 file ảnh thumb với định dạng webp). Trong quá trình  Lambda xử lý ta có thể dùng cloudWatch để debug.</p>\n<div class=\"custom-block image-caption\"><div class=\"custom-block-heading\">Diagram S3 Lambda </div><div class=\"custom-block-body\"><p><img src=\"https://user-images.githubusercontent.com/59222278/85989062-30458580-ba1a-11ea-9a22-4dad722102d8.png\" alt=\"Diagram S3 Lambda\"></p></div></div>\n<p>Vậy để chuyển đổi ảnh sang định dạng Webp thì chúng ta có thể dùng <a href=\"https://imagemagick.org/index.php\">imageMagick</a> hoặc <a href=\"https://developers.google.com/speed/webp/docs/cwebp\">cwebp</a>.</p>\n<div class=\"custom-block image-caption\"><div class=\"custom-block-body\"><p><img src=\"https://miro.medium.com/max/500/1*_TeG6-eUitTR_l3SKpJ5Ow.jpeg\" alt=\"LEGENDARY\"></p></div></div>\n<h2>Thực hiện</h2>\n<h3>1. Ở màn hình console Cloud AWS</h3>\n<p>Truy cập IAM, chọn roles và tạo full quyền S3 và CloudWatch để Lambda có thể lấy dữ liệu từ S3 và ghi log vào cloudWatch. Ở đây ta đặt tên là <code class=\"language-text\">full-s3-logs</code></p>\n<p><img src=\"https://i.imgur.com/Rew8ydu.png\"></p>\n<p>Chuẩn bị 1 cặp <code class=\"language-text\">access_key_id</code> và <code class=\"language-text\">secret_key_id</code>. Nếu chưa có hãy click vào <em>Username > My security Credentials > Access keys > Tiến hành tạo key</em> (Nên download file csv về máy, vì key sau khi tạo ra sẽ không thể khôi phục lại nếu mất). Hãy nhớ bảo mật key này, không được public.</p>\n<p>Truy cập vào trang  <a href=\"https://serverlessrepo.aws.amazon.com/applications\">https://serverlessrepo.aws.amazon.com/applications</a> tìm libraries  <a href=\"https://serverlessrepo.aws.amazon.com/applications/arn:aws:serverlessrepo:us-east-1:145266761615:applications~image-magick-lambda-layer\">image-magick-lambda-layer</a>. Và click nút deploy để cài đặt thư viện <em>imagemagick</em> cho serverless.</p>\n<p><img src=\"https://i.imgur.com/9d8kx1C.png\"></p>\n<h3>2. Ở môi trường Local</h3>\n<p>Cài đặt  <a href=\"https://www.serverless.com/\">serverless framework</a>  bằng npm:  <code class=\"language-text\">npm i serverless</code></p>\n<p>Chạy lệnh:  <code class=\"language-text\">serverless create -t aws-ruby -p image-resizer&lt;:Tên Project&gt;</code>  để tạo project serverless viết bằng ngôn ngữ ruby</p>\n<p>Chạy lệnh:  <code class=\"language-text\">bundle init</code>  để tạo ra Gemfile. Ở đây ta dùng 2 gem <code class=\"language-text\">aws-sdk</code> và <code class=\"language-text\">minimagick</code></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token comment\"># Gemfile</span>\nsource 'https<span class=\"token punctuation\">:</span>//rubygems.org'\n\ngit_source(<span class=\"token punctuation\">:</span>github) <span class=\"token punctuation\">{</span><span class=\"token punctuation\">|</span>repo_name<span class=\"token punctuation\">|</span> \"https<span class=\"token punctuation\">:</span>//github.com/<span class=\"token comment\">#{repo_name}\" }</span>\n\ngem 'aws<span class=\"token punctuation\">-</span>sdk<span class=\"token punctuation\">-</span>s3'<span class=\"token punctuation\">,</span> <span class=\"token string\">'~> 1.30.0'</span>\ngem 'mini_magick'<span class=\"token punctuation\">,</span> <span class=\"token string\">'~> 4.9.0'</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Hãy check version ruby trước khi thực hiện lệnh bundle. Hãy xác định rằng serverless sử dụng \u001dversion ruby nào thì dưới local lúc bundle phải sử dụng version ruby giống như thế. Ở đây dùng rvm nên ta có lệnh  <code class=\"language-text\">rvm use 2.7.0</code>  để thiết lập phiên bản ruby.</p>\n<p>Chạy lệnh:  <code class=\"language-text\">bundle install --path vendor/bundle</code> để bundle vào thư mục dự án</p>\n<p>Có nhiều cách để cài đặt credential dưới local  <a href=\"https://www.serverless.com/framework/docs/providers/aws/guide/credentials/\" title=\"Hướng dẫn cài đặt credential\">(Tham khảo thêm)</a>. Ở đây ta dùng cách đơn giản nhất là export biến trực tiếp tại 1 session tab terminal (nếu tắt tab đi thì hết hiệu lực). Gõ lệnh  <code class=\"language-text\">export AWS_SECRET_ACCESS_KEY=secret_keys</code>  và  <code class=\"language-text\">export AWS_ACCESS_KEY_ID=access_key</code>.</p>\n<p>Sau các bước chuẩn bị ở trên thì trong project sẽ gồm các file: <em>Gemfile, serverless.yml, handler.rb và thư mục vendor/bundle/ruby/2.7.0</em></p>\n<h3>Code</h3>\n<p><em>handler.rb:</em>  File này sẽ là endpoint để lambda gọi tới. Nó sẽ có 2 params truyền vào là event và context</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\">load_path <span class=\"token operator\">=</span> <span class=\"token builtin\">Dir</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"/opt/bundle/ruby/2.7.0/gems/**/lib\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token variable\">$LOAD_PATH</span><span class=\"token punctuation\">.</span>unshift<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>load_path<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">require</span> <span class=\"token string\">'converter'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ImageHandler</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">process</span></span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">:</span><span class=\"token punctuation\">)</span>\n    event <span class=\"token operator\">=</span> event<span class=\"token punctuation\">[</span><span class=\"token string\">\"Records\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>first\n    bucket <span class=\"token operator\">=</span> event<span class=\"token punctuation\">[</span><span class=\"token string\">\"s3\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"bucket\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">]</span>\n    filename <span class=\"token operator\">=</span> event<span class=\"token punctuation\">[</span><span class=\"token string\">\"s3\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"object\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"key\"</span><span class=\"token punctuation\">]</span>\n\n    file <span class=\"token operator\">=</span> <span class=\"token constant\">Converter</span><span class=\"token punctuation\">.</span>from_s3<span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n    file<span class=\"token punctuation\">.</span>convert2webp\n    file<span class=\"token punctuation\">.</span>upload_file<span class=\"token punctuation\">(</span><span class=\"token constant\">ENV</span><span class=\"token punctuation\">[</span><span class=\"token string\">'BUCKET_DEST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tạo 1 file <em>converter.rb:</em> File này dùng để \u001dlấy image từ s3, tiến hành convert và upload ngược lại lên s3.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-ruby line-numbers\"><code class=\"language-ruby\"><span class=\"token keyword\">require</span> <span class=\"token string\">\"aws-sdk-s3\"</span>\n<span class=\"token keyword\">require</span> <span class=\"token string\">\"mini_magick\"</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Converter</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">from_s3</span></span><span class=\"token punctuation\">(</span>bucket_name<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n    puts <span class=\"token string\">'==###== Downloading image from S3'</span>\n    s3 <span class=\"token operator\">=</span> <span class=\"token constant\">Aws</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">S3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Resource</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    object <span class=\"token operator\">=</span> s3<span class=\"token punctuation\">.</span>bucket<span class=\"token punctuation\">(</span>bucket_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n\n    tmp_filename <span class=\"token operator\">=</span> <span class=\"token string\">\"/tmp/<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>filename<span class=\"token delimiter tag\">}</span></span>\"</span>\n    object<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>response_target<span class=\"token punctuation\">:</span> tmp_filename<span class=\"token punctuation\">)</span>\n\n    puts  <span class=\"token string\">\"==###== Successfully downloaded\"</span>\n\n    <span class=\"token constant\">Converter</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">rescue</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> e\n    puts <span class=\"token string\">\"==!!!== Error while downloading: <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>e<span class=\"token delimiter tag\">}</span></span>\"</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">initialize</span></span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n    extname <span class=\"token operator\">=</span> <span class=\"token builtin\">File</span><span class=\"token punctuation\">.</span>extname<span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n    <span class=\"token variable\">@filename</span> <span class=\"token operator\">=</span> filename\n    <span class=\"token variable\">@basename</span> <span class=\"token operator\">=</span> filename<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span>extname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first\n    <span class=\"token variable\">@tmp_file</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"/tmp/<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>filename<span class=\"token delimiter tag\">}</span></span>\"</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">convert2webp</span></span>\n    <span class=\"token variable\">@converted_filename</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token variable\">@basename</span><span class=\"token delimiter tag\">}</span></span>.webp\"</span>\n    <span class=\"token variable\">@converted_tmp_file</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"/tmp/<span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token variable\">@converted_filename</span><span class=\"token delimiter tag\">}</span></span>\"</span>\n\n    puts <span class=\"token string\">\"==###== Converting the image <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token variable\">@tmp_file</span><span class=\"token delimiter tag\">}</span></span> to <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span><span class=\"token variable\">@converted_tmp_file</span><span class=\"token delimiter tag\">}</span></span>\"</span>\n\n    <span class=\"token constant\">MiniMagick</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Tool</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Convert</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>convert<span class=\"token operator\">|</span>\n      convert <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span> <span class=\"token variable\">@tmp_file</span>\n      convert <span class=\"token operator\">&lt;</span><span class=\"token operator\">&lt;</span> <span class=\"token variable\">@converted_tmp_file</span>\n    <span class=\"token keyword\">end</span>\n    puts  <span class=\"token string\">\"==###== Successfully converted\"</span>\n  <span class=\"token keyword\">rescue</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> e\n    puts <span class=\"token string\">\"==!!!== Error while converting: <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>e<span class=\"token delimiter tag\">}</span></span>\"</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">upload_file</span></span><span class=\"token punctuation\">(</span>dest_bucket<span class=\"token punctuation\">)</span>\n    puts <span class=\"token string\">'==###== Uploading image to S3'</span>\n\n    s3 <span class=\"token operator\">=</span> <span class=\"token constant\">Aws</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">S3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">Resource</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    object <span class=\"token operator\">=</span> s3<span class=\"token punctuation\">.</span>bucket<span class=\"token punctuation\">(</span>dest_bucket<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">(</span><span class=\"token variable\">@converted_filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>upload_file<span class=\"token punctuation\">(</span><span class=\"token variable\">@converted_tmp_file</span><span class=\"token punctuation\">)</span>\n    puts  <span class=\"token string\">\"==###== Successfully uploaded\"</span>\n  <span class=\"token keyword\">rescue</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> e\n    puts <span class=\"token string\">\"==!!!== Error while uploading: <span class=\"token interpolation\"><span class=\"token delimiter tag\">#{</span>e<span class=\"token delimiter tag\">}</span></span>\"</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><em>serverless.yml:</em> File config cho framework</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">service</span><span class=\"token punctuation\">:</span> convert<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>webp\n\n<span class=\"token key atrule\">custom</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> your<span class=\"token punctuation\">-</span>images\n    <span class=\"token key atrule\">dest</span><span class=\"token punctuation\">:</span> convert<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>webp<span class=\"token punctuation\">-</span><span class=\"token number\">2705</span>\n<span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n  <span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> ruby2.7\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> us<span class=\"token punctuation\">-</span>east<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n  <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>440937316816<span class=\"token punctuation\">:</span>role/full<span class=\"token punctuation\">-</span>s3<span class=\"token punctuation\">-</span>logs\n\n<span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">handle_convert</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> handler.ImageHandler.process\n    <span class=\"token key atrule\">layers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">{</span><span class=\"token key atrule\">Ref</span><span class=\"token punctuation\">:</span> GemsLambdaLayer<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>lambda<span class=\"token punctuation\">:</span>us<span class=\"token punctuation\">-</span>east<span class=\"token punctuation\">-</span>1<span class=\"token punctuation\">:</span>440937316816<span class=\"token punctuation\">:</span>layer<span class=\"token punctuation\">:</span>image<span class=\"token punctuation\">-</span>magick<span class=\"token punctuation\">:</span><span class=\"token number\">1</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">BUCKET_DEST</span><span class=\"token punctuation\">:</span> convert<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>webp<span class=\"token punctuation\">-</span><span class=\"token number\">2705</span>\n    <span class=\"token key atrule\">memorySize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">512</span> <span class=\"token comment\"># in MB</span>\n    <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> <span class=\"token number\">900</span> <span class=\"token comment\"># in seconds</span>\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">s3</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">:</span>custom.bucket.source<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">event</span><span class=\"token punctuation\">:</span> s3<span class=\"token punctuation\">:</span>ObjectCreated<span class=\"token punctuation\">:</span>*\n<span class=\"token key atrule\">package</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">exclude</span><span class=\"token punctuation\">:</span>\n   <span class=\"token punctuation\">-</span> vendor/<span class=\"token important\">**</span>\n   <span class=\"token punctuation\">-</span> Gemfile\n   <span class=\"token punctuation\">-</span> Gemfile.lock\n\n<span class=\"token key atrule\">layers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">gems</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> vendor\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Project's vendor\n\n<span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">ConvertImage</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>S3<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Bucket\n      <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">BucketName</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">:</span>custom.bucket.dest<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Cuối cùng thì chạy lệnh  <code class=\"language-text\">serverless deploy</code>. Framework sẽ tiến hành tạo cloudformation trên AWS và Cloudformation sẽ tự động build serverless lambda theo những gì ta đã cấu hình trong file serverless.yml</p>\n<h2>Giải thích</h2>\n<p>Trong này chỉ có file serverless.yml là cần để giải thích từng đoạn code, còn file ruby thì chúng ta đọc củng có thể nắm được nội dung rồi.</p>\n<p><strong>Đoạn 1</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">custom</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">source</span><span class=\"token punctuation\">:</span> your<span class=\"token punctuation\">-</span>images\n    <span class=\"token key atrule\">dest</span><span class=\"token punctuation\">:</span> convert<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>webp<span class=\"token punctuation\">-</span><span class=\"token number\">2705</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Dùng để tạo biến tham chiếu cho bên dưới sử dụng. Ở đây ta có 2 tham chiếu là source và dest. Cách gọi thì syntax: <code class=\"language-text\">${self.custom.bucket.source}</code> và  <code class=\"language-text\">${self:custom.bucket.dest}</code></p>\n<p><strong>Đoạn 2</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">provider</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> aws\n  <span class=\"token key atrule\">runtime</span><span class=\"token punctuation\">:</span> ruby2.7\n  <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span> us<span class=\"token punctuation\">-</span>east<span class=\"token punctuation\">-</span><span class=\"token number\">1</span>\n  <span class=\"token key atrule\">role</span><span class=\"token punctuation\">:</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>iam<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>440937316816<span class=\"token punctuation\">:</span>role/full<span class=\"token punctuation\">-</span>s3<span class=\"token punctuation\">-</span>logs</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>name:</strong>  Sử dụng dịch vụ AWS</p>\n<p><strong>runtime:</strong>  Chạy phiên bản ruby2.7</p>\n<p><strong>region:</strong>  Region chạy lambda</p>\n<p><strong>role:</strong>  Do trước đó ta đã tạo role rồi, nên ở đây ta chỉ cần link đến là được. Còn không thì ta vẫn có thể tạo ở trong này. Có thể tham khảo thêm tại trang chủ serverless.</p>\n<p><strong>Đoạn 3</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">functions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">handle_convert</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> handler.ImageHandler.process\n    <span class=\"token key atrule\">layers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">{</span><span class=\"token key atrule\">Ref</span><span class=\"token punctuation\">:</span> GemsLambdaLayer<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> arn<span class=\"token punctuation\">:</span>aws<span class=\"token punctuation\">:</span>lambda<span class=\"token punctuation\">:</span>us<span class=\"token punctuation\">-</span>east<span class=\"token punctuation\">-</span>1<span class=\"token punctuation\">:</span>440937316816<span class=\"token punctuation\">:</span>layer<span class=\"token punctuation\">:</span>image<span class=\"token punctuation\">-</span>magick<span class=\"token punctuation\">:</span><span class=\"token number\">1</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">BUCKET_DEST</span><span class=\"token punctuation\">:</span> convert<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>webp<span class=\"token punctuation\">-</span><span class=\"token number\">2705</span>\n    <span class=\"token key atrule\">memorySize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">512</span> <span class=\"token comment\"># in MB</span>\n    <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> <span class=\"token number\">900</span> <span class=\"token comment\"># in seconds</span>\n    <span class=\"token key atrule\">events</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">s3</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">:</span>custom.bucket.source<span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">event</span><span class=\"token punctuation\">:</span> s3<span class=\"token punctuation\">:</span>ObjectCreated<span class=\"token punctuation\">:</span>*</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>functions:</strong>  Ở đây ta chỉ định nghĩa 1 function là <code class=\"language-text\">handle_convert</code>. Ngoài ra củng có thể define nhiều function hơn</p>\n<p><strong>handler:</strong>  Sẽ define endpoint để lambda trigger  <code class=\"language-text\">handler(tên file).ImageHandler(tên class).process(tên method)</code></p>\n<p><strong>layers:</strong>  Chúng ta sử dụng 2 lớp layer để phục vụ cho việc convert, lớp layer đầu tiên có tên là GemsLambdaLayer (layer này sẽ đề cập ở đoạn 5). Layer này chưa thư mục bundle. Function này muốn tham chiếu đến layer thì sử dụng syntax <code class=\"language-text\">{Ref: TenLayer&lt;Viết theo kiểu CamelCase&gt;}</code></p>\n<p>Layer thứ 2 là 1 đường link arn:aws. Do bước trên ta có sử dụng 1 layer có sẵn của AWS là image-magick-lambda nên ta sẽ pasted đường link layer đó vào đây.</p>\n<p><strong>environment:</strong>  Khai báo tên biến môi trường</p>\n<p><strong>memorySize:</strong>  Khai báo lượng Ram để lambda xử lý</p>\n<p><strong>timeout:</strong>  Thời gian giới hạn xử lý. Nếu ta để Ram quá ít hoặc timeout quá ít thì lambda sẽ không thực hiện được. Nhưng để nhiều quá thì lại tốn phí (bởi vì lambda sẽ dựa vào 2 tiêu chí này để tính tiền), cho nên hãy cân nhắc sao cho phù hợp.</p>\n<p><strong>events:</strong>  Ở đây ta muốn hướng đến là S3 với bucket là  your-images. Sự kiện khi có 1 object được tạo thì sẽ trigger đến lambda.</p>\n<p><strong>Đoạn 4</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">package</span><span class=\"token punctuation\">:</span>\n <span class=\"token key atrule\">exclude</span><span class=\"token punctuation\">:</span>\n   <span class=\"token punctuation\">-</span> vendor/<span class=\"token important\">**</span>\n   <span class=\"token punctuation\">-</span> Gemfile\n   <span class=\"token punctuation\">-</span> Gemfile.lock</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Mục đích là ta không muốn đẩy các file bên dưới lên serverless.</p>\n<p><strong>Đoạn 5</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">layers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">gems</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> vendor\n    <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Project's vendor</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ở dưới local khi ta bundle thì sẽ tạo ra thư mục vendor. Vậy ta sẽ dùng vendor này để làm 1 lớp Layer. Ở đây mình đặt tên layer là  <code class=\"language-text\">gems</code>  Cho nên khi reference thì ta phải viết cho đúng syntax mà framework yêu cầu, tức là viết dạng camelCase với suffix là  <code class=\"language-text\">LambdaLayer</code>. Cho nên dở đoạn 3 ta mới ghi là <code class=\"language-text\">{Ref: GemsLambdaLayer}</code></p>\n<p><strong>Đoạn 6</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">Resources</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">ConvertImage</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">Type</span><span class=\"token punctuation\">:</span> AWS<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>S3<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>Bucket\n      <span class=\"token key atrule\">Properties</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">BucketName</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>self<span class=\"token punctuation\">:</span>custom.bucket.dest<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Dùng để tạo 1 bucket đích. Để sau khi xử lý convert xong thì ta upload vào bucket này</p>\n<h2>Lời kết</h2>\n<p>Trong bài này mình đã hướng dẫn và giải thích chi tiết, hi vọng khi thực hiện sẽ không phát sinh lỗi. Nếu có thì chúng ta có thể xem log trong Cloudwatch để fix dần thôi. Chúc các bạn thành công.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Minh Tang Q. </div><div class=\"custom-block-body\"></div></div>","id":"484d6a95-13ea-5d51-8ff9-1f0a993668ab","frontmatter":{"title":"[Aws] Converting a image to WebP in AWS Lambda using Ruby","date":"29-06-2020","tags":["ruby","aws"]},"fields":{"slug":"/aws-su-dung-serverless-de-chuyen-doi-anh-sang-dinh-dang-webp-bang-ruby/","readingTime":{"text":"9 min read"}}}},{"node":{"excerpt":"Vấn đề đặt ra Bạn đang làm việc với API của Facebook, những plugin của Facebook. Nhưng khi deploy code lên staging để kiểm tra thì lại nhận được lỗi là API của Facebook chỉ hỗ trợ localhost và domain…","snippet":"<html><head></head><body><h3>V&#x1EA5;n &#x111;&#x1EC1; &#x111;&#x1EB7;t ra</h3> <ul> <li>B&#x1EA1;n &#x111;ang l&#xE0;m vi&#x1EC7;c v&#x1EDB;i API c&#x1EE7;a Facebook, nh&#x1EEF;ng plugin c&#x1EE7;a Facebook. Nh&#x1B0;ng khi deploy code l&#xEA;n staging &#x111;&#x1EC3; ki&#x1EC3;m tra th&#xEC; l&#x1EA1;i nh&#x1EAD;n &#x111;&#x1B0;&#x1EE3;c l&#x1ED7;i l&#xE0; API c&#x1EE7;a Facebook ch&#x1EC9; h&#x1ED7; tr&#x1EE3; localhost v&#xE0; domain &#x111;&#x1B0;&#x1EE3;c c&#xE0;i &#x111;&#x1EB7;t HTTPS (SSL certificate). </li> <li>C&#xF3; nhi&#x1EC1;u lo&#x1EA1;i ch&#x1EE9;ng&#x2026;</li></ul></body></html>","html":"<h2>Vấn đề đặt ra</h2>\n<ul>\n<li>Bạn đang làm việc với API của Facebook, những plugin của Facebook. Nhưng khi deploy code lên staging để kiểm tra thì lại nhận được lỗi là API của Facebook chỉ hỗ trợ localhost và domain được cài đặt HTTPS (SSL certificate). </li>\n<li>Có nhiều loại chứng chỉ SSL cung cấp các mức độ bảo mật khác nhau. Chúng ta có thể mua một chứng chỉ SSL tại Namecheap với các mức giá khác nhau. Nhưng trong bài viết này sẽ trình bày một cách để cài đặt HTTPS cho domain một cách miễn phí.</li>\n</ul>\n<h2>Chuẩn bị</h2>\n<ul>\n<li>1 server AWS EC2 Ubuntu 18.04 + Apache2</li>\n<li>\n<p>VPS EC2 đã được mở sẵn port 80 và port 443</p>\n<h2>Cách làm</h2>\n</li>\n</ul>\n<h4>1. Cài đặt Apache:</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> apache2 -y\n<span class=\"token function\">sudo</span> a2enmod rewrite\n<span class=\"token function\">sudo</span> a2enmod ssl\n<span class=\"token function\">sudo</span> a2enmod headers\n<span class=\"token function\">sudo</span> systemctl restart apache2</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>2. Cài đặt thư viện Certbot:</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> software-properties-common\n<span class=\"token function\">sudo</span> apt-apt-repository ppa:certbot/certbot\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> certbot python-certbot-apache</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>3. Cho phép HTTPS thông qua tường lửa:</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> ufw allow <span class=\"token string\">'Apache Full'</span>\n$ <span class=\"token function\">sudo</span> ufw delete allow <span class=\"token string\">'Apache'</span>\n$ <span class=\"token function\">sudo</span> ufw status</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>\n<p>Bạn sẽ nhận đươc kết quả như bên dưới:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Output\nStatus: active\nTo                         Action      From\n--                         ------      ----\nOpenSSH                    ALLOW       Anywhere                  \nApache Full                ALLOW       Anywhere                  \nOpenSSH (v6)               ALLOW       Anywhere (v6)             \nApache Full (v6)           ALLOW       Anywhere (v6)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>4. Cài đặt HTTPS cho domain:</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> certbot --apache</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n</li>\n<li>\n<p>Bước này sẽ yêu cầu bạn nhập email, email này sẽ được dùng để làm mới chứng chỉ SSL khi hết hạn.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Saving debug log to /var/log/letsencrypt/letsencrypt.log\nPlugins selected: Authenticator apache, Installer apache\nEnter email address <span class=\"token punctuation\">(</span>used <span class=\"token keyword\">for</span> urgent renewal and security notices<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>Enter <span class=\"token string\">'c'</span> to\ncancel<span class=\"token punctuation\">)</span>: you@your_domain</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Sau khi nhập Email, bạn cần xác nhận tuân thủ quy định của dịch vụ Let’s Encrypt. Chọn A để tiếp tục.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nPlease <span class=\"token builtin class-name\">read</span> the Terms of Service at\nhttps://letsencrypt.org/documents/LE-SA-v1.2-November-15-2017.pdf. You must\nagree <span class=\"token keyword\">in</span> order to register with the ACME server at\nhttps://acme-v02.api.letsencrypt.org/directory\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\n<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span>gree/<span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span>ancel: A</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Tiếp theo, bạn sẽ được hỏi liệu bạn có muốn chia sẻ email của mình với Electronic Frontier Foundation để nhận tin tức và thông tin khác hay không. Bỏ qua nếu bạn thấy không cần thiết.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nWould you be willing to share your email address with the Electronic Frontier\nFoundation, a founding partner of the Let<span class=\"token string\">'s Encrypt project and the non-profit\norganization that develops Certbot? We'</span>d like to send you email about our work\nencrypting the web, EFF news, campaigns, and ways to support digital freedom.\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\n<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span>es/<span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>o: N</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Bước tiếp theo bạn sẽ được chọn tên miền để cài đặt HTTPS. Nếu muốn cài đặt cho toàn bộ thì để trống và nhấn Enter để tiếp tục.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Which names would you like to activate HTTPS for?\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\n<span class=\"token number\">1</span>: your_domain\n<span class=\"token number\">2</span>: www.your_domain\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nSelect the appropriate numbers separated by commas and/or spaces, or leave input\nblank to <span class=\"token keyword\">select</span> all options shown <span class=\"token punctuation\">(</span>Enter <span class=\"token string\">'c'</span> to cancel<span class=\"token punctuation\">)</span>:</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Tiếp theo là quá trình kiểm tra điều kiện tên miền của bạn có đáp ứng điều kiện để cài đặt HTTPS không? Nếu hợp lệ sẽ tiến hành cài đặt HTTPS cho tên miền bạn vừa chọn.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Obtaining a new certificate\nPerforming the following challenges:\nhttp-01 challenge <span class=\"token keyword\">for</span> your_domain\nhttp-01 challenge <span class=\"token keyword\">for</span> www.your_domain\nEnabled Apache rewrite module\nWaiting <span class=\"token keyword\">for</span> verification<span class=\"token punctuation\">..</span>.\nCleaning up challenges\nCreated an SSL vhost at /etc/apache2/sites-available/your_domain-le-ssl.conf\nEnabled Apache socache_shmcb module\nEnabled Apache ssl module\nDeploying Certificate to VirtualHost /etc/apache2/sites-available/your_domain-le-ssl.conf\nEnabling available site: /etc/apache2/sites-available/your_domain-le-ssl.conf\nDeploying Certificate to VirtualHost /etc/apache2/sites-available/your_domain-le-ssl.conf</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Sau khi cài đặt kết thúc. Bạn sẽ được hỏi là có muốn chuyển hướng trang web sang HTTPS không? Cụ thể là nếu người dùng vào tên miền cửa bạn với kênh HTTP sẽ được tự động chuyển hướng sang HTTPS.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">Please choose whether or not to redirect HTTP traffic to HTTPS, removing HTTP access.\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\n<span class=\"token number\">1</span>: No redirect - Make no further changes to the webserver configuration.\n<span class=\"token number\">2</span>: Redirect - Make all requests redirect to secure HTTPS access. Choose this <span class=\"token keyword\">for</span>\nnew sites, or <span class=\"token keyword\">if</span> you<span class=\"token string\">'re confident your site works on HTTPS. You can undo this\nchange by editing your web server'</span>s configuration.\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nSelect the appropriate number <span class=\"token punctuation\">[</span><span class=\"token number\">1</span>-2<span class=\"token punctuation\">]</span> <span class=\"token keyword\">then</span> <span class=\"token punctuation\">[</span>enter<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>press <span class=\"token string\">'c'</span> to cancel<span class=\"token punctuation\">)</span>: <span class=\"token number\">2</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Sau khi xác nhận. Quá trình cài đặt HTTPS cho tên miền của bạn đã hoàn tất. Bạn sẽ nhận được thông báo như bên dưới.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nCongratulations<span class=\"token operator\">!</span> You have successfully enabled https://your_domain and https://www.your_domain\nYou should <span class=\"token builtin class-name\">test</span> your configuration at:\nhttps://www.ssllabs.com/ssltest/analyze.html?d<span class=\"token operator\">=</span>your_domain\nhttps://www.ssllabs.com/ssltest/analyze.html?d<span class=\"token operator\">=</span>www.your_domain\n<span class=\"token comment\">#- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span>\nIMPORTANT NOTES:\n-Congratulations<span class=\"token operator\">!</span> Your certificate and chain have been saved at:\n/etc/letsencrypt/live/your_domain/fullchain.pem\nYour key <span class=\"token function\">file</span> has been saved at:\n/etc/letsencrypt/live/your_domain/privkey.pem\nYour cert will expire on <span class=\"token number\">2020</span>-07-27. To obtain a new or tweaked\nversion of this certificate <span class=\"token keyword\">in</span> the future, simply run certbot again\nwith the <span class=\"token string\">\"certonly\"</span> option. To non-interactively renew *all* of\nyour certificates, run <span class=\"token string\">\"certbot renew\"</span>\n-Your account credentials have been saved <span class=\"token keyword\">in</span> your Certbot\nconfiguration directory at /etc/letsencrypt. You should <span class=\"token function\">make</span> a\nsecure backup of this folder now. This configuration directory will\nalso contain certificates and private keys obtained by Certbot so\nmaking regular backups of this folder is ideal.\n-If you like Certbot, please consider supporting our work by:\nDonating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate\nDonating to EFF:                    https://eff.org/donate-le</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ul>\n<h2>Tổng kết</h2>\n<p>Vậy là chúng ta cài đặt được HTTPS cho tên miền của mình rồi. Tất nhiên bạn cần phải cài đặt Vitua Host cho domain của mình sau khi cài đặt Apache để Certbot có thể tìm được. Chứng chỉ SSL này có thời hạn 90 ngày. Khi hết hạn chỉ cần vào chạy lại từ đầu bước 4 là có thể đươc. Ngoài ra chúng ta có thể cài đặt cho máy chủ tự làm mới chứng chỉ SSL khi hết hạn. Tôi sẽ hướng dẫn cụ thể ở bài viết tiếp theo. Mong bài viết này sẽ giúp được mọi người.</p>\n<h2>Tham khảo</h2>\n<ul>\n<li><a href=\"https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-18-04\">https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-18-04</a></li>\n<li><a href=\"https://vicloud.vn/community/cach-cai-dat-bo-linux-apache-mysql-php-lamp-tren-ubuntu-1804-540.html\">https://vicloud.vn/community/cach-cai-dat-bo-linux-apache-mysql-php-lamp-tren-ubuntu-1804-540.html</a></li>\n</ul>\n<p>[[author | Trần Văn Tuấn Anh ]]</p>","id":"8579fdd4-40bd-587f-aebf-a0d0c4a931cf","frontmatter":{"title":"[Aws] How to install HTTPS using Cerbot for Apache2 on AWS EC2","date":"10-01-2020","tags":["aws"]},"fields":{"slug":"/aws-cach-cai-dat-https-bang-cerbot-cho-apache2-tren-aws-ec2/","readingTime":{"text":"8 min read"}}}}]}},"pageContext":{"tag":"aws"}},"staticQueryHashes":["3963689063","63159454","81262063"]}