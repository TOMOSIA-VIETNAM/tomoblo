{"componentChunkName":"component---src-templates-post-list-js","path":"/4","result":{"data":{"site":{"siteMetadata":{"title":"TOMOSIA VIETNAM","author":"「共に」「幸せ」「灯す」","labels":[{"tag":"javascript","tech":"JavaScript","name":"M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z","size":20,"color":"yellow"},{"tag":"react","tech":"React","name":"M12 9.861A2.139 2.139 0 1 0 12 14.139 2.139 2.139 0 1 0 12 9.861zM6.008 16.255l-.472-.12C2.018 15.246 0 13.737 0 11.996s2.018-3.25 5.536-4.139l.472-.119.133.468a23.53 23.53 0 0 0 1.363 3.578l.101.213-.101.213a23.307 23.307 0 0 0-1.363 3.578l-.133.467zM5.317 8.95c-2.674.751-4.315 1.9-4.315 3.046 0 1.145 1.641 2.294 4.315 3.046a24.95 24.95 0 0 1 1.182-3.046A24.752 24.752 0 0 1 5.317 8.95zM17.992 16.255l-.133-.469a23.357 23.357 0 0 0-1.364-3.577l-.101-.213.101-.213a23.42 23.42 0 0 0 1.364-3.578l.133-.468.473.119c3.517.889 5.535 2.398 5.535 4.14s-2.018 3.25-5.535 4.139l-.473.12zm-.491-4.259c.48 1.039.877 2.06 1.182 3.046 2.675-.752 4.315-1.901 4.315-3.046 0-1.146-1.641-2.294-4.315-3.046a24.788 24.788 0 0 1-1.182 3.046zM5.31 8.945l-.133-.467C4.188 4.992 4.488 2.494 6 1.622c1.483-.856 3.864.155 6.359 2.716l.34.349-.34.349a23.552 23.552 0 0 0-2.422 2.967l-.135.193-.235.02a23.657 23.657 0 0 0-3.785.61l-.472.119zm1.896-6.63c-.268 0-.505.058-.705.173-.994.573-1.17 2.565-.485 5.253a25.122 25.122 0 0 1 3.233-.501 24.847 24.847 0 0 1 2.052-2.544c-1.56-1.519-3.037-2.381-4.095-2.381zM16.795 22.677c-.001 0-.001 0 0 0-1.425 0-3.255-1.073-5.154-3.023l-.34-.349.34-.349a23.53 23.53 0 0 0 2.421-2.968l.135-.193.234-.02a23.63 23.63 0 0 0 3.787-.609l.472-.119.134.468c.987 3.484.688 5.983-.824 6.854a2.38 2.38 0 0 1-1.205.308zm-4.096-3.381c1.56 1.519 3.037 2.381 4.095 2.381h.001c.267 0 .505-.058.704-.173.994-.573 1.171-2.566.485-5.254a25.02 25.02 0 0 1-3.234.501 24.674 24.674 0 0 1-2.051 2.545zM18.69 8.945l-.472-.119a23.479 23.479 0 0 0-3.787-.61l-.234-.02-.135-.193a23.414 23.414 0 0 0-2.421-2.967l-.34-.349.34-.349C14.135 1.778 16.515.767 18 1.622c1.512.872 1.812 3.37.824 6.855l-.134.468zM14.75 7.24c1.142.104 2.227.273 3.234.501.686-2.688.509-4.68-.485-5.253-.988-.571-2.845.304-4.8 2.208A24.849 24.849 0 0 1 14.75 7.24zM7.206 22.677A2.38 2.38 0 0 1 6 22.369c-1.512-.871-1.812-3.369-.823-6.854l.132-.468.472.119c1.155.291 2.429.496 3.785.609l.235.02.134.193a23.596 23.596 0 0 0 2.422 2.968l.34.349-.34.349c-1.898 1.95-3.728 3.023-5.151 3.023zm-1.19-6.427c-.686 2.688-.509 4.681.485 5.254.987.563 2.843-.305 4.8-2.208a24.998 24.998 0 0 1-2.052-2.545 24.976 24.976 0 0 1-3.233-.501zM12 16.878c-.823 0-1.669-.036-2.516-.106l-.235-.02-.135-.193a30.388 30.388 0 0 1-1.35-2.122 30.354 30.354 0 0 1-1.166-2.228l-.1-.213.1-.213a30.3 30.3 0 0 1 1.166-2.228c.414-.716.869-1.43 1.35-2.122l.135-.193.235-.02a29.785 29.785 0 0 1 5.033 0l.234.02.134.193a30.006 30.006 0 0 1 2.517 4.35l.101.213-.101.213a29.6 29.6 0 0 1-2.517 4.35l-.134.193-.234.02c-.847.07-1.694.106-2.517.106zm-2.197-1.084c1.48.111 2.914.111 4.395 0a29.006 29.006 0 0 0 2.196-3.798 28.585 28.585 0 0 0-2.197-3.798 29.031 29.031 0 0 0-4.394 0 28.477 28.477 0 0 0-2.197 3.798 29.114 29.114 0 0 0 2.197 3.798z","size":20,"color":"deepskyblue"},{"tag":"nodejs","tech":"Node.js","name":"M11.177 25.3a1.94 1.94 0 0 1-.969-.259l-3.086-1.826c-.46-.257-.235-.349-.083-.402.614-.213.739-.262 1.394-.635.069-.038.159-.024.231.018l2.37 1.407a.304.304 0 0 0 .287 0l9.241-5.333a.292.292 0 0 0 .141-.25V7.355a.3.3 0 0 0-.143-.255l-9.237-5.329a.29.29 0 0 0-.285 0L1.803 7.102a.296.296 0 0 0-.146.253v10.666c0 .102.056.198.145.247l2.532 1.462c1.374.687 2.215-.122 2.215-.935V8.265c0-.149.12-.266.269-.266H7.99c.146 0 .267.117.267.266v10.53c0 1.833-.998 2.885-2.736 2.885-.534 0-.955 0-2.129-.579L.969 19.706A1.953 1.953 0 0 1 0 18.02V7.355c0-.693.371-1.339.969-1.684l9.242-5.34a2.023 2.023 0 0 1 1.942 0l9.241 5.34c.599.346.971.992.971 1.684V18.02c0 .693-.372 1.337-.971 1.686l-9.241 5.335a1.942 1.942 0 0 1-.973.259zm2.855-7.348c-4.045 0-4.892-1.857-4.892-3.414 0-.148.118-.266.266-.266h1.195c.133 0 .245.096.265.226.18 1.216.717 1.831 3.164 1.831 1.946 0 2.775-.441 2.775-1.473 0-.596-.234-1.037-3.26-1.334-2.528-.25-4.093-.809-4.093-2.831 0-1.865 1.572-2.977 4.207-2.977 2.961 0 4.425 1.027 4.611 3.233a.27.27 0 0 1-.267.291h-1.2a.266.266 0 0 1-.259-.209c-.288-1.28-.988-1.689-2.886-1.689-2.126 0-2.373.74-2.373 1.295 0 .673.292.869 3.161 1.248 2.84.375 4.19.907 4.19 2.902 0 2.014-1.678 3.167-4.606 3.167z","size":20,"color":"lightgreen"},{"tag":"ruby","tech":"Ruby","name":"M20.156.083c3.033.525 3.893 2.598 3.829 4.77L24 4.822 22.635 22.71 4.89 23.926h.016C3.433 23.864.15 23.729 0 19.139l1.645-3 2.819 6.586.503 1.172 2.805-9.144-.03.007.016-.03 9.255 2.956-1.396-5.431-.99-3.9 8.82-.569-.615-.51L16.5 2.114 20.159.073l-.003.01zM0 19.089v.026-.029.003zM5.13 5.073c3.561-3.533 8.157-5.621 9.922-3.84 1.762 1.777-.105 6.105-3.673 9.636-3.563 3.532-8.103 5.734-9.864 3.957-1.766-1.777.045-6.217 3.612-9.75l.003-.003z","size":20,"color":"crimson"},{"tag":"rails","tech":"Ruby on Rails","name":"M20.8848485 15.8107143v1.1635714h1.9818182c.4060606 0 1.1030303-.315 1.1272727-1.19571427v-.45c0-.75214286-.5818182-1.1957143-1.1272727-1.1957143h-.9878788v-.54h1.9575757v-1.17h-1.8787878c-.4848485 0-1.1333334.42428573-1.1333334 1.215v.405c0 .7907143.6424243 1.1957143 1.1333334 1.1957143 1.3636363.00642857-.3272728 0 .9333333 0v.56571428l-2.0060606.0064286zm-10.6181818-.28285716s1.060606-.09642857 1.060606-1.5492857c0-1.45285715-1.2848485-1.58785715-1.2848485-1.58785715H7.72727273v4.5835714H8.8909091v-1.1057143l1.0060606 1.1057142h1.7212121l-1.3515151-1.4464286zm-.44848488-.93857143H8.8909091v-1.0478571h.93333332s.26060608.1028572.26060608.5207143c0 .4178572-.26666668.5271429-.26666668.5271429zM14.2 12.4228572h-1.1818182c-.8424242 0-1.1272727.81-1.1272727 1.1957143v3.35571427h1.1818182v-.8035714h1.1090909v.8035714h1.1454545V13.6185715c0-.97714286-.8363636-1.1957143-1.1272727-1.1957143zm-.0181818 2.44928572h-1.1151515V13.76s0-.2507143.3696969-.2507143h.4060606c.3272728 0 .3333334.2507143.3333334.2507143v1.11214286h.0060606zm1.6848485-2.44928573h1.230303v4.5514285h-1.230303v-4.5514285zm2.9575757 3.375v-3.375H17.6v4.5514285h2.8787879v-1.1764285h-1.6545455zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76969696.16714284-3.93939393 1.87071427-5.2121212 4.12071427C.6 15.0714285.4242424 16.9742857.4242424 16.9742857zM10.4 9.0607143L10.4242424 8.63c-.0545454-.03214286-.2060606-.1092857-.58787876-.225l-.02424243.4242857c.2.0707143.3939394.14785716.5878788.2314286zM9.82424242 10.42357143l-.02424242.405c.2.00642857.4.03214286.6.07714286l.0242424-.3985715c-.2060606-.045-.4060606-.0707143-.59999998-.0835715zm-2.24242424-2.0057143h.06060606l-.12121212-.39214284c-.1878788 0-.38181818.0128571-.58181818.0385714l.1151515.3792857c.1757576-.0192857.35151517-.0257143.52727274-.0257143zm.2909091 2.3657143l.13939393.44357143c.1757576-.09.3515152-.16714286.5272728-.225l-.1333333-.42428572c-.2060606.06428572-.3818182.135-.5333333.2057143zM5.1212121 9.09285713l-.27272727-.44357142c-.15151515.0835715-.3090909.1735715-.47272727.2764286l.27878787.45c.15757576-.1028571.3090909-.1992857.46666667-.2828571zm1.24242424 2.89285716l.2909091.4628571c.1030303-.1607143.22424242-.3085715.35757575-.4564286L6.7393939 11.555c-.13939394.135-.26666667.28285714-.37575758.4307143zm-.87878788 2.07l.4909091.4114285C6 14.2164285 6.04242424 13.9657143 6.1030303 13.715l-.43636363-.36642857c-.07878788.23785714-.13333334.47571428-.1818182.70714286zM2.830303 11.0021428L2.4 10.60357142c-.15757576.1607143-.3090909.32142858-.44848485.48214287L2.41818182 11.51c.12727273-.17357143.26666666-.34714286.4121212-.50785714zM1 13.8757143l-.6969697-.27c-.1151515.27642856-.24242424.59785713-.3030303.77142856l.6969697.27C.77575758 14.42857143.9030303 14.11357143 1 13.8757143zm4.3939394 1.81285713c.0121212.34071428.04242424.61714286.07272727.81L6.1939394 16.775c-.05454546-.2507143-.10909092-.53357143-.14545455-.8357143l-.65454546-.25071427z","size":20,"color":"#CC0000"},{"tag":"php","tech":"php","name":"M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z","size":20,"color":"#777BB4"},{"tag":"laravel","tech":"Laravel","name":"M23.644 5.43c.009.032.014.065.014.099v5.15c0 .135-.073.26-.189.326l-4.323 2.49v4.934c0 .135-.072.258-.188.326L9.931 23.95c-.021.012-.043.02-.066.027-.008.002-.016.008-.024.01-.063.018-.13.018-.192 0-.011-.002-.02-.008-.029-.012-.021-.008-.043-.014-.063-.025L.534 18.755c-.117-.068-.189-.191-.189-.326V2.974c0-.033.005-.066.014-.098.003-.012.01-.021.014-.032.006-.02.014-.04.023-.058.004-.013.015-.022.023-.033.012-.016.021-.031.033-.045.012-.01.025-.018.037-.027.014-.012.027-.024.041-.034h.001L5.044.05c.115-.067.259-.067.375 0l4.512 2.597h.002c.015.01.027.021.041.033.012.009.025.018.037.027.013.014.021.029.033.045.008.011.02.021.025.033.011.019.017.038.024.058.003.011.011.021.013.032.01.031.014.064.014.098v9.652l3.76-2.164V5.527c0-.033.005-.066.014-.098.003-.011.009-.021.013-.032.007-.02.014-.039.024-.059.007-.012.018-.021.025-.033.012-.015.021-.03.033-.043.012-.012.025-.02.037-.028.014-.011.026-.023.041-.032h.001l4.513-2.598c.116-.067.259-.067.375 0l4.513 2.598c.016.01.027.021.042.031.012.01.025.018.036.028.013.014.022.029.034.044.008.012.019.021.024.033.011.02.018.039.024.059.006.011.012.022.015.033zm-.74 5.032V6.179l-1.578.908-2.182 1.256v4.283l3.76-2.164zm-4.511 7.75v-4.287l-2.146 1.225-6.127 3.498v4.326l8.273-4.762zM1.095 3.624v14.588l8.273 4.762v-4.326l-4.322-2.445-.002-.003h-.002c-.014-.01-.025-.021-.04-.031-.011-.01-.024-.018-.035-.027l-.001-.002c-.013-.012-.021-.025-.031-.039-.01-.012-.021-.023-.028-.037h-.002c-.008-.014-.013-.031-.02-.047-.006-.016-.014-.027-.018-.043-.004-.018-.006-.037-.008-.057-.002-.014-.006-.027-.006-.041V5.789l-2.18-1.257-1.578-.908zM5.231.81l-3.76 2.164 3.76 2.164 3.758-2.164L5.231.81zm1.956 13.505l2.182-1.256V3.624l-1.58.909-2.182 1.256v9.435l1.58-.909zM18.769 3.364l-3.76 2.164 3.76 2.163 3.759-2.164-3.759-2.163zm-.376 4.979l-2.182-1.256-1.579-.908v4.283l2.182 1.256 1.579.908V8.343zm-8.65 9.654l5.514-3.148 2.756-1.572-3.757-2.163-4.324 2.489-3.941 2.27 3.752 2.124z","size":20,"color":"#FF2D20"},{"tag":"cakephp","tech":"CakePHP","name":"M0 13.875v3.745c0 2.067 5.37 3.743 12 3.743V17.62c-6.63 0-12-1.68-12-3.743v-.002zm21.384 2.333L12 13.875v3.745l9.384 2.333C23.02 19.313 24 18.503 24 17.62v-3.745c0 .882-.98 1.692-2.616 2.333zM12 10.133v3.742c-6.627 0-12-1.677-12-3.744V6.38c0-2.064 5.37-3.743 12-3.743 6.625 0 12 1.68 12 3.744v3.75c0 .883-.98 1.69-2.616 2.334L12 10.13v.003z","size":20,"color":"#D33C43"},{"tag":"swift","tech":"Swift","name":"M21.984 16.348c.056-.112.056-.224.112-.336 1.346-5.272-1.851-11.44-7.347-14.693 2.412 3.253 3.365 7.122 2.524 10.599-.056.28-.168.617-.28.897a5.173 5.173 0 0 1-.45-.28S11.104 9.17 5.273 3.282c-.169-.168 3.14 4.71 6.841 8.58-1.738-1.01-6.673-4.542-9.758-7.403.337.617.842 1.234 1.346 1.851 2.58 3.309 5.945 7.346 9.983 10.43-2.86 1.74-6.842 1.851-10.88 0-1.01-.448-1.85-1.009-2.804-1.682 1.682 2.636 4.318 5.048 7.459 6.337 3.757 1.627 7.57 1.515 10.318 0h.057c.112-.056.224-.112.336-.224 1.346-.673 3.982-1.402 5.44 1.402.392.785 1.121-2.86-1.626-6.225z","size":20,"color":"#FA7343"},{"tag":"ios","tech":"iOS","name":"M7.078 23.55c-.473-.316-.893-.703-1.244-1.15-.383-.463-.738-.95-1.064-1.454-.766-1.12-1.365-2.345-1.78-3.636-.5-1.502-.743-2.94-.743-4.347 0-1.57.34-2.94 1.002-4.09.49-.9 1.22-1.653 2.1-2.182.85-.53 1.84-.82 2.84-.84.35 0 .73.05 1.13.15.29.08.64.21 1.07.37.55.21.85.34.95.37.32.12.59.17.8.17.16 0 .39-.05.645-.13.145-.05.42-.14.81-.31.386-.14.692-.26.935-.35.37-.11.728-.21 1.05-.26.39-.06.777-.08 1.148-.05.71.05 1.36.2 1.94.42 1.02.41 1.843 1.05 2.457 1.96-.26.16-.5.346-.725.55-.487.43-.9.94-1.23 1.505-.43.77-.65 1.64-.644 2.52.015 1.083.29 2.035.84 2.86.387.6.904 1.114 1.534 1.536.31.21.582.355.84.45-.12.375-.252.74-.405 1.1-.347.807-.76 1.58-1.25 2.31-.432.63-.772 1.1-1.03 1.41-.402.48-.79.84-1.18 1.097-.43.285-.935.436-1.452.436-.35.015-.7-.03-1.034-.127-.29-.095-.576-.202-.856-.323-.293-.134-.596-.248-.905-.34-.38-.1-.77-.148-1.164-.147-.4 0-.79.05-1.16.145-.31.088-.61.196-.907.325-.42.175-.695.29-.855.34-.324.096-.656.154-.99.175-.52 0-1.004-.15-1.486-.45zm6.854-18.46c-.68.34-1.326.484-1.973.436-.1-.646 0-1.31.27-2.037.24-.62.56-1.18 1-1.68.46-.52 1.01-.95 1.63-1.26.66-.34 1.29-.52 1.89-.55.08.68 0 1.35-.25 2.07-.228.64-.568 1.23-1 1.76-.435.52-.975.95-1.586 1.26z","size":20,"color":"#403f3f"},{"tag":"kotlin","tech":"Kotlin","name":"M1.3 24l11.3-11.5L24 24zM0 0h12L0 12.5zM13.4 0L0 14v10l12-12L24 0z","size":20,"color":"#0095D5"},{"tag":"android","tech":"Android","name":"M24 19H0a13.6 13.6 0 0 1 2.21-6.07A11.2 11.2 0 0 1 5.87 9.4l.41-.23-2.02-3.41a.51.51 0 0 1 .17-.7.5.5 0 0 1 .69.18l2.08 3.5a12.62 12.62 0 0 1 4.84-.9 12.2 12.2 0 0 1 4.75.9l2.07-3.5a.5.5 0 0 1 .7-.17.51.51 0 0 1 .16.7L17.7 9.19l.5.28a11.38 11.38 0 0 1 3.63 3.62A14.48 14.48 0 0 1 24 19zm-7.5-4.48a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1zm-11 0a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1z","size":20,"color":"#3DDC84"},{"tag":"git","tech":"Git","name":"M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.215 1.379-.07 1.889.441.516.515.658 1.258.438 1.9l2.658 2.66c.645-.223 1.387-.078 1.9.435.721.72.721 1.884 0 2.604-.719.719-1.881.719-2.6 0-.539-.541-.674-1.337-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348.713.721.713 1.883 0 2.6-.719.721-1.889.721-2.609 0-.719-.719-.719-1.879 0-2.598.182-.18.387-.316.605-.406V8.835c-.217-.091-.424-.222-.6-.401-.545-.545-.676-1.342-.396-2.009L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477c.604.604 1.582.604 2.186 0l10.43-10.43c.605-.603.605-1.582 0-2.187","size":20,"color":"#403f3f"},{"tag":"aws","tech":"AWS","name":"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zM21.698 16.207c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zM22.792 14.961c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z","size":20,"color":"#232F3E"},{"tag":"instagram","tech":"Instagram","name":"M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z","size":20,"color":"#E4405F"},{"tag":"facebook","tech":"Facebook","name":"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z","size":20,"color":"#1877F2"},{"tag":"gitlab ci","tech":"Gitlab CI","name":"M4.844.904a1.007 1.007 0 00-.955.692l-2.53 7.783c0 .007-.005.012-.007.02L.07 13.335a1.437 1.437 0 00.522 1.607l11.072 8.045a.566.566 0 00.67-.004l11.074-8.04a1.436 1.436 0 00.522-1.61l-1.26-3.867a.547.547 0 00-.031-.104l-2.526-7.775a1.004 1.004 0 00-.957-.684.987.987 0 00-.949.69l-2.406 7.408H8.203l-2.41-7.408a.987.987 0 00-.943-.69h-.006zm-.006 1.42l2.174 6.678H2.674l2.164-6.678zm14.328 0l2.168 6.678h-4.342l2.174-6.678zm-10.594 7.81h6.862l-2.15 6.618L12 20.693 8.572 10.135zm-5.515.005h4.322l3.086 9.5-7.408-9.5zm13.568 0h4.326l-6.703 8.588-.709.914 2.959-9.108.127-.394zM2.1 10.762l6.978 8.947-7.818-5.682a.305.305 0 01-.112-.341l.952-2.924zm19.8 0l.952 2.922a.305.305 0 01-.11.341v.002l-7.82 5.68.025-.035 6.953-8.91Z","size":20,"color":"#FCA121"}]}},"allMarkdownRemark":{"totalCount":93,"edges":[{"node":{"excerpt":"Khi là một thực tập sinh Ruby on Rails, mình được chỉ định làm một trang web được viết bằng Ruby on Rails. Trước ngày đem sản phẩm đi demo, mình và Trainer có review lại sản phẩm của mình lúc đó mình…","snippet":"<div class=\"custom-block-body\"><p>Khi l&#xE0; m&#x1ED9;t th&#x1EF1;c t&#x1EAD;p sinh Ruby on Rails, m&#xEC;nh &#x111;&#x1B0;&#x1EE3;c ch&#x1EC9; &#x111;&#x1ECB;nh l&#xE0;m m&#x1ED9;t trang web &#x111;&#x1B0;&#x1EE3;c vi&#x1EBF;t b&#x1EB1;ng Ruby on Rails. Tr&#x1B0;&#x1EDB;c ng&#xE0;y &#x111;em s&#x1EA3;n ph&#x1EA9;m &#x111;i demo, m&#xEC;nh v&#xE0; Trainer c&#xF3; review l&#x1EA1;i s&#x1EA3;n ph&#x1EA9;m c&#x1EE7;a m&#xEC;nh l&#xFA;c &#x111;&#xF3; m&#xEC;nh run web d&#x1B0;&#x1EDB;i local. Trainer mu&#x1ED1;n m&#xEC;nh tri&#x1EC3;n khai s&#x1EA3;n ph&#x1EA9;m c&#x1EE7;a m&#xEC;nh l&#xEA;n m&#xF4;i tr&#x1B0;&#x1EDD;ng server. Trainer c&#x1EA5;p cho m&#xEC;nh m&#x1ED9;t con VPS (Virtual Private Server) v&#xE0; h&#x1B0;&#x1EDB;ng d&#x1EAB;n m&#xEC;nh deploy s&#x1EA3;n ph&#x1EA9;m c&#x1EE7;a m&#xEC;nh l&#xEA;n m&#xF4;i tr&#x1B0;&#x1EDD;ng server b&#x1EB1;ng Capistrano gem. Sau khi t&#xEC;m hi&#x1EC3;u v&#xE0; Setup m&#xEC;nh &#x111;&#xE3; deploy &#x111;&#x1B0;&#x1EE3;c s&#x1EA3;n ph&#x1EA9;m c&#x1EE7;a m&#xEC;nh.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Khi là một thực tập sinh Ruby on Rails, mình được chỉ định làm một trang web được viết bằng Ruby on Rails. Trước ngày đem sản phẩm đi demo, mình và Trainer có review lại sản phẩm của mình lúc đó mình run web dưới local. Trainer muốn mình triển khai sản phẩm của mình lên môi trường server. Trainer cấp cho mình một con VPS (Virtual Private Server) và hướng dẫn mình deploy sản phẩm của mình lên môi trường server bằng Capistrano gem. Sau khi tìm hiểu và Setup mình đã deploy được sản phẩm của mình.</p></div></div>\n<h2>Deploy là gì? Tại sao lại cần Capistrano</h2>\n<p>Deploy là một công việc được đưa code của sản phẩm mình làm ra đưa lên môi trường server, chúng ta config như thế nào để cho sản phẩm của mình chạy được trên đó. Đôi lúc có những công đoạn như đưa code từ bộ quản lý source (github, gitlab, ...), config database, cài đặt môi trường, chạy rake task,... các công đoạn này được lặp đi lặp lại rất nhiều lần sẽ rất là vất vả nếu thực hiện nó bằng tay, mà giả xử những công đoạn này bị lỗi ở một chỗ nào đó thì tốn rất nhiều time để fix lỗi đó, khi đó người dùng sẽ rất thất vọng khi sản phẩm này đang bị lỗi. Thì Capistrano gem nó được sinh ra để tự động hóa các công đoạn trên. Capistrano còn cho phép chúng ta deploy code lên nhiều server cùng một lúc, rollback nếu deploy lỗi, lưu trữ các bản deploy gần đây nhất, chạy custom task trong quá trình deploy. Việc deploy với gem Capistrano gồm 3 bước:</p>\n<ul>\n<li>Tạo môi trường trên server</li>\n<li>Config cho Capistrano</li>\n<li>Config Nginx (webserver)</li>\n<li>Config các lại các bước deploy</li>\n</ul>\n<p>Một điều mình thích dùng Capistrano để deploy là bởi vì Capistrano nó rõ ràng trong từng phân đoạn, cấu trúc config của nó rất dễ hiểu để chúng ta config, không bị delay app trong quá trình deploy app</p>\n<h2>Công thức deploy app Ruby on Rails với Capistrano, Puma và Nginx</h2>\n<p>Mình có đọc một bài trên Viblo, thì anh này nghiên cứu khá là sâu nên đã đúc kết ra được một cái công thức deploy cơ bản:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Deploy = Config Server(giống như 1 máy local) + Config Capistrano + Config Nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Công thức trên để phục vụ cho các bước lằng nhằng sau đây. Mình sẽ phân tích rõ ràng từng công đoạn.</p>\n<p>OK. Bây giờ triển luôn nào.</p>\n<h2>Các bước deploy rails app lên server bằng Capistrano gem</h2>\n<h3>Step 1: Tìm hiểu một số kiến thức</h3>\n<ul>\n<li>Puma</li>\n<li>Nginx</li>\n</ul>\n<p>Puma là web server nhỏ gọn đi liền trong Rails giúp developer có thể bắt đầu code một cách nhanh nhất. Tuy nhiên mang nó làm web server thực sự để chạy trên môi trường production thì chưa ổn.</p>\n<p>Puma hoạt động như application server cho ứng dụng Rails, còn Nginx sẽ hoạt động với vai trò là reverse proxy - nhận request và chuyển response giữa client và Puma. Puma và Nginx giao tiếp với nhau thông qua socket.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 486px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7dd2036e538c4087aec3839f53280d43/4ee7f/puma-nginx.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABLDAAASwwFyLQTKAAACbElEQVQ4y2NY0tTDxAAEc2eWai6evehBW9cyXxC/q2sSMwO54C9DvlVe2baO7Xe2/186w32xrIKd1f//VYzTp7UypKSkMuTn5+PFIIDMZvgoXLMyMGbH0+KHJVf2rpC9b27pv4kUB8ENgoHbDAyMINo9wEkzL0GQPzq+ir2kpJAnLy+PD6iYH4q5oRgkxgEVEwJidhQXvmZwghtspmfP5eTia5KSnGRZVFQkA1QgC8SKQKwAxFJALAfEqkAsBhUHsflRvbxdj7k+OoDBKbQG7Mo6eWMmGxtbZWN3C0myvQwDrGsNeLhXGLOA2CFang5lDGFg20u9shiBmhihrkCmGTEjZaveBI71RkJg0a36C5g3GbiAmPyzjbtYV+j7gdiiS6zASaigoACOYQaA2DA5qJcNahiuqUqARY8YmDK8EuQGsw8apMmucfIAsy8yMBYXFzPi8jKyBWCQXpAdkZudU5ibk5uYl5UblZmfXdUUU60Akqtsq5Ga3T0d5kJRIFYDYhFoJKkC2cIopjt0BrIBDdHOycmxz8/Ps8jNy9XLzc61z8jPFHdpDmUtKihUAGoCxbIMkNYGYn2oQYZArAIVk4OmCDUUw/UM9EWERYTZYPzCgkI2oCJeEAZq4gNibiDmBKVHKBuEhYF8AWj65GcICAgAa/bw8BB0c3NTAWIpZ2dnTgZKgKurK7Ofn5+Ql5cXV1BQEEdERIQoSDw7O5sBmFvggY4cw9hiHB4p27dvN9m2bdu8nTt3tm7YsGHCsmXLJoDEV6xYAcYkgx07dkQdPHjw/enTp28fOnTo0dq1a8/19fWxguRWrlxJklkAxOIYz7K1MVAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mô hình web app\"\n        title=\"mô hình web app\"\n        src=\"/static/7dd2036e538c4087aec3839f53280d43/4ee7f/puma-nginx.png\"\n        srcset=\"/static/7dd2036e538c4087aec3839f53280d43/4edbd/puma-nginx.png 175w,\n/static/7dd2036e538c4087aec3839f53280d43/13ae7/puma-nginx.png 350w,\n/static/7dd2036e538c4087aec3839f53280d43/4ee7f/puma-nginx.png 486w\"\n        sizes=\"(max-width: 486px) 100vw, 486px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Step 2: Chuẩn bị môi trường</h3>\n<p>Nếu các bạn có điều kiện thì có thể thuê VPS ở các nhà cung cấp như AWS - Amazon Web Service, DigitalOcean, Azure, Google Cloud Platform, ...\ncác bạn có thể tham khảo và thuê lấy một cái.</p>\n<p>Do một số điều kiện không cho phép nên ở bài viết này mình sẽ sử dụng một con VPS (Virtual Private Server) được tạo bằng Docker. Mọi người có thể tham khảo <a href=\"https://blog.tomosia.com/create-vps-virtual-private-server-by-docker-and-dockerfile/\">bài viết</a> này.</p>\n<p>Khi mọi người có được một con VPS (Virtual Private Server) của nhà cung cấp, các bạn sẽ được thêm một số thông tin để chúng ta connect vào.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e776af576d8370674e10a77d1e01fb4e/85e74/ssh.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABOElEQVQoz21SWXbCMAw0tA2hwWy36EZZQuKEQBJy/zOpGnl5JvRjni3ZGo3GVllhSJ8b2piB15YWjPfTlZZFR/PjlV52ht5+a0bl1pped1VY7b6i9NhQwjm1ZiIE6eEiBLP9hZJ9TVl+owVjVfbSBNDcBE1XZWdj13zyVdDkuxQw4Z3VMao7betBCDbVQGvTyx7nUIu9jXuJQYgVhBABxerzTApJXfiOHWWnm1xMD43Aj+SVA5gIeSGI1fFe4YInQ5cZjw5S7yNGt8SGpj9lIJBiEI6BzlseEYVIzLn7Mnhlx/PETySIx4ASFMsjRK+MWMBq5ZxXNJM7efsw8gNQBA9RYF+2DQq1U+fNhyXio/syQXFMqCNFiTMePvq/BUzZs/gfelLknwgxhh8X5iNGgfrI/zd9jJHKP2NtIUC/NMD0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mô hình web app\"\n        title=\"mô hình web app\"\n        src=\"/static/e776af576d8370674e10a77d1e01fb4e/8c557/ssh.png\"\n        srcset=\"/static/e776af576d8370674e10a77d1e01fb4e/4edbd/ssh.png 175w,\n/static/e776af576d8370674e10a77d1e01fb4e/13ae7/ssh.png 350w,\n/static/e776af576d8370674e10a77d1e01fb4e/8c557/ssh.png 700w,\n/static/e776af576d8370674e10a77d1e01fb4e/e996b/ssh.png 1050w,\n/static/e776af576d8370674e10a77d1e01fb4e/2cefc/ssh.png 1400w,\n/static/e776af576d8370674e10a77d1e01fb4e/85e74/ssh.png 1436w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nSử dụng lệnh</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">rails new docker_app</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Để tạo một project deploy, hoặc nếu có sẵn thì càng tốt. Xong rồi ta push lên bộ quản lý source code (github, gitlab, ...)\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/890935ffc7ad3d9a5e3418b1679112dd/17009/source-github.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACFUlEQVQ4y4VTy47UMBCc//8GvoADH8CJKxInuCBxWwQ7OzNxYsdvOym6eibZ2V0QllrdfpWrq9uHo214uGQ8nBN+HDN+mwwfAkrtaH1BbV1ti//mablWtcMwDAghws4eMWVMzsOME1IuGCeH2QdZmzHZGSEmDGbbszq3smflzjYONQbUnGUzosoLpRS5kDWmLUtH78KkNYkX9Zx7eYhno4AGwfhy/IZPPz/jQNQoLz5djLCM8LHAp6JxKnJ5BdrybJwXCU7DBOsjLsbibC3ef/+Id18/XAFtKPh1tng0Hi4DcxGr0Nim9Tq/M697K4Y5C5jIIIvjWJECCLhiiguGyYvI7a4IXVKvqiM1o8Xc4HNHoE9t98xkFC0H0VUBTVhwNg5ZLhGs1Cswi2RGCyd6UXzjyKji4op4MfEn8UEeZtGG8QYozHEZHZxzWql1XdVT/Nl7Ff9/g0V187ylvGoRCECwzZqwHMyorcP5svzLFszSdsxCAVX4kMltB9sYst8oxfNY38Q8zzbaGRJwmGZhVPcDPMqe2xhqSkGKFDomsd37rr/qBUO2gFHA9kJDVj2mhC4paXPLF2MP1s1u8y7ey28j6I2hFEWqnFJUoOUGyAf0G0q1GWdhkir/7aJ+M7aYe83Q+YRVmLwuymSd/vXIlGPTNG3su2fqTJlnqOO1D4XY48nsDNc7hsen06uivB2sMjOh3n8AlOORNhB25TYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mô hình web app\"\n        title=\"mô hình web app\"\n        src=\"/static/890935ffc7ad3d9a5e3418b1679112dd/8c557/source-github.png\"\n        srcset=\"/static/890935ffc7ad3d9a5e3418b1679112dd/4edbd/source-github.png 175w,\n/static/890935ffc7ad3d9a5e3418b1679112dd/13ae7/source-github.png 350w,\n/static/890935ffc7ad3d9a5e3418b1679112dd/8c557/source-github.png 700w,\n/static/890935ffc7ad3d9a5e3418b1679112dd/e996b/source-github.png 1050w,\n/static/890935ffc7ad3d9a5e3418b1679112dd/2cefc/source-github.png 1400w,\n/static/890935ffc7ad3d9a5e3418b1679112dd/17009/source-github.png 1932w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Cài đặt một số môi trường, cấu hình cho con server giống như ở máy local, các cầu hình cơ bản như:</p>\n<ul>\n<li>rbenv</li>\n<li>Ruby</li>\n<li>Rails</li>\n<li>MySql</li>\n<li>Git</li>\n<li>Redis</li>\n<li>Nginx</li>\n</ul>\n<p>Nói chung cài những thứ mà project của các bạn cần mà dưới local của các bạn chạy được là được.</p>\n<p>Lưu ý: Khi các bạn cài MySql xong chúng ta nên tạo trước một database sẵn cho ứng dụng.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">mysql -u root -p\nNhập password vào\nGõ lệnh này\nCREATE DATABASE &lt;your_database_name&gt; CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tên database các bạn cần đế để lát nữa còn config vào file database.yml nhé OK như thế là xong.</p>\n<h3>Step 3: Tạo cấu trúc thư mục deploy trên server</h3>\n<p>Capistrano gem sẽ cấu trúc thư mục cho chúng ta. Bước này chúng sẽ tạo ra folder deploy riêng của project của chúng ta.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ mkdir /deploy\n$ mkdir /deploy/apps\n$ mkdir /deploy/apps/docker_app\n$ sudo chown -R www:root /deploy/apps/docker_app\n$ mkdir /deploy/apps/docker_app/shared\n$ mkdir /deploy/apps/docker_app/shared/config</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Muốn connect database vô rails app của chúng ta, mình sẽ tạo ra một file database.yml trong thư mục shared</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ vim /deploy/apps/docker_app/shared/config/database.yml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Giống ở dưới local chúng ta sẽ add chúng attributes cần thiết vào.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">production:\n  adapter: mysql2\n  encoding: utf8mb4\n  pool: 5\n  database: &lt;your_database_name&gt;\n  username: root\n  password: &lt;your_mysql_password&gt;\n  socket: /var/run/mysqld/mysqld.sock</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tiếp theo là file <code class=\"language-text\">application.yml</code>, file này thường chúng hay để các biến môi trường private.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ vim /deploy/apps/docker_app/shared/config/application.yml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Ta cũng add những attributes cần thiết vào trong này. Như ở local</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">SECRET_KEY_BASE: &quot;&lt;your_secret_key_base&gt;&quot;\nsettings:\n  info:\n    name: MyAppName\n    domain: example.com\n  database:\n    email: mail@example.com\n    phone: 1234567890</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Chúng ta cần tạo một <code class=\"language-text\">SECRET_KEY_BASE</code>, để tạo ở dưới local chúng ta gõ lệnh này vào terminal <code class=\"language-text\">RAILS_ENV=production rake secret</code> rồi dán vào file application.yml.</p>\n<h3>Step 4: Cấu hình project trên server</h3>\n<p>Chúng ta cần cấu hình trước cho thằng nginx, mình nghĩ các bạn chưa biết đến về nginx nên tìm hiểu thêm về nginx, vì nó khá là quan trọng.</p>\n<p>Lệnh cài nginx:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ sudo apt-get install nginx</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Sau đó remove giá trị mặc định của nó đi, chúng ta sẽ tạo giá trị khác sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ sudo rm /etc/nginx/sites_enabled/default</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Đây là lí do mình khuyên các bạn tìm hiểu trước về nginx, nếu các bạn chưa hiểu về nó thì sẽ gặp trường hợp của mình trước đây đó là dù các bạn config đúng như thế nào thì nó vẫn vào config default</p>\n<p>Màn hình default của nginx sẽ ra thế này:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5646153a39e4d6388f7aa8a1f4664a15/410b4/man-hinh-default-nginx.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXklEQVQoz32S226CQBCGef+n8AG80QtNvDAewGPV2DTxCltBzieRgqLg350xWNOmnWTC/gM78/27SNvtFo1GA71eD/P5HKPRCIvFAqvVCuv1GpvNBpPJhOuz2QxJkoCiLEvcbrdfKe12O9TrdTSbTXS7XbTbbXQ6HW6iKAo3qdVqaLVaGAwGOJ/P+C+ky+XyEKfTCaRpU1EUyPMcaZpyVjqOY7iuC9u2YZomPM+Drulci6IIkmVZPJnsUpL18XjMhNWa7NM30+kUYRjBcRzQPtu2EIQ+9obOmhvSdN/3OYMg4Ce90DSNNRERhePa8AMPyeeRa3SW2VE4iIWjtPi2TNMqIiIcDofo9/tYLpdQZIXXsizjRX67p/KK/X4vKIXldx+mGsL+CB+XxISEWxEyjRhyOBy4lmUZrterIMmRCZr8ieZncEO6CPp1yKKu38+CtKqqMAzjz42c5VMKTfEFqJlOqnEK+2YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"default nginx\"\n        title=\"default nginx\"\n        src=\"/static/5646153a39e4d6388f7aa8a1f4664a15/8c557/man-hinh-default-nginx.png\"\n        srcset=\"/static/5646153a39e4d6388f7aa8a1f4664a15/4edbd/man-hinh-default-nginx.png 175w,\n/static/5646153a39e4d6388f7aa8a1f4664a15/13ae7/man-hinh-default-nginx.png 350w,\n/static/5646153a39e4d6388f7aa8a1f4664a15/8c557/man-hinh-default-nginx.png 700w,\n/static/5646153a39e4d6388f7aa8a1f4664a15/e996b/man-hinh-default-nginx.png 1050w,\n/static/5646153a39e4d6388f7aa8a1f4664a15/2cefc/man-hinh-default-nginx.png 1400w,\n/static/5646153a39e4d6388f7aa8a1f4664a15/410b4/man-hinh-default-nginx.png 2102w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Sau khi xoá xong, mình tạo một file mới</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ sudo vim /etc/nginx/conf.d/default.conf</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Sau đó coppy đoạn ở dưới này vào trong file default.conf</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">upstream app {\n  # Path to Puma SOCK file, as defined previously\n  server unix:/deploy/apps/docker_app/shared/tmp/sockets/puma.sock fail_timeout=0;\n}\n\nserver {\n  listen 80;\n  server_name localhost;\n\n  root /deploy/apps/docker_app/current/public;\n\n  try_files $uri/index.html $uri @app;\n\n  location / {\n    proxy_set_header X-Forwarded-Proto $scheme;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header Host $host;\n    proxy_redirect off;\n    proxy_set_header Connection &#39;&#39;;\n    proxy_pass http://app;\n    proxy_read_timeout 150;\n  }\n\n  location ~ ^/(assets|fonts|system)/|favicon.ico|robots.txt {\n    gzip_static on;\n    expires max;\n    add_header Cache-Control public;\n  }\n\n  error_page 500 502 503 504 /500.html;\n  client_max_body_size 4G;\n  keepalive_timeout 10;\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Đoạn loằng nhằng trên trông có vẻ khó hiểu. Đây là file config để connect giữa webserver tới rails app. Tức là nó muốn tìm đến puma để connect giữa nginx và puma lại với nhau.</p>\n<p>Chúng ta chỉ cần quan tâm 3 dòng này</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">listen 80;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>App của chúng ta sẽ chạy ở port 80, có thể thay đổi tuỳ chỉnh.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">server unix:/deploy/apps/docker_app/shared/tmp/sockets/puma.sock fail_timeout=0;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Capistrano sẽ tạo cho chúng ta một cấu trúc của một rails app ở trong đường dẫn này <code class=\"language-text\">/deploy/apps/docker_app/</code>, đoạn trên là đường dẫn để dẫn đến puma. Vì cái này sẽ tạo ra sau khi chúng ta deploy nên chúng ta sẽ không thấy file đó.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">root /deploy/apps/docker_app/current/public;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Tiếp theo đoạn sau khi ta deploy nó sẽ sinh ra trong thư mục <code class=\"language-text\">docker_app</code>, đoạn này là nơi Nginx gởi request đến rails app của chúng ta để xử lý</p>\n<p>Sau khi setup xong, chúng ta cần phải reload lại nginx để nginx nhận được sử thay đổi mà chúng ta vừa config</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ sudo service nginx restart</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/46525dcdbee19917b428312054dfa633/0b569/start-nginx.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.142857142857142%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAW0lEQVQI12PgNLL9z2Nq/5/PzOE/t7HdfzZ9q/8sepb/GXXM/zNomf5n0DYjDsPUggwRsHACG8ptYvefWdfiP4OmKUIBMYYiqxWxdv3PYWQDdhUTyFXYFJLgQgCzqFPZzfGJHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"start nginx\"\n        title=\"start nginx\"\n        src=\"/static/46525dcdbee19917b428312054dfa633/8c557/start-nginx.png\"\n        srcset=\"/static/46525dcdbee19917b428312054dfa633/4edbd/start-nginx.png 175w,\n/static/46525dcdbee19917b428312054dfa633/13ae7/start-nginx.png 350w,\n/static/46525dcdbee19917b428312054dfa633/8c557/start-nginx.png 700w,\n/static/46525dcdbee19917b428312054dfa633/e996b/start-nginx.png 1050w,\n/static/46525dcdbee19917b428312054dfa633/2cefc/start-nginx.png 1400w,\n/static/46525dcdbee19917b428312054dfa633/0b569/start-nginx.png 2878w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Step 5: Authentication Git Repository (github) với server và máy host với server</h3>\n<h4>Đầu tiên chúng ta cần xác thức Git Repository với server (VPS).</h4>\n<p>Vì sao có việc này?</p>\n<p>Chúng ta hay quản lý source code (Git Repository) của mình bằng git và nơi chúng ta thường dùng Git Repository là github (có thể gitlab, bitbucket, ...), ở đây nhánh master là nhánh luôn luôn phải đúng, mà luôn đúng thì ta thường show ra, thì nhánh master ta cần phải luôn luôn deploy nếu có sự thay đổi. Việc xác thực giữ github và server ở đây là để capistrano lấy code từ nhánh master trên github để deploy lên server.</p>\n<p>Để xác thực, trên server chúng tạo một ssh key bằng lệnh</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Để show ra ssh key chúng ta mới tạo:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">cat ~/.ssh/id_rsa.pub</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ea89c12d11d79d9223d909a10d6d0ef1/5bd27/result-ssh-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABCElEQVQY041Qy07CUBCdlREoqAgU1L2PhIRHES2UglAo6oKoCxO+gIWJv0BCQuJPH+fce8uaxcm8z5wZKYdT1EepYoGL5ynOn15QVluL5qgMEsUMZ/0J8t3ogEJ3hFzHWi+wfl59xsKBqg5WhxZ+tFA7h68LuKSmPsnps96Il4rUiLiZvDrf9nJW6FgliWlikmRZY8Uss2ovw5mLE3dV6gTYHBcLB6kiS/CE0/bAgARX46UhZJ3XcMm1KvOdeiquKwf7WBOSZEX+7n3zi5/dHzbbPe7evnDSClEI+KtYfzW0P9Q4+2fxcWys53Li9WKUNMkmorn6Rutjjfbn2uTltgN56EHug6PwD/BuvDBuwiHPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result ssh key\"\n        title=\"result ssh key\"\n        src=\"/static/ea89c12d11d79d9223d909a10d6d0ef1/8c557/result-ssh-key.png\"\n        srcset=\"/static/ea89c12d11d79d9223d909a10d6d0ef1/4edbd/result-ssh-key.png 175w,\n/static/ea89c12d11d79d9223d909a10d6d0ef1/13ae7/result-ssh-key.png 350w,\n/static/ea89c12d11d79d9223d909a10d6d0ef1/8c557/result-ssh-key.png 700w,\n/static/ea89c12d11d79d9223d909a10d6d0ef1/e996b/result-ssh-key.png 1050w,\n/static/ea89c12d11d79d9223d909a10d6d0ef1/2cefc/result-ssh-key.png 1400w,\n/static/ea89c12d11d79d9223d909a10d6d0ef1/5bd27/result-ssh-key.png 1432w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Chúng ta coppy đoạn loằng nhằng, lên github tạo một request add ssh key.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/11bd3ded635af454f11cbcdc0fa855db/764d7/github-ssh-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9ElEQVQoz52ST0/DMAzF+/1vXDly46PAYRI7cOWC1qBJ6/JvaRInDyddEAEN0Vr6ya9y9OK4Hk6G8HYMENMMIT5wGEd471Ei5/xv2vlBWwdpPZwnOOcqRLTKrDMMIaBQPlJiOBMlRDZdYB2p1v6KZjoYa/mJAZRSNWpmTS8Uw7Rc2HJuOvUdXi4Op0lCaVuRymCSquaz0jhLzVovmik1pc1Va2hje8PSwewjfNhGYDrD8ryZZ1jwkQ/wvNbSGaLoKzGmTV2m74bvSuD5sMdOvEI6g8wD//1TbhPpR4dP4wvudg+43z9iNMduBdbE19rcKmxd7E9SEl//e9uVjgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result ssh key\"\n        title=\"result ssh key\"\n        src=\"/static/11bd3ded635af454f11cbcdc0fa855db/8c557/github-ssh-key.png\"\n        srcset=\"/static/11bd3ded635af454f11cbcdc0fa855db/4edbd/github-ssh-key.png 175w,\n/static/11bd3ded635af454f11cbcdc0fa855db/13ae7/github-ssh-key.png 350w,\n/static/11bd3ded635af454f11cbcdc0fa855db/8c557/github-ssh-key.png 700w,\n/static/11bd3ded635af454f11cbcdc0fa855db/e996b/github-ssh-key.png 1050w,\n/static/11bd3ded635af454f11cbcdc0fa855db/2cefc/github-ssh-key.png 1400w,\n/static/11bd3ded635af454f11cbcdc0fa855db/764d7/github-ssh-key.png 1782w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h4>Tiếp theo xác thực máy host với server</h4>\n<p>Tại sao có bước này?</p>\n<p>Để deploy rails app từ github lên server, chúng ta cần bắt event để capistrano biết bạn muốn lấy code từ nhánh master của github deploy lên server.</p>\n<p>Thường cách bắt event đơn giản nhất, là từ dưới local (máy host) ta gõ lệnh</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ cap production deploy</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Thì capistrano trên server sẽ nhận lệnh này sẽ tự động lấy code mới nhất ở master pull về máy server để deploy.</p>\n<p>Cách này trong thực tế, sau khi review code xong và ok tất cả mọi thứ, rồi merge code vô branch master, dưới máy local ta gõ lệnh trên thì deploy lên server. Đôi lúc mình hay đi ra ngoài coffee không đem máy host, mà KH lại cần gấp, lúc đó phải bỏ ly coffee chưa kịp uống đành đạch chạy về deploy. Vì quá ức ly coffee chưa kịp uống. Mình lên github setup CI/CD của Github Action, bắt event khi nào review code xong và merge code xong là deploy luôn, phải phải vát theo cái máy host nữa. :))))</p>\n<p>Ở demo này mình sẽ dùng cách thủ công. Để xác thực máy host và server ta gõ lệnh này</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">ssh-copy-id &lt;user&gt;@&lt;address_ip&gt; -f\n\nor\n\nssh-copy-id  &lt;user&gt;@&lt;address_ip&gt; -p &lt;port&gt; -f</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Kết quả\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5dd6e706256fda0b85e349058239b7b7/133ae/xac-thuc-host.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24.571428571428573%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAu0lEQVQY03VQWRaCQAwbFwQegl7DBdlBdrz/oWJTHsKPH3ltM5l0MibIagRVBb8s4eU9LtUHV0FQTjIP8ItRzibYSQsramDHrcKKaq1O0m34BoZiLxtxijs4aYfjq4ab9ioyjxI7gdZnhf0Gvzlce1bjislJnAma0OwQvmHuxYxbvtZ/WLTEWSI5EofRvGxQwxWdnvHVjMyePJfz3sIxvpoxDUnNr+L5tU4y/83yR+TY6wIBtVy+jb8YfgHj8Y7m17iHrwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result ssh key\"\n        title=\"result ssh key\"\n        src=\"/static/5dd6e706256fda0b85e349058239b7b7/8c557/xac-thuc-host.png\"\n        srcset=\"/static/5dd6e706256fda0b85e349058239b7b7/4edbd/xac-thuc-host.png 175w,\n/static/5dd6e706256fda0b85e349058239b7b7/13ae7/xac-thuc-host.png 350w,\n/static/5dd6e706256fda0b85e349058239b7b7/8c557/xac-thuc-host.png 700w,\n/static/5dd6e706256fda0b85e349058239b7b7/e996b/xac-thuc-host.png 1050w,\n/static/5dd6e706256fda0b85e349058239b7b7/2cefc/xac-thuc-host.png 1400w,\n/static/5dd6e706256fda0b85e349058239b7b7/133ae/xac-thuc-host.png 1424w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Và bây giờ, chúng ta có thể ssh lên server mà không cần gõ password nữa.</p>\n<h3>Step 6: Setup project ở dưới local</h3>\n<p>Chúng ta sẽ sử dụng gem Capistrano để hỗ trợ việc deploy. Coppy cái này vào Gemfile:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">gem &#39;capistrano&#39;, &#39;&gt;=3.12.0&#39;\ngem &#39;capistrano3-puma&#39;\ngem &#39;capistrano-rails&#39;, require: false\ngem &#39;capistrano-bundler&#39;, require: false\ngem &#39;capistrano-rbenv&#39;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Sau đó </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ bundle install</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Rồi chạy lệnh để cài đặt Capistrano:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">$ cap install</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Sau khi chạy lệnh trên nó sẽ sinh ra cho chúng ta các file: deploy.rb, deploy/staging.rb, deploy/production.rb,..</p>\n<p>Các file staging.rb, production.rb chẳng qua chỉ là chia ra để dễ phân biệt các môi trường. Ở đây chúng ta chọn môi trường deploy là production nên sẽ set giá trị config vào thằng production.rb</p>\n<p>Mở file deploy.rb lên và copy đoạn bên dưới vào</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># config valid for current version and patch releases of Capistrano\nlock &quot;~&gt; 3.14.1&quot;\n\nset :application, &quot;docker_app&quot;\nset :repo_url, &lt;your_url_remote_github&gt;\n\nset :pty, true\nset :linked_files, %w(config/database.yml config/application.yml)\nset :linked_dirs, %w(log tmp/pids tmp/cache tmp/sockets vendor/bundle public/system public/uploads)\nset :keep_releases, 5\nset :rbenv_path, &#39;/usr/local/rbenv&#39;\nset :puma_rackup, -&gt; { File.join(current_path, &quot;config.ru&quot;) }\nset :puma_state, -&gt; { &quot;#{shared_path}/tmp/pids/puma.state&quot; }\nset :puma_pid, -&gt; { &quot;#{shared_path}/tmp/pids/puma.pid&quot; }\nset :puma_bind, -&gt; { &quot;unix://#{shared_path}/tmp/sockets/puma.sock&quot; }\nset :puma_conf, -&gt; { &quot;#{shared_path}/puma.rb&quot; }\nset :puma_access_log, -&gt; { &quot;#{shared_path}/log/puma_access.log&quot; }\nset :puma_error_log, -&gt; { &quot;#{shared_path}/log/puma_error.log&quot; }\nset :puma_role, :app\nset :puma_env, fetch(:rack_env, fetch(:rails_env, &quot;production&quot;))\nset :puma_threads, [0, 8]\nset :puma_workers, 0\nset :puma_worker_timeout, nil\nset :puma_init_active_record, true\nset :puma_preload_app, false</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ở đây các bạn chỉ cần quan tâm 2 dòng đó là:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set :application, &quot;docker_app&quot;\nset :repo_url, &lt;your_url_remote_github&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<ul>\n<li>set :application : đặt tên cho ứng dụng của bạn, nên điền tên ứng dụng vào đây.</li>\n<li>set :repo_url: link đến repository chứa source code, của mình hiện tại đang là trên github Các bạn cần sửa trỏ đến project của các bạn là ok.</li>\n</ul>\n<p>Tiếp theo file <code class=\"language-text\">config/deploy/production.rb</code>\nMình sử dụng môi trường production chứ không xài staging để test.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">set :stage, :production\nset :rails_env, :production\nset :deploy_to, &quot;/deploy/apps/docker_app&quot;\nset :branch, :master\nserver &lt;server_ipv4_public_ip&gt;, user: &lt;your_user&gt;, roles: %w(web app db)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Đối với mình sẽ là <code class=\"language-text\">server &quot;172.16.0.234&quot;, user: &quot;root&quot;, roles: %w(web app db), port: 32770</code></p>\n<p>Do server mình phải dùng port mới connect được server nên mình thêm một option port nữa, nếu mọi người dùng port default 80 thì không cần phải thêm.</p>\n<p>Các bạn lưu ý thêm một điểm đó là nơi mà chúng ta sẽ deploy app đó là ở đây :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/deploy/apps/docker_app</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Điều đáng lưu ý trong quá trình deploy đó là lộ thông tin cần private, cho nên những file này set biến môi trường thì chúng ta cần vứt vào trong file .gitignore, chúng ta sẽ set nó sau trên server</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># Ignore bundler config.\n/.bundle\n\n# Ignore all logfiles and tempfiles.\n/log/*\n/tmp/*\n!/log/.keep\n!/tmp/.keep\n\n# Other\nconfig/database.yml\npublic/*\n.env\ncoverage/\n.rspec\n\nconfig/settings.local.yml\n\nconfig/settings.local.yml\nconfig/settings/*.local.yml\nconfig/environments/*.local.yml</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Step 7: Deploy</h3>\n<p>Sau khi cấu trúc xong 6 bước \"thần thánh\" trên bước vào giai đoạn tận hưởng đó là deploy.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">cap production deploy</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2ec9daa8867b05089663d61a0e6c4975/09ede/result-deploy-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACjklEQVQ4y21U23LiMBSjLVCSEFJod/+h5ZLEdwdadqYz2///Iq2OA8v1QePgIbKkI2dQhS2m/hu5/0Hh/2JUd3hYeTytww2Gm9u9h5XD4MNisHQ9cr1Hbvck3aMwHca1xeM6EvLnkNbHVY8n7ieijZDHA6G/JBwsLWbW41fUeA0Gi+Aw91+Y6i1yFZG1EZM29GsjRF1PcI7lmcpM7zB1O7zEiFK3qEyLF+swbQ2KVhGaMGnNG43h2p3UHHGuUDLLzQ4zv8WceS6I17BDSfszu0VlOzzXhgo98tZhtNYkcCcs7WkVwkm7RSlkXUBFlQuui/iFQjlMSDRpLJ43pn8mxhvN3xpZrfFwTvZxUJipHYcik44obCA5rTOC8cYmNaO1STgSjRNMguw/rq4U5vqTJJ8pwyrSbhfxtv2i3YCiafscG0V1PeGRVFbZG5L0gnDcRGZIZc6h0JpEgo5Wfa+OSkVt6ts7K/LuetzNkZi5P5jYb0zjDzLVsdiBJIFVYQSah3FPKlMogU+KkqqkyN4ORU4ujcPCN1i4GnNbszY+1eZo8T/qU4aDm4H8t9yxh5xy7AjWxIdUkeHaX1q7Z/WeZSHMTcTMWZQsdOUMKm1SmXMOQ8osQ5lyODPVplxPiuw9hSSjqteoWOg2rfO4563xmGxUsnfMTQ4o0iEq9VDWmylLsXPDHjpPdcwyWBa7I6FNL5dKpeqMEmFf6Aub15YnSkq9ZQ95UwJvSefZRX55VOAg+v4d1QixPN/Yvp7ylGpeON03v8bvILApx5KZHbMTlIeSy/7R+h3LMmXeEi9WDTMU7NJdzupTVvnhtlwrHl0TPktteDMq7zhpfgtThvykKXtBKC+Lwqw5HZDduXr/AFmkHKOr+JnXAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result deploy\"\n        title=\"result deploy\"\n        src=\"/static/2ec9daa8867b05089663d61a0e6c4975/8c557/result-deploy-1.png\"\n        srcset=\"/static/2ec9daa8867b05089663d61a0e6c4975/4edbd/result-deploy-1.png 175w,\n/static/2ec9daa8867b05089663d61a0e6c4975/13ae7/result-deploy-1.png 350w,\n/static/2ec9daa8867b05089663d61a0e6c4975/8c557/result-deploy-1.png 700w,\n/static/2ec9daa8867b05089663d61a0e6c4975/e996b/result-deploy-1.png 1050w,\n/static/2ec9daa8867b05089663d61a0e6c4975/2cefc/result-deploy-1.png 1400w,\n/static/2ec9daa8867b05089663d61a0e6c4975/09ede/result-deploy-1.png 1710w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/76e35384fc5f2a9ddf3f15f5b21f171a/0c1c2/result-deploy-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 106.28571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAADFklEQVQ4y11V2XLaQBAEzCkB4nLs5BMMOlbaSxLgSjmVquT//2fSs7sSIg9Tw46l1vR073gUVTeK9Z32TUOxaWlXW9o1V+RPWhaSFllFq7yiJSIuShdrUbr66Kxo9KEfwefRWVNUadrpgvY6p5PN6Ftd0slY2gh+WfQg21LQBhGFM+fuY+NLAB9fNMWVoq0s6KAzAGX0agV+W/dSHF6MByAMsCoqd+7i5SI9YFReaW3ulNQNckuJZco3SlBbZJLmoLYIwd10HS1C7mLc0Z+khjbK0qlGV0bQW5PR97ZCrkGxdBSZ6q7ycVQFJcj8oTk+OEslTRE9oKMsFSWY4cHw/FJ6A/jJ1gAre9pMmcE7isPu+G895fHFYIaatko4YY4APdkS4DWAHsoy6KpTevAR9yHxBKhBWdPeFEHhlN6bEsJ0HQqXN0GQTaf2QBDu/AlwqzUdrAd8b1L6cRUAtpiVf5mD59aB8Cz53AEnyDzHJ8qebu5niA6P5jHDLuJBl5tBzdsmiMLGdqJAvb3yPmRjd4CxeNAd3pT+I8V/gIsC/tMNbY2G9xQ6FbgxoKFq77eMlSx7L86zTl2v9DzUetvMAejucn2FqVuIA2NDJAaMS0OR0LQOOSpxe6oaZ8wdY1oWmuZ5TZO0IR7d6CPc5biCsa2EVSrQVfQKQY4GXUuYvjIA5wxgPLeV1tUYcId6IuGSUtJLOjD2Cg/uDM9RokMOg4dbdGVwZ3WfV4VBV/gtfHfceYzffGP6zTNhlWXtQQzbB8G0dQvK1oFxZ5wjYV3Nj8I4QO6Yz/0M1/KOPfiTNs0viuwXReqGddbSQtxomjU0y1ua5o2LWdH6GvL4Yp93YbcPGTAyvymu/yL+APCL5gUDtrTCJuLgBcKj6TML4DoKcVYPytMM9qjudKixstg+igcuEcoLUSo3eFY2FsrVdxJrLbcQon6oew4dziB7JBvat1fawjZrNrTFGOQnzTILipb4GY6X1J9dLeTJJQCdA+0ZZrOsPnGfr1gS+J/CSxadJspbY5nxlmFj+9vCeRFqLgpfn4Sb8g/rG1vOnmxD9QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result deploy\"\n        title=\"result deploy\"\n        src=\"/static/76e35384fc5f2a9ddf3f15f5b21f171a/8c557/result-deploy-2.png\"\n        srcset=\"/static/76e35384fc5f2a9ddf3f15f5b21f171a/4edbd/result-deploy-2.png 175w,\n/static/76e35384fc5f2a9ddf3f15f5b21f171a/13ae7/result-deploy-2.png 350w,\n/static/76e35384fc5f2a9ddf3f15f5b21f171a/8c557/result-deploy-2.png 700w,\n/static/76e35384fc5f2a9ddf3f15f5b21f171a/e996b/result-deploy-2.png 1050w,\n/static/76e35384fc5f2a9ddf3f15f5b21f171a/2cefc/result-deploy-2.png 1400w,\n/static/76e35384fc5f2a9ddf3f15f5b21f171a/0c1c2/result-deploy-2.png 1542w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Kết quả</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/096f6bb1d117a6959ceeaa914fa8a9e8/db7ce/result.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.428571428571427%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAbElEQVQY062IywqAIBRE/aMyKoq08OPzUYvsf5RJb49Vq2jgMIfDpJggpIIcFbpe0A+p8apFyWsUZf145vbzG4JXJ7kzrQ2MscScXF9Y66BTy0+emltWcucWeL8T2/XkmwfDz2MxRnwhhDcCDnPQAqs/sDV8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result\"\n        title=\"result\"\n        src=\"/static/096f6bb1d117a6959ceeaa914fa8a9e8/8c557/result.png\"\n        srcset=\"/static/096f6bb1d117a6959ceeaa914fa8a9e8/4edbd/result.png 175w,\n/static/096f6bb1d117a6959ceeaa914fa8a9e8/13ae7/result.png 350w,\n/static/096f6bb1d117a6959ceeaa914fa8a9e8/8c557/result.png 700w,\n/static/096f6bb1d117a6959ceeaa914fa8a9e8/e996b/result.png 1050w,\n/static/096f6bb1d117a6959ceeaa914fa8a9e8/2cefc/result.png 1400w,\n/static/096f6bb1d117a6959ceeaa914fa8a9e8/db7ce/result.png 2404w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>EZ mọi người nhỉ :))))))</p>\n<h2>Chốt bài viết</h2>\n<p>Qua đây mình đã giới thiệu cho mọi người cách setup, config, deploy việc sử dụng gem capistrano để deploy.\nVì nó hỗ trợ chúng ta khá nhanh trong việc deploy rails app, nên chúng ta sẽ bỏ qua các bước setup của nó. Mọi người sau tìm hiểu sâu thêm nó sau khi deploy ok nhé. :)))))</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Long Vui Vẻ (longvv) </div><div class=\"custom-block-body\"></div></div>","id":"f7837025-9f3e-585a-8ec0-cf823b3424ea","frontmatter":{"title":"How to deploy rails app by capistrano gem (puma, mysql, nginx)","date":"15-11-2020","tags":["ruby on rails","deploy","Capistrano gem"]},"fields":{"slug":"/how-to-deploy-rails-app-by-capistrano-gem-puma-mysql-nginx/","readingTime":{"text":"13 min read"}}}},{"node":{"excerpt":"Cách bypass lỗi \"Your connection is not private\" trên chrome Chắc mọi người quá quen với màn hình này rồi. your connection is not private Chrome Warning khi ta truy cập vào một trang web có…","snippet":"<div class=\"custom-block-body\"><p>C&#xE1;ch bypass l&#x1ED7;i &quot;Your connection is not private&quot; tr&#xEA;n chrome</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Cách bypass lỗi \"Your connection is not private\" trên chrome</p></div></div>\n<p>Chắc mọi người quá quen với màn hình này rồi.</p>\n<p><img src=\"https://archive.org/download/your-connection-is-not-private-error-in-google-chrome/your-connection-is-not-private-error-in-google-chrome.png\" alt=\"your connection is not private\"></p>\n<p>Chrome Warning khi ta truy cập vào một trang web có certificates không bảo mật.\nTest một trang web https trên local chẳng hạn.\nBình thường thì chrome sẽ có button <strong>Advanced</strong> hoặc <strong>Proceed</strong> cho phép tiếp tục truy cập trang web này.\nNhưng với ai đang dùng mac, có cập nhật Mac OS mới Catalina thì button này đã bị bỏ hẳn. Thành ra không có cách nào để tiếp tục truy cập trang web đó nữa.</p>\n<p>Thực tế không phải ai cũng biết, vẫn có cách để vượt qua.\nGiả sử màn hình đang hiển thị warning,\nĐặt tay lên bàn phím và type chính xác câu sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">thisisunsafe</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Một cách thần kì, bạn sẽ truy cập được trang web như trước.</p>\n<p>Cách này rất hữu dụng nhưng bạn nhớ sử dụng cẩn thận và tự chịu trách nhiệm với hành động của mình! :D</p>\n<p>[[author | Vịt vụng về ]]</p>","id":"66c0bdba-98bb-5ed1-9468-2d055ff30657","frontmatter":{"title":"This is unsafe!","date":"10-11-2020","tags":["tips","chrome"]},"fields":{"slug":"/this-is-unsafe/","readingTime":{"text":"1 min read"}}}},{"node":{"excerpt":"Tiêu đề bài này có thể làm bạn ngạc nhiên bởi vì  là một phương thức cơ bản và phổ biến nhất để debug trong JavaScript. Ấy vậy mà mình lại nói \"Ngừng sử dụng\" nó. Tại sao? Thực ra không hẳn là vậy,…","snippet":"<html><head></head><body><p>Ti&#xEA;u &#x111;&#x1EC1; b&#xE0;i n&#xE0;y c&#xF3; th&#x1EC3; l&#xE0;m b&#x1EA1;n ng&#x1EA1;c nhi&#xEA;n b&#x1EDF;i v&#xEC; <code class=\"language-text\">console.log()</code> l&#xE0; m&#x1ED9;t ph&#x1B0;&#x1A1;ng th&#x1EE9;c c&#x1A1; b&#x1EA3;n v&#xE0; ph&#x1ED5; bi&#x1EBF;n nh&#x1EA5;t &#x111;&#x1EC3; debug trong JavaScript. &#x1EA4;y v&#x1EAD;y m&#xE0; m&#xEC;nh l&#x1EA1;i n&#xF3;i &quot;Ng&#x1EEB;ng s&#x1EED; d&#x1EE5;ng&quot; n&#xF3;. T&#x1EA1;i sao?</p> <p>Th&#x1EF1;c ra kh&#xF4;ng h&#x1EB3;n l&#xE0; v&#x1EAD;y, nh&#x1B0;ng ngo&#xE0;i <code class=\"language-text\">log()</code> ra th&#xEC;&#x2026;</p></body></html>","html":"<p>Tiêu đề bài này có thể làm bạn ngạc nhiên bởi vì <code class=\"language-text\">console.log()</code> là một phương thức cơ bản và phổ biến nhất để debug trong JavaScript. Ấy vậy mà mình lại nói \"Ngừng sử dụng\" nó. Tại sao?</p>\n<p>Thực ra không hẳn là vậy, nhưng ngoài <code class=\"language-text\">log()</code> ra thì chúng ta có thể dùng nhiều phương thức khác để có thể debug. Và bạn sẽ cảm thấy chúng rất thú vị và mạnh mẽ. Hãy bắt đầu bằng việc liệt kê các phương thức khác: </p>\n<ol>\n<li>Console.log()</li>\n<li>Console.error()</li>\n<li>Console.warn()</li>\n<li>Console.clear()</li>\n<li>Console.time()</li>\n<li>Console.timeEnd()</li>\n<li>Console.table()</li>\n<li>Console.group()</li>\n<li>Console.count()</li>\n<li>Console.debug()</li>\n<li>Console.dir()</li>\n<li>Console.dirxml()</li>\n<li>Console.exception()</li>\n<li>Console.groupCollapsed()</li>\n<li>Console.groupEnd()</li>\n<li>Console.profile()</li>\n<li>Console.profileEnd()</li>\n<li>Console.timeStamp()</li>\n<li>Console.trace()</li>\n<li>Console.info()</li>\n</ol>\n<p>Trong bài này mình sẽ giới thiệu 6 phương thức đầu tiên. Nhưng trước tiên hãy cùng nhắc lại \"Console là gì?\" </p>\n<p>Javascript console là một tính năng được xây dựng trong các trình duyệt ngày nay, nó đưa ra các công cụ giúp lập trình kiểm tra rõ ràng trên các giao diện. Nó cho phép lập trình viên:</p>\n<ul>\n<li>Nhìn thấy những lỗi (errors) hay cảnh báo (warnings) xảy ra trên một trang web.</li>\n<li>Tương tác với trang web sử dụng Javascript commands.</li>\n<li>Gỡ lỗi (Debug) ứng dụng web ngay trên trình duyệt của mình</li>\n<li>Kiểm tra và nghiên cứu các hoạt động của network</li>\n</ul>\n<p>Đơn giản là nó trao quyền cho người dùng, lập trình viên thao tác với Javascript ngay trên trình duyệt. Giờ thì bắt đầu đi vào chi tiết nào !</p>\n<h2>1. Console.log()</h2>\n<p>Thao tác này quá quen thuộc rồi, đơn giản là hiển thị giá trị của một hoặc nhiều biến ra console, có thể là text, number, array, object, v.v..</p>\n<p>Ví dụ : </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'JavaScript'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Kết quả: </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 351px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4470ed82ce462eb25d50954fd3c3d31b/7c2a6/image-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABJ0lEQVQoz5VQWXaDMAzkAnnpZ2n5SrAxBq94wQ4mZC3c/0JV6AFS5smynkYjWc5055wPfRhaLp0Lj+d8u/8IqXe7XVEUeZ7v9x99OE2XezyNLZPA3u7PIU20FZnSxljvfQRCKRNiOg0jY/Iz/0IYlwjl34V1YRwvMAPy0CilyftAKcugn7F9iAMQ1+tDKoMrShsOvWrKwEvZhTCASaXneW6atixLjDEhdQaRd36el3E8L8vCGMe4qiry5+GswQsEymuwGu7VyEssuLLGCCG01lCE/o2sRCUlkmB+XIG2ACYfOdNWJ4Qw2ojXszlnzpl1GVgVbxMLIWOM1sLiZk3iDWLGWErJu8Ba1VBhbQDicDi8F8MnwT9P05nzrvcBlEIYKVWn/dsNfgGnhm6YCVlZaQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-1.png\"\n        title=\"image-1.png\"\n        src=\"/static/4470ed82ce462eb25d50954fd3c3d31b/7c2a6/image-1.png\"\n        srcset=\"/static/4470ed82ce462eb25d50954fd3c3d31b/4edbd/image-1.png 175w,\n/static/4470ed82ce462eb25d50954fd3c3d31b/13ae7/image-1.png 350w,\n/static/4470ed82ce462eb25d50954fd3c3d31b/7c2a6/image-1.png 351w\"\n        sizes=\"(max-width: 351px) 100vw, 351px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>2. Console.error()</h2>\n<p>Phương thức này rất hữu ích trong khi test code. Nó được sử dụng để ghi lỗi vào browser console. Theo mặc định, thông báo lỗi sẽ được tô sáng bằng màu đỏ.</p>\n<p>Ví dụ: </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'Error found'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Kết quả: </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 346px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e12a4042e48ca3e2bf4c8db7c7a018b8/8f77f/image-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAABHElEQVQY03XNT2+DIBjHcS7rmvWmNmvcpN1cFRCQgv8roFTbLD3u/b+XmfW85HP4PskveUBRNr0eMppXdTfNt8t01WYMgq3v+xDCIPB3u9AOl2Gc2k4vs/n6PbrZWMf4CUhZ1nWHCVuOrtPaDE17DsP3KIJpiiHcR9G+760xY92cEc763tjB9doyJoBUlbWO0ty5q1JNHKcpophwhNlXQiiXlAl3mZcfShb3+50QEsdxcjyiFIFcqqJpi7otm0pVQlVFKYUUPOeskvnipIqM5ZgywriQKmMcU/oANMY3ISae6+QwZ5FBn/Xbzh5CFb66j3A4hCcI08BHQbBIPO8RD6Bbr2+bTb96MuuXH29br54RAAQACsAS+C/4P34BCog7HJPQo68AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-2.png\"\n        title=\"image-2.png\"\n        src=\"/static/e12a4042e48ca3e2bf4c8db7c7a018b8/8f77f/image-2.png\"\n        srcset=\"/static/e12a4042e48ca3e2bf4c8db7c7a018b8/4edbd/image-2.png 175w,\n/static/e12a4042e48ca3e2bf4c8db7c7a018b8/8f77f/image-2.png 346w\"\n        sizes=\"(max-width: 346px) 100vw, 346px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>3. Console.warn()</h2>\n<p>Cũng giống như <code class=\"language-text\">console.error()</code>, phương thức này cũng dùng khi testing code. Nó cũng giúp ghi các cảnh báo vào console. Mặc định thì các thông báo này có màu vàng </p>\n<p>Ví dụ: </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Warning!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Kết quả: </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 349px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9b900a8263f43c6e641461468e2c571b/e9bf8/image-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAA6ElEQVQY03XOO0/DMBQF4ChhooWKGZoOUfyIc/1IYjuxExcoKo2KKjrA//8pWMrUAenT0R3OlU6iGt12xvYeQLatcW6KhGieX7YIYYTJNt91nQ37N9s74FKb3vvJ2oHVPImX1r0fA3D1fvjksitKgilQJhCFioGQbXyLBS7kPJ8AeFEUCCFCSFKWVMpmcE4bazR4J4PtJlW/tuAVxE0Yk2UCJpTSKiKELpLTtDnu85+rvp7F90xG/eibzSjXQT04sbbqqalXit0rtuSN5BzuDsPq6yO/HHe/l0rXqYHU8ExDFtNC2ovsP3+7pzWPId52EQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-3.png\"\n        title=\"image-3.png\"\n        src=\"/static/9b900a8263f43c6e641461468e2c571b/e9bf8/image-3.png\"\n        srcset=\"/static/9b900a8263f43c6e641461468e2c571b/4edbd/image-3.png 175w,\n/static/9b900a8263f43c6e641461468e2c571b/e9bf8/image-3.png 349w\"\n        sizes=\"(max-width: 349px) 100vw, 349px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>4. Console.clear()</h2>\n<p>Phương thức này dùng để xóa console. Nó thường được sử dụng nếu console của bạn bị tắc nghẽn với các thông báo hoặc lỗi. </p>\n<p>Ví dụ : </p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Kết quả: </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 348px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8003245098098c8e22cb9b6e9e185252/34ea4/image-4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.714285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAwElEQVQI1zWN227CMBBE81p/ARXQl8SOIRfbWTsOjp0LATX9/x/qCMRotTrSzs5k2ljrht6Hqm476h/PfXv8ms4yxr6hw+GLsY7csm5jnC7XZlk2eKb5Ds6MsUS9H0LdaMAtpBCS1nQ8njkvMafzD56neYWnabV1fowJjLIsjAnN2Dis96fSlBdlKatr1SK7qpUyyL7FNDet2vc/pVSeF0IIKWVWcE5EKaUe9cPgnPPexxgBHBZRivdGoJSXl+RH/+iQLTpiHxd3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-4.png\"\n        title=\"image-4.png\"\n        src=\"/static/8003245098098c8e22cb9b6e9e185252/34ea4/image-4.png\"\n        srcset=\"/static/8003245098098c8e22cb9b6e9e185252/4edbd/image-4.png 175w,\n/static/8003245098098c8e22cb9b6e9e185252/34ea4/image-4.png 348w\"\n        sizes=\"(max-width: 348px) 100vw, 348px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Sau khi thực hiện lệnh này, sẽ có thông báo \"Console was cleared\"</p>\n<h2>5. Console.time () và Console.timeEnd()</h2>\n<p>Cả hai phương pháp này được sử dụng kết hợp với nhau. Bất cứ khi nào chúng ta muốn biết lượng thời gian dành cho một khối hoặc một hàm, chúng ta có thể sử dụng các phương thức <code class=\"language-text\">time()</code>và <code class=\"language-text\">timeEnd()</code>. Cả hai hàm này đều nhận một chuỗi làm tham số. Đảm bảo rằng bạn sử dụng cùng một chuỗi cho cả hai hàm này để đo thời gian.</p>\n<p>Ví dụ :</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">console<span class=\"token punctuation\">.</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">hello</span> <span class=\"token operator\">=</span>  <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>  \n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello Console!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">bye</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>  \n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bye Console!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">hello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">bye</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">timeEnd</span><span class=\"token punctuation\">(</span><span class=\"token string\">'timer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Kết quả: </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 346px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cf6baa1ea5c596eb035c4b2580b75667/8f77f/image-5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.142857142857146%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABL0lEQVQY031NSXKDMBDkDfbBTsq4AgJkbaxhM0ICRMoY2w+wD775/1/IZKtK5ZCuUY9qpqfbyou63ssoyeLk9TDNXT/2w7hePy+XC9u2V6vVYrFUaug600hNWQQC83boehPFmZVlRZ5XQsSUin2jGqmk1JvNdmNvA4xfHGf99AzuSvVVLQnlVb0Ho1Z1UZRaaVbIVoswUXqoqsZFAaGCgxcLd4SHUQoJH6taRnE6z3Mcxwh5gR/gHbHyolS6S9NMyraRbVlWnAtCKKEMigJDHBeMC+AkScMwZIx/FrP6vj+fz1qr43GCj1IK48DzkO97PrxvoK/mui5C6GfoWaAuy7JtW2PMYAwhBKYYY7gEafAvLCnl4/EAHsfxcrnc7/fb7Xa9Xk+n0zRNjuP8yv+Ld5jMUKXdz5ImAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image-5.png\"\n        title=\"image-5.png\"\n        src=\"/static/cf6baa1ea5c596eb035c4b2580b75667/8f77f/image-5.png\"\n        srcset=\"/static/cf6baa1ea5c596eb035c4b2580b75667/4edbd/image-5.png 175w,\n/static/cf6baa1ea5c596eb035c4b2580b75667/8f77f/image-5.png 346w\"\n        sizes=\"(max-width: 346px) 100vw, 346px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Trên đây là 6 phương thức hữu ích giúp khai thác tối đa console của bạn và giúp việc xem nhật ký trình duyệt một cách sinh động hơn. Những phương pháp tiếp theo mình sẽ giới thiệu trong bài viết tới.</p>\n<p>Cảm ơn và hẹn gặp lại ! See yaaaa</p>\n<p> <em>From Vnus with love ....</em></p>","id":"816ec39f-7658-54a5-a7c1-9c38f5dd3787","frontmatter":{"title":"Stop Using console.log() In JavaScript - Part 1","date":"10-11-2020","tags":["Javascript"]},"fields":{"slug":"/stop-using-console-log-in-javascript/","readingTime":{"text":"4 min read"}}}},{"node":{"excerpt":"I. Mở đầu Laravel được biết đến là một framework PHP an toàn để tạo các trang web và ứng dụng. Những dự án có nhu cầu bảo mật cao thường chọn Laravel. Chúng ta sẽ xem xét các tính năng bảo mật chính…","snippet":"<html><head></head><body><h1>I. M&#x1EDF; &#x111;&#x1EA7;u</h1> <p>Laravel &#x111;&#x1B0;&#x1EE3;c bi&#x1EBF;t &#x111;&#x1EBF;n l&#xE0; m&#x1ED9;t framework PHP an to&#xE0;n &#x111;&#x1EC3; t&#x1EA1;o c&#xE1;c trang web v&#xE0; &#x1EE9;ng d&#x1EE5;ng. Nh&#x1EEF;ng d&#x1EF1; &#xE1;n c&#xF3; nhu c&#x1EA7;u b&#x1EA3;o m&#x1EAD;t cao th&#x1B0;&#x1EDD;ng ch&#x1ECD;n Laravel. Ch&#xFA;ng ta s&#x1EBD; xem x&#xE9;t c&#xE1;c t&#xED;nh n&#x103;ng b&#x1EA3;o m&#x1EAD;t ch&#xED;nh m&#xE0; Laravel s&#x1EBD; h&#x1ED5; tr&#x1EE3; &#x111;&#x1EC3;&#x2026;</p></body></html>","html":"<h1>I. Mở đầu</h1>\n<p>Laravel được biết đến là một framework PHP an toàn để tạo các trang web và ứng dụng. Những dự án có nhu cầu bảo mật cao thường chọn Laravel. Chúng ta sẽ xem xét các tính năng bảo mật chính mà Laravel sẽ hổ trợ để giúp đảm bảo an toàn cho ứng dụng web của chúng ta.</p>\n<h1>II. Các tính năng bảo mật trong Laravel</h1>\n<p>Tính năng bảo mật của Laravel đảm bảo rằng các nhà phát triển hiện có thể sử dụng hầu như mọi khía cạnh của quy trình bảo mật an toàn. Hơn nữa, tất cả dữ liệu liên quan đến quy trình đều được kiểm tra ở bất kỳ đâu cần thiết, có nghĩa là nền tảng bảo vệ chống lại các lỗ hổng phổ biến.</p>\n<ul>\n<li>Laravel Authentication System</li>\n<li>Reduce Laravel Vulnerabilities From CSRF (Cross Site Request Forgery)</li>\n<li>Protection against XSS (Cross Site Scripting)</li>\n<li>SQL Injection</li>\n<li>Improve Laravel Application Security</li>\n<li>Laravel Security Packages</li>\n</ul>\n<h2>1. Laravel Authentication System</h2>\n<p>Laravel cung cấp sẵn một quy trình xác thực người dùng mạnh mẽ với mã bảng soạn sẵn liên quan có sẵn trong giàn giáo.</p>\n<p>Laravel sử dụng <code class=\"language-text\">providers</code> và <code class=\"language-text\">guards</code> để tạo thuận lợi cho quá trình xác thực. Mục đích của <code class=\"language-text\">guards</code> là xác thực người dùng cho mỗi yêu cầu mà họ đưa ra, trong khi <code class=\"language-text\">providers</code> tạo điều kiện để truy xuất lại người dùng từ cơ sở dữ liệu.</p>\n<p>Là một nhà phát triển, tất cả những gì bạn phải làm là thiết lập database, bộ điều khiển và mô hình. Trong quá trình này, các tính năng xác thực được tích hợp vào trong ứng dụng.</p>\n<h2>2. Reduce Laravel Vulnerabilities From CSRF (Cross Site Request Forgery)</h2>\n<p>Laravel thường sử dụng CSRF để đảm bảo rằng các bên thứ ba bên ngoài không thể tạo yêu cầu giả mạo và không vi phạm bảo mật của Laravel.</p>\n<p>Đối với điều này, Laravel tự động tạo CSRF cho mỗi phiên người dùng đang hoạt động. Khi yêu cầu được gọi thì Laravel sẽ so sánh mã thông báo yêu cầu với mã thông báo đã lưu trước đó trong phiên của người dùng. Nếu mã thông báo không khớp thì yêu cầu được coi là không hợp lệ và nó chấm dứt thực thi. Ngoài ra, bất cứ khi nào bạn xác định một biểu mẫu HTML trong ứng dụng của mình, bạn phải cung cấp một trường CSRF ẩn để phần mềm trung gian bảo vệ CSRF sẽ xử lý phần còn lại.</p>\n<p>Giả sử hệ thống của bạn có 1 action xóa tài khoản người dùng như sau:\n<code class=\"language-text\">https://xyz.com/account/{id}/delete</code>\nNếu có một người nào biết được link này thì họ sẽ hack được, họ có thể gửi mail cho bạn chứa link, hoặc nội dung là một hay nhiều thẻ img với src chính là url đó và mỗi hình có id khác nhau kiểu như:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>img height<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"0\"</span> width<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"0\"</span> src<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"https://xyz.com/account/{id}/delete\"</span><span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Sử dụng CSRF token: Trong Laravel cung cấp cho bạn phòng tránh, bạn có thể thêm vào các Form:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token operator\">&lt;</span>form method<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"POST\"</span> action<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"/profile\"</span><span class=\"token operator\">></span>\n    @csrf\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>3. Protection against XSS (Cross Site Scripting)</h2>\n<p>Cross-site scripting (XSS) cho phép những kẻ tấn công đưa các đoạn mã độc hại vào nội dung của các trang web đáng tin cậy. Các tập lệnh này đi cùng với nội dung động đến trình duyệt của người dùng và được thực thi ở đó. Bằng cách này, những kẻ tấn công lợi dụng các lỗ hổng trong trang web mà người dùng truy cập.</p>\n<p>XSS là một đoạn mã độc, để khái thác một lỗ hổng XSS, hacker sẽ chèn mã độc thông qua các đoạn script để thực thi chúng ở phía Client. Mục đích chính của cuộc tấn công này là ăn cắp dữ liệu nhận dạng của người dùng như: cookies, session tokens và các thông tin khác.\nTrong hầu hết các trường hợp, cuộc tấn công này đang được sử dụng để ăn cắp cookie của người khác. Như chúng ta biết, cookie giúp chúng tôi đăng nhập tự động. Do đó với cookie bị đánh cắp, chúng tôi có thể đăng nhập bằng các thông tin nhận dạng khác.</p>\n<h2>4. SQL Injection</h2>\n<p>SQL Injection (SQLi) là một kỹ thuật tấn công trong đó các câu lệnh SQL độc hại được chèn vào một dữ liệu đầu vào và được thực thi. Điều này cho phép những kẻ tấn công kiểm soát cơ sở dữ liệu. Họ có thể sửa đổi, đánh cắp hoặc xóa dữ liệu.</p>\n<p>Laravel sử dụng Eloquent ORM (object relational mapper) không cho phép dữ liệu truy vấn độc hại đi qua các biểu mẫu của bạn. Do ràng buộc tham số PDO, Eloquent ORM thoát các lệnh SQL này và lưu các truy vấn không hợp lệ dưới dạng văn bản.</p>\n<p>Hãy xem xét ví dụ về biểu mẫu được sử dụng để thu thập địa chỉ email của người dùng từ cơ sở dữ liệu. biểu mẫu sẽ tìm kiếm một địa chỉ email, ví dụ: “abc@example.com”. Bây giờ hãy tưởng tượng rằng truy vấn SQL được sửa đổi thành:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> email <span class=\"token operator\">=</span> <span class=\"token string\">'abc@example.com'</span> <span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Trong ví dụ trên, 1 = 1 là một biểu thức logic đơn giản luôn đúng.\nBây giờ hãy xem xét một ứng biến khác của cuộc tấn công, trong đó truy vấn được sửa đổi trực tiếp thành lệnh “drop table users” và thay vì địa chỉ email, “abc@example.com” được viết. Truy vấn sẽ giống như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> email <span class=\"token operator\">=</span> <span class=\"token string\">'abc@example.com'</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> users<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Khi truy vấn này được thực thi, bảng “users” sẽ bị xóa khỏi cơ sở dữ liệu.\nKhi ràng buộc tham số PDO được đặt, đầu vào nằm trong dấu ngoặc kép và truy vấn sẽ giống như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> users <span class=\"token keyword\">WHERE</span> email <span class=\"token operator\">=</span> <span class=\"token string\">'abc@example.com or 1=1'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Vì không có bản ghi nào khớp với email hoặc “1 = 1”, nên truy vấn sẽ không trả về bất kỳ thứ gì.</p>\n<p>Laravel cung cấp các cách khác để nói chuyện với cơ sở dữ liệu, chẳng hạn như truy vấn SQL thô. Tuy nhiên, Eloquent vẫn là lựa chọn phổ biến nhất. Học cách sử dụng ORM vì nó giúp ngăn chặn các cuộc tấn công chèn vào SQL do các truy vấn SQL độc hại gây ra.</p>\n<h2>5. Improve Laravel Application Security</h2>\n<p>Nhờ các tính năng bảo mật Laravel có sẵn, framework này đã an toàn hơn nhiều so với các framework PHP khác. Tuy nhiên, có một số điều bạn có thể làm để làm cho project Laravel của bạn an toàn hơn. Một số điều này cho phép bạn làm cho ứng dụng của mình không gặp rủi ro khỏi tất cả các cuộc tấn công mã có thể xảy ra và tăng cường bảo mật của nó ở mức độ cao hơn.</p>\n<p>Laravel sử dụng PDO để ngăn chặn các cuộc tấn công SQL injection vì không có biến nào được chuyển vào cơ sở dữ liệu mà không cần xác thực. Tuy nhiên, các nhà phát triển vẫn chọn SQL thô vì nhiều lý do.\nNếu trường hợp này xảy ra với bạn, bạn nên luôn sử dụng các truy vấn SQL được chuẩn bị kỹ lưỡng để ngăn ngừa rủi ro. Hãy xem xét câu lệnh sau để tránh SQL injection:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\">$email <span class=\"token operator\">=</span> <span class=\"token string\">\"'abc@example.com' or 1=1\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Truy vấn không an toàn</span>\nDB::raw<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM users WHERE email = $email\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Truy vấn an toàn</span>\nDB::raw<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT * FROM users WHERE email = ?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>$email<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Laravel thay thế các dấu hỏi bằng biến truy vấn, tự động bỏ qua các biến đầu vào. Điều này bảo vệ hệ thống khỏi các cuộc tấn công SQL injection.</p>\n<h3>5.1. Force HTTPS</h3>\n<p>Khi bạn triển khai trang web của mình trên HTTP, tất cả dữ liệu được trao đổi bao gồm mật khẩu và những dữ liệu khác được gửi ở dạng nội dung thuần túy. Do đó có thể dễ dàng bị đánh cắp bởi bất kỳ ai giữa đường truyền. Vì vậy, để giữ an toàn cho thông tin này, hãy luôn triển khai các ứng dụng web của bạn trên HTTPS để bảo vệ thông tin nhạy cảm của nó.</p>\n<p>Bạn chỉ cần thiết lập chứng chỉ SSL trên trang web của mình bằng cách nhận được sự hỗ trợ nhỏ từ bất kỳ nhà phát triển Laravel nào, những ứng dụng kia sẽ chuyển ứng dụng của bạn từ HTTP sang HTTPS một cách dễ dàng. Trong khi để ẩn các đường dẫn nhất định, bạn có thể sử dụng bộ lọc được xác định bên dưới sẽ chuyển hướng người dùng đến một đường dẫn an toàn.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">Route<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'https'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Request<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">secure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Redirect<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">secure</span><span class=\"token punctuation\">(</span><span class=\"token constant\">URI</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">current</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>5.2. Escape Content to Prevent XSS</h3>\n<p>Để tránh các cuộc tấn công XSS, bạn nên sử dụng cú pháp dấu ngoặc kép:<code class=\"language-text\">{{ $variable }}</code></p>\n<p>Chỉ sử dụng cái này <code class=\"language-text\">{!! $variable !!}</code> khi bạn chắc chắn rằng dữ liệu trong biến được hiển thị an toàn hơn.</p>\n<h3>5.3. Use Laravel Purifier</h3>\n<p>Dấu ngoặc nhọn kép trong Laravel đảm bảo rằng không có HTML thô nào được cung cấp cho khách hàng, tuy nhiên, nếu bạn muốn cung cấp một số biến HTML cho khách hàng từ cơ sở dữ liệu của mình, thì bạn có thể sử dụng HTML Purifier, một công cụ được cập nhật toàn diện sẽ nâng cấp mã của bạn và sẽ xử lý các mã HTML bị bỏ sót và bị thiếu.</p>\n<h2>6. Laravel Security Packages</h2>\n<p>Laravel cung cấp một số packages để tăng cường bảo mật cho các ứng dụng của bạn. Dưới đây là các package bảo mật phổ biến nhất cho Laravel:</p>\n<h3>6.1. Laravel Security Component</h3>\n<p>Laravel Security Component chủ yếu cung cấp bảo mật cho các roles/objects và tích hợp lõi bảo mật Symfony trong Laravel. Nó sử dụng cử tri để kiểm tra các đặc quyền dựa trên các vai trò khác nhau, vì vậy có thể xác nhận tính bảo mật của nó.</p>\n<h3>6.2. Laravel Security</h3>\n<p>Laravel Security là một trong những package được sử dụng thường xuyên nhất và được biết đến với việc loại bỏ các lỗ hổng XSS trong codebase. Nó đã được chuyển từ Codeigniter 3 sang Laravel 5.</p>\n<h3>6.3. Laravel-ACL</h3>\n<p>Laravel-ACL cung cấp các quyền được bảo mật dựa trên vai trò cho quá trình xác thực Laravel. Package này giúp bảo vệ các route và phương pháp điều khiển CRUD trong các ứng dụng.</p>\n<h1>III. Tổng kết</h1>\n<p>Đây là các tính năng bảo mật quan trọng nhất của Laravel. Hy vọng mọi người nhớ tất cả các tính năng này và áp dụng trên ứng dụng trong các dự án với Laravel tiếp theo để giúp bảo vệ trang web của mình.</p>\n<p>--- Cảm ơn mọi người đã đọc bài viết của mình. Chúc một ngày vui vẻ!!! ---</p>\n<h6><em><div style=\"text-align: right\"> - by Anh Lee </div></em></h6>","id":"23bcc07b-b420-5436-9be2-29973331699a","frontmatter":{"title":"Laravel Security Best Practices for Your Website","date":"08-11-2020","tags":["laravel"]},"fields":{"slug":"/laravel-security-best-practices-for-your-website/","readingTime":{"text":"10 min read"}}}},{"node":{"excerpt":"Chào mọi người, hôm nay chúng ta hãy cùng nhau tìm hiểu về Authentication 2.0 trong Framework CakePHP 4 nhé! I. Cài đặt Authentication 2.0 Cài đặt plugin với composer từ thư mục ROOT của Dự án CakePHP…","snippet":"<html><head></head><body><p>Ch&#xE0;o m&#x1ECD;i ng&#x1B0;&#x1EDD;i, h&#xF4;m nay ch&#xFA;ng ta h&#xE3;y c&#xF9;ng nhau t&#xEC;m hi&#x1EC3;u v&#x1EC1; Authentication 2.0 trong Framework CakePHP 4 nh&#xE9;!</p> <h4>I. C&#xE0;i &#x111;&#x1EB7;t Authentication 2.0</h4> <p>C&#xE0;i &#x111;&#x1EB7;t plugin v&#x1EDB;i composer t&#x1EEB; th&#x1B0; m&#x1EE5;c ROOT c&#x1EE7;a D&#x1EF1; &#xE1;n CakePHP c&#x1EE7;a b&#x1EA1;n (n&#x1A1;i ch&#x1EE9;a t&#x1EC7;p <strong>composer.json</strong> ).</p> <p>T&#x1EA3;i plugin authentication b&#x1EB1;ng c&#xE1;ch&#x2026;</p></body></html>","html":"<p>Chào mọi người, hôm nay chúng ta hãy cùng nhau tìm hiểu về Authentication 2.0 trong Framework CakePHP 4 nhé!</p>\n<h3>I. Cài đặt Authentication 2.0</h3>\n<p>Cài đặt plugin với composer từ thư mục ROOT của Dự án CakePHP của bạn (nơi chứa tệp <strong>composer.json</strong> ).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">    composer require cakephp/authentication:^2.0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Tải plugin authentication bằng cách thêm câu lệnh sau vào dự án của bạn trong <code class=\"language-text\">src/Application.php</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Bootstrap method.\n     *\n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">bootstrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addPlugin</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>II. Cấu hình và sử dụng Authentication để xác thực người dùng</h3>\n<p>Plugin authentication được tích hợp trong dự án với vai trò như một middleware hay một component để giúp việc xác thực người dùng dễ dàng hơn. Đầu tiên, áp dụng nó như một middleware, thêm vào <code class=\"language-text\">src/Application.php</code> một số lớp cần thiết:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>AuthenticationService</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>AuthenticationServiceInterface</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>AuthenticationServiceProviderInterface</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>Identifier<span class=\"token punctuation\">\\</span>IdentifierInterface</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>Middleware<span class=\"token punctuation\">\\</span>AuthenticationMiddleware</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>MiddlewareQueue</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Psr<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Message<span class=\"token punctuation\">\\</span>ServerRequestInterface</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tiếp theo, implements <code class=\"language-text\">AuthenticationProviderInterface</code>vào lớp <code class=\"language-text\">Application</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token keyword\">class</span> <span class=\"token class-name\">Application</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseApplication</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">AuthenticationServiceProviderInterface</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Sau đó, thêm middleware <code class=\"language-text\">AuthenticationMiddleware</code>vào trong phương thức <code class=\"language-text\">middleware()</code> . Hãy chắc chắn đã thêm <code class=\"language-text\">AuthenticationMiddleware</code>trước <code class=\"language-text\">AuthorizationMiddleware</code>nếu bạn dùng cả hai plugin này.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token variable\">$middleware</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthenticationMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Thêm phương thức <code class=\"language-text\">getAuthenticationService</code> vào <code class=\"language-text\">src / Application.php</code>.  Phương thức này sẽ cấu hình cơ bản các tác vụ xác thực của bạn với Authentication.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Get authenticationService.\n     *\n     * @param \\Psr\\Http\\Message\\ServerRequestInterface $request Request.\n     * @return \\Authentication\\AuthenticationServiceInterface\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getAuthenticationService</span><span class=\"token punctuation\">(</span>ServerRequestInterface <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> AuthenticationServiceInterface\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$service</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AuthenticationService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Define where users should be redirected to when they are not authenticated</span>\n        <span class=\"token variable\">$service</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n            <span class=\"token single-quoted-string string\">'unauthenticatedRedirect'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'/users/login'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token single-quoted-string string\">'queryParam'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'redirect'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n            IdentifierInterface<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">CREDENTIAL_USERNAME</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">,</span>\n            IdentifierInterface<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">CREDENTIAL_PASSWORD</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'password'</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Load the authenticators. Session should be first.</span>\n        <span class=\"token variable\">$service</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">loadAuthenticator</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication.Session'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$service</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">loadAuthenticator</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication.Form'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token single-quoted-string string\">'fields'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$fields</span><span class=\"token punctuation\">,</span>\n            <span class=\"token single-quoted-string string\">'loginUrl'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'/users/login'</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">// Load identifiers</span>\n        <span class=\"token variable\">$service</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">loadIdentifier</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication.Password'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">compact</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'fields'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$service</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Đầu tiên, cấu hình những việc cần làm với người dùng khi họ chưa được xác thực bằng <code class=\"language-text\">setConfig()</code>. Tiếp theo, đính kèm <code class=\"language-text\">Session</code> và  <code class=\"language-text\">Form</code> vào authentication  xác định các cơ chế mà ứng dụng sẽ sử dụng để xác thực người dùng. <code class=\"language-text\">Session</code>cho phép xác định người dùng dựa trên dữ liệu trong phiên và xác định thời gian người dùng được giữ đăng nhập trong khi <code class=\"language-text\">Form</code>cho phép xử lý biểu mẫu đăng nhập tại <code class=\"language-text\">loginUrl</code>. Cuối cùng, hãy đính kèm một số <code class=\"language-text\">identifier</code> để chuyển đổi thông tin đăng nhập mà người dùng sẽ cung cấp cho thành một <code class=\"language-text\">identity</code> đại diện cho người dùng đã đăng nhập.\nTiếp theo, tải authentication component trong <code class=\"language-text\">src/Controller/AppController</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Initialize method.\n     * \n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">loadComponent</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication.Authentication'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Theo mặc định, component sẽ yêu cầu một người dùng phải xác thực cho <strong>tất cả các</strong> hành động. Có thể vô hiệu hóa hành vi này trong các controller cụ thể bằng cách sử dụng <code class=\"language-text\">allowUnauthenticated()</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Authentication</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">allowUnauthenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'index'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Ví dụ trên sẽ giúp bỏ qua xác thực người dùng đối với các phương thức <code class=\"language-text\">view</code> và <code class=\"language-text\">index</code> trong controller.\nTheo mặc định authentication sẽ sử dụng model của bảng <code class=\"language-text\">Users</code> trong database để lấy dữ liệu và tiến hành xác thực. Tuy nhiên bạn cũng có thể lựa chọn một model khác để thực hiện việc này bằng cách sử dụng <code class=\"language-text\">userModel</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token variable\">$service</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">loadIdentifier</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Authentication.Password'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>  \n          <span class=\"token single-quoted-string string\">'fields'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span>  \n\t\t      <span class=\"token single-quoted-string string\">'username'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">,</span>  \n\t\t      <span class=\"token single-quoted-string string\">'password'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'password'</span><span class=\"token punctuation\">,</span>  \n\t\t  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token single-quoted-string string\">'resolver'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span>  \n\t          <span class=\"token single-quoted-string string\">'className'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Authentication.Orm'</span><span class=\"token punctuation\">,</span>  \n\t          <span class=\"token single-quoted-string string\">'userModel'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Admins'</span><span class=\"token punctuation\">,</span>  \n          <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  \n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>III. Thử tạo chức năng đăng nhập và mã hóa mật khẩu</h3>\n<p>Khi đã áp dụng middleware authentication, người dùng sẽ cần phải đăng nhập để sử dụng các tác vụ của ứng dụng. Trước tiên, tạo model và controller Users với command của cakephp:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">    bin/cake bake model Users \n    bin/cake bake controller Users</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Sau đó, thêm một phương thức đăng nhập cơ bản vào controller <code class=\"language-text\">UsersController</code>. Nó sẽ giống như:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Login method.\n     *\n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Authentication</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">isValid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$target</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Authentication</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getLoginRedirect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token single-quoted-string string\">'/home'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$target</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">request</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">is</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'post'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token variable\">$result</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">isValid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Flash</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Invalid username or password'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Đảm bảo rằng phương thức <code class=\"language-text\">login</code> đã được cho phép truy cập trong bất kì điều kiện nào để người dùng chưa được xác thực có thể truy cập nó.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Method beforeFilter.\n     *\n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">beforeFilter</span><span class=\"token punctuation\">(</span>\\<span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Event<span class=\"token punctuation\">\\</span>EventInterface</span> <span class=\"token variable\">$event</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">beforeFilter</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$event</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    \n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Authentication</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">allowUnauthenticated</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Bây giờ, chúng ta có thể tạo một template đăng nhập đơn giản trong <code class=\"language-text\">templates\\Users\\login.php</code> để thử chức năng đăng nhập.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>users form content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t  <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n\t  <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">control</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n      <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">control</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'password'</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n      <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">button</span><span class=\"token punctuation\">(</span><span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token delimiter important\">?></span></span>\n      <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>   <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 373px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1e0278712069aa21759b2beef7f8bc22/67a5d/images-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABEElEQVQoz62STU7DMBCFI7HkGqw4BCdhwTWQkDgBEnuOACfgFu0R2KQ0/yFNYsfjx4zttkkxEpUY6VMyL87zjMfJrh/wX6G1RtLtehARlNJQLEzGwHBuzPmMSonh4JKm/UJZ1Ww6ud2stWcxM+wPgqssVDdN5m8Y//RdzgyHcfRtM5qrFI3IYwIun+lLZhVKUjctqrpByew3EZ1f5AAOxM2kQ3M0lKCTMxEzy/SKkHeEjOlGr1EE+WdhaF0lx6CQ3r8DV0/A9TNw94aw1td7Gj8MF1Mj3+Ltq8XFg8Xlo8XNi9diU44azmOfpi2wToEV81GHb79cbBlostkWSD8zJo9S5DnaSshQFllYG2ezzfENTz1XnZxbm2AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"images-2.png\"\n        title=\"images-2.png\"\n        src=\"/static/1e0278712069aa21759b2beef7f8bc22/67a5d/images-2.png\"\n        srcset=\"/static/1e0278712069aa21759b2beef7f8bc22/4edbd/images-2.png 175w,\n/static/1e0278712069aa21759b2beef7f8bc22/13ae7/images-2.png 350w,\n/static/1e0278712069aa21759b2beef7f8bc22/67a5d/images-2.png 373w\"\n        sizes=\"(max-width: 373px) 100vw, 373px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Sau đó, thêm một hành động đăng xuất đơn giản để người dùng có thể đăng xuất ra khỏi ứng dụng trong <code class=\"language-text\">UsersController</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token comment\">/**\n     * Logout method.\n     *\n     * @return void\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Authentication</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Users'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Để đăng nhập, người dùng sẽ cần phải có mật khẩu đã được mã hóa và lưu trong database. Có thể tự động mã hóa mật khẩu khi người dùng cập nhật mật khẩu của họ bằng phương thức <code class=\"language-text\">_setPassword</code> mà authentication hỗ trợ được thêm vào <code class=\"language-text\">Entity</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token keyword\">use</span> <span class=\"token package\">Authentication<span class=\"token punctuation\">\\</span>PasswordHasher<span class=\"token punctuation\">\\</span>DefaultPasswordHasher</span><span class=\"token punctuation\">;</span>\n    \n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Entity</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">/**\n         * Set password.\n         *\n         * @param string $password Password.\n         * @return string\n         */</span>\n        <span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">_setPassword</span><span class=\"token punctuation\">(</span>string <span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$hasher</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DefaultPasswordHasher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token variable\">$hasher</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">hash</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Giờ chỉ cần tạo một phương thức đăng ký đơn giản và đăng ký một tài khoản là có thể thử nghiệm chức năng đăng nhập, đăng xuất với <code class=\"language-text\">Authentication</code> rồi.\nVí dụ template cho việc đăng kí trong <code class=\"language-text\">templates\\User\\sign_up.php</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">control</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'username'</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">control</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">control</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'password'</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">button</span><span class=\"token punctuation\">(</span><span class=\"token function\">__</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Sign up'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span>\n    <span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">Form</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token delimiter important\">?></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>   <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 372px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/59b3f528e714435f3939365f95515241/98b6e/images-3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABXElEQVQ4y61TS07EMAztIWCHuAArxBUREmLFAg6FxAZxAWCGQguaadPvJM7DdkJpRzNSRyLSk1PXefGznaRpO/zX6roeSVW3ICJ0fa+OltH3Gzj2OXcAOL7l5JiwUcKiLLEuSqwYpqr1Ru/9bAyEddOqg8hHG2601s2DC1bOtV0kVMn8IfWUACEXX7BzQIFQJTOhZGSMUbkbaw+SuleyQBbFn7Ml2y3JVZRcc3OEvG4a7bbWU8k9bITsaU+Gf5Lj2JSmQiEojRLrQfZzzhN4T0PNxpCyDZJ1REYDGm4lrifh+YPw8EZ4XBCeUkJvd5PKmaHL2zNHsZ4vK+D0Bji5Bo4ugeMr4HWNWOtpArImhJhkGOyyAM7vgIt74Ow2YFFMY8ZLXlkir4K0qzYMaYRjbLh7uXFYrh3SwiEzwefcaKjjXnySXJJm33j/zBlf0U6R5TnyCNnvivlFmn3hB/86QSauw8W2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"images-3.png\"\n        title=\"images-3.png\"\n        src=\"/static/59b3f528e714435f3939365f95515241/98b6e/images-3.png\"\n        srcset=\"/static/59b3f528e714435f3939365f95515241/4edbd/images-3.png 175w,\n/static/59b3f528e714435f3939365f95515241/13ae7/images-3.png 350w,\n/static/59b3f528e714435f3939365f95515241/98b6e/images-3.png 372w\"\n        sizes=\"(max-width: 372px) 100vw, 372px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>IV. Kết luận</h3>\n<p>Việc sử dụng Authentication để thực hiện các chức năng đăng nhập, đăng xuất là điều khá cơ bản và dễ dàng. CakePHP cũng hỗ trợ nhiều các phương thức đăng nhập nâng cao khác như xác thực với token, jwt, ...Chúng ta sẽ tìm hiểu về những phương thức này trong các blog sắp tới nhé!</p>\n<h6><em><div style=\"text-align: right\"> - [Phu Thai | Đồng Phú Thái] </div></em></h6>","id":"7b8212c3-b914-5137-9621-a12d48a449ec","frontmatter":{"title":"Authentication basic CakePHP 4","date":"06-11-2020","tags":["php","cakephp"]},"fields":{"slug":"/authentication-basic-cakephp-4/","readingTime":{"text":"6 min read"}}}},{"node":{"excerpt":"Xin chào các bạn! Hiện tại Laravel đã update version lên Laravel 8.x. Vậy nên mình muốn giới thiệu một thay đổi tuy cơ bản nhưng vô cùng đặc biệt tại phiên bản này. Đó là authentication basic, chúng…","snippet":"<html><head></head><body><p>Xin ch&#xE0;o c&#xE1;c b&#x1EA1;n! Hi&#x1EC7;n t&#x1EA1;i Laravel &#x111;&#xE3; update version l&#xEA;n Laravel 8.x. V&#x1EAD;y n&#xEA;n m&#xEC;nh mu&#x1ED1;n gi&#x1EDB;i thi&#x1EC7;u m&#x1ED9;t thay &#x111;&#x1ED5;i tuy c&#x1A1; b&#x1EA3;n nh&#x1B0;ng v&#xF4; c&#xF9;ng &#x111;&#x1EB7;c bi&#x1EC7;t t&#x1EA1;i phi&#xEA;n b&#x1EA3;n n&#xE0;y. &#x110;&#xF3; l&#xE0; authentication basic, ch&#xFA;ng ta c&#xF9;ng t&#xEC;m hi&#x1EC3;u xem n&#xF3; kh&#xE1;c g&#xEC; so v&#x1EDB;i c&#xE1;c&#x2026;</p></body></html>","html":"<p>Xin chào các bạn! Hiện tại Laravel đã update version lên Laravel 8.x. Vậy nên mình muốn giới thiệu một thay đổi tuy cơ bản nhưng vô cùng đặc biệt tại phiên bản này. Đó là authentication basic, chúng ta cùng tìm hiểu xem nó khác gì so với các phiên bản trước nhé!</p>\n<h1>Bước 1: Cài đặt project Laravel 8.x</h1>\n<ul>\n<li>\n<p>Chạy câu lệnh cài đặt project laravel:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">composer create-project laravel/laravel projectLaravel --prefer-dist</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Tuy nhiên nếu bạn muốn cài đặt đồng thời Jetstream thì hãy bổ sung --jet vào sau tên project laravel của bạn trong câu lệnh trên <code class=\"language-text\">--jet</code>. VD: </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">composer create-project laravel/laravel projectLaravel --jet --prefer-dist</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Hoặc bạn có thể cài đặt project laravel xong sau đó chạy câu lệnh <code class=\"language-text\">composer require laravel/jetstream</code> để cài đặt Jetstream sau.</p>\n<h1>Bước 2: Setup Database</h1>\n</li>\n<li>Bạn hãy tạo 1 database mysql bất kỳ sau đó mở file <code class=\"language-text\">.env</code> lên và cấu hình kết nối project tới database:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 358px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ba95f077f46fd21ba4b561fa12560a61/39185/env.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 45.714285714285715%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABRUlEQVQoz3VQ2Y6DIBT1OyoqFqxiM6WtoGwqWrVPM/P/fzNXO1tmOQnJJXDuWYIkSUrG4ihO94AUkFFKCIELpRSu+APxLwRwDocsDJGQdds5IeqX59dluXPOp3kZRz/ebl3vtWriKPpJpjQ7HsswDC/XyliltbHGPp14LSvg101jtIYBDP6hvJJLBuSqEq61zraD96cTN0ZbaxkrWVFADoS+ZKMPC8Ge0Dw/gO3rtXLOyroZ+n4jWz94jEESJxg/+oCZEAozMOEhIDRjrPhUBtPGutsyO9cKKZQxzpphHGUjIXaj1DwtUlQhQlBhAJuKPN+UgWxEXfd9d1+maZqllPC9cy7LMpymEJBQijczD6zK5aqMVmVnwLbv+3EcoHApRF4Ux7JMtpzv+F4YZN5sI87PWitYoZTuus4Pw+V83u124DD+B2+t2VnlTbpAEwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"env\" title=\"env\" src=\"/static/ba95f077f46fd21ba4b561fa12560a61/39185/env.png\" srcset=\"/static/ba95f077f46fd21ba4b561fa12560a61/4edbd/env.png 175w,\n/static/ba95f077f46fd21ba4b561fa12560a61/13ae7/env.png 350w,\n/static/ba95f077f46fd21ba4b561fa12560a61/39185/env.png 358w\" sizes=\"(max-width: 358px) 100vw, 358px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n</ul>\n<h1>Buớc 3: Migration</h1>\n<ul>\n<li>chạy câu lệnh <code class=\"language-text\">php artisan migrate</code> để tạo các bảng ban đầu vào database\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c9e04093c37126bc26c5883b07df6ce4/7321b/migration.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABSklEQVQY0zWRW3KjMBBFWcaUMeAAKduxQIinxSNgiONkJrP/5ZxpyOSjq6Vu3dNXkqPKgrSsJAy6Liltw8kk/PJddoGHGwa48QHX2+O6UpNw93t83+dw8AjkzLoOAn/Ljnl7Jh8j1FVTTC2qMai+ovtYqOaBpCvRQ4Muc9RFkec5l5cX9gINggDP+wb9hJMMEdo+kemE1/6VuqpoqprH45PbNFOJe9tcsdbSXK90XUdd12SZYRhGtNbsdrttwBqOmZ8xQ0hRZMzLsolWweefL+6Pj23f94OIB+7v79iuFWhPI0Nu0w0r/SgSUzLgfD6vwJhcgHmhuc0LrTiwbcvvr78sb/f/rnpaqU3TSC/gVtyO44gx35AkSTmdzoRhiOOnMYdLxPF4xMj7pGkqBxJqcZAXBUopUhGsOcsyMoGk0l+v+tNb3cVxtH3aP5gMuuo9xAVxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"migration\" title=\"migration\" src=\"/static/c9e04093c37126bc26c5883b07df6ce4/8c557/migration.png\" srcset=\"/static/c9e04093c37126bc26c5883b07df6ce4/4edbd/migration.png 175w,\n/static/c9e04093c37126bc26c5883b07df6ce4/13ae7/migration.png 350w,\n/static/c9e04093c37126bc26c5883b07df6ce4/8c557/migration.png 700w,\n/static/c9e04093c37126bc26c5883b07df6ce4/e996b/migration.png 1050w,\n/static/c9e04093c37126bc26c5883b07df6ce4/7321b/migration.png 1184w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n</ul>\n<h1>Bước 4: Cài đặt Jetstream</h1>\n<ul>\n<li>Chạy câu lệnh <code class=\"language-text\">composer require laravel/jetstream</code> để cài đặt, nếu bạn nào đã cài ở bước 1 thì bỏ qua bước này nhé\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/cc265d6de04bb04c254c2c0f3e46a9d3/7321b/jetstream.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 83.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACv0lEQVQ4y4VU2ZKbMBDkOwwS2GAMkrhvxGFnN/n/P+qMhHcTb+V46JJUJVo909M4QgjsjwfmRaOfBmRdhW4cUCwdMt2h0D3O6gbGGLh3IPBp5fwFjJmVweFxiGAp4PcKfJBw6xt4J+B2KdyJzioCU1dwEYHfQvCUzucAnB5gX2CIHXOZrTkYkTGdgfcSvDxIDRjBm/NjzeluRuQXH4yU+r7/AkPqeCQzrXL0ekKnR/iDApsOtWxUuBDRbUoQNhLJWKKZFao6QVlWhBJJmkIphTiOn4Sui0xl2NcN27bBnzKwhZTSGg8Jiv4GPQlMc49x0lio123b2G8ulws8dig9+mgIPQ8qy7AuK9Z1pV5Kq9CUGDQp8iFGP8boupIe1BjGichn1HWDMAw/S/0wx3FJoSE06vZ9h69z6pmCNwjb0/NMxLSXZNK6RujJPK0Xur+jbhoMw4gkSWB4rELjVlPWeNsfeGx3RGOB8F4jWityv0K/SHooRt21eH9/x/2+QS+LFXC9XhFGEaIngiCAE2Up5NpB6hbJUODW5khzBVHmiNIbZKGgpEBKKvK8QJr+2gshIaS0Cquqtg84fhJBbT3USiDSYqOhHluUNNDl1EM2BaRU9iMTAkmOFkVhyzNlGg8MTqeTXR2ZSvx4+46V+nInp7/dH2iXESURm6QIMkOSqjOVY0wwzpryPpz9CifLcuvarLWFabZXxDjRqNikmMRcAzAaZquGHYo+nP3d4Sdh9kmmCft+R1Am4OQ0p8HmM83k9QIe+DZur/llf1J4EI7zZAmNQp8ITRRtWkz8LoGN2r+IXkpeZlI3zXa4H9sDfpEc8RuJMIvBzzS8T6K/lfpJGMobxEbN1w3EWCGbO1sqMyW34tj3tJo/DBFz/z8KWRLCHckASoO7KLhNYgns34f6Z0rm5kwxtH+j69mWz/5C+BN1DPeO+pVHJgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"jetstream\" title=\"jetstream\" src=\"/static/cc265d6de04bb04c254c2c0f3e46a9d3/8c557/jetstream.png\" srcset=\"/static/cc265d6de04bb04c254c2c0f3e46a9d3/4edbd/jetstream.png 175w,\n/static/cc265d6de04bb04c254c2c0f3e46a9d3/13ae7/jetstream.png 350w,\n/static/cc265d6de04bb04c254c2c0f3e46a9d3/8c557/jetstream.png 700w,\n/static/cc265d6de04bb04c254c2c0f3e46a9d3/e996b/jetstream.png 1050w,\n/static/cc265d6de04bb04c254c2c0f3e46a9d3/7321b/jetstream.png 1184w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n</ul>\n<h1>Bước 5: Cài đặt Liveware hoặc Inertia</h1>\n<ul>\n<li>Chạy câu lệnh <code class=\"language-text\">php artisan jetstream:install livewire</code> để cài đặt\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1a0ebf656a66b6aa1815691fb4bed3ff/e6c84/liveware.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACOUlEQVQ4y32U6XKjMBCE/Rq7CGFuMMbmRuKM7bz/K/W2IEnZW0l+dI0so08zQw+HMI4x3Vb0g0Y/DqjbBp1W0POEsipxOp1wPudbTNMUUkrYtv0Sn3XIThnWZaUW3G43tE2LQWss04xhGHC/36EUL+sVrkUBz/N+hG1Ax3H4YImZAM2DSinUTYO261CWJa7XK875BeM4oq4bqkaaJBBCfA80pSzrinmeMX1A66pGx0zLa4GYLQmCYItGYRR9C/oCxnHCUu+ETVhY9vLGft4mtG8TLn2Ny+WCKAw3WMIemviZ3fc9zM4EreyXxuPxQN13+KNOEGMOoTOIxIM4SghLwLKsX2EfJWcsd9mB9wca1cPqT5BDDkmoTANI5/XQT7AdyAxnlqo/gZpAZijVGbamQr5VYcM2Bwj6DfZV8soMR1rl/f6O9jNDzez6DNJ1CJK/Ql6A0SlFNSkUioaeB+R8EX8H9k5RTQpxjSAc+0ebPLfB6OBHIYqhQz0aaIu8KVGz7Ep1e9QdCvrRGP54dGARbA6aC571Min39Q2ak7Cw9GkYGeetDbOxEr1pJmhzAs3d9/1m+IpeNZOk9bBNUZZl2xQdoihGVTOz/IqiapDTzEfXx9Hz4XoBXD+kGLnneRE88x/l+xF8L6TpIwS+/1yyg6T1EBcu4tpD1PhIGRPq3HGPv+PSRRQJZGeLxhb8UAhGa9sLw/9Kdl3JSbARBpKyeRvX4R73fa4p35eIE8k1nwt3mbXZ32G7nf4Beka6zXBRbb4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/1a0ebf656a66b6aa1815691fb4bed3ff/8c557/liveware.png\" srcset=\"/static/1a0ebf656a66b6aa1815691fb4bed3ff/4edbd/liveware.png 175w,\n/static/1a0ebf656a66b6aa1815691fb4bed3ff/13ae7/liveware.png 350w,\n/static/1a0ebf656a66b6aa1815691fb4bed3ff/8c557/liveware.png 700w,\n/static/1a0ebf656a66b6aa1815691fb4bed3ff/e996b/liveware.png 1050w,\n/static/1a0ebf656a66b6aa1815691fb4bed3ff/e6c84/liveware.png 1148w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n<li>sau đó chạy câu lệnh <code class=\"language-text\">run npm install &amp;&amp; npm run dev</code> để build các JS và CSS cho ứng dụng của bạn, thành công sẽ có thông báo:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/3b26596c67694b7c3500088dd3d71401/fd84e/npm-success.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 12.571428571428573%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAuUlEQVQI1z3OwU6DQBhFYR6DZJh/GMOMArYNI7ZSUgZqF60r48ra93+OIyXRxbe8NyfZhIZhGtGisfaBGCPOOQ7DwDhGxAjK6IUWwzRN9H3P8f1EXVekaUqWZSilFon7Gng673F1SffWcZwHIbzwff3hdr1RdBvkc08+s68r4iHycTnTNGEOsGitEZF/id7WqGeH2JyyrPDeUcyFbduy2+7IK4+0FRJK5LHAO896vSI3Zim6n9xP//wCozha2O0rFzcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/3b26596c67694b7c3500088dd3d71401/8c557/npm-success.png\" srcset=\"/static/3b26596c67694b7c3500088dd3d71401/4edbd/npm-success.png 175w,\n/static/3b26596c67694b7c3500088dd3d71401/13ae7/npm-success.png 350w,\n/static/3b26596c67694b7c3500088dd3d71401/8c557/npm-success.png 700w,\n/static/3b26596c67694b7c3500088dd3d71401/e996b/npm-success.png 1050w,\n/static/3b26596c67694b7c3500088dd3d71401/fd84e/npm-success.png 1056w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n</ul>\n<h1>Bước 6: Tiếp tục migrate các migration mới</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">php artisan migrate</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ea45dad9746bf844c3382f4e4e115aeb/5bd27/migration-2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 22.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA3UlEQVQY0zWPa26DMBCEuQivxgWjGjAE29gYDApB7f0PNN1YyY/RrGal2W+TdZNwvoPWI5xbooQQEG0H3nDUdQ3OOaq3c96gqhjlFRpOGXmeZ6QcWZYhkRtD778gxwbOekzThGVZcD4vWGujZmOglIrz66DSGoYyZx3GYYjH2q4DYwyJvmqoJ4MyAiEc0Ebj8Thx/f7Fgn3fsYWNdgHee1jnqNTRRwYLlXdU1PcyeiTsD442fEPef3AcJ8w8wxFhCHukeNF+yFa/QhOpEC2G8U5Et/hqWZYoigJpmuIfeWV+wr/rvZgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/ea45dad9746bf844c3382f4e4e115aeb/8c557/migration-2.png\" srcset=\"/static/ea45dad9746bf844c3382f4e4e115aeb/4edbd/migration-2.png 175w,\n/static/ea45dad9746bf844c3382f4e4e115aeb/13ae7/migration-2.png 350w,\n/static/ea45dad9746bf844c3382f4e4e115aeb/8c557/migration-2.png 700w,\n/static/ea45dad9746bf844c3382f4e4e115aeb/e996b/migration-2.png 1050w,\n/static/ea45dad9746bf844c3382f4e4e115aeb/2cefc/migration-2.png 1400w,\n/static/ea45dad9746bf844c3382f4e4e115aeb/5bd27/migration-2.png 1432w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<ul>\n<li>Sau đó chạy ứng dụng <code class=\"language-text\">php artisan serve</code>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e053067ab60f0c25bce72aaa092c4fb6/ae28e/serve.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 8%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAeklEQVQI1yXIaxKCIABGUfcRZDaIQwKhgJqOuv9VXal+nPkelcsDLhUldei56QbZPZGqQbQNqm3RWqOUKr5d4b2jftTcpUBK+Ush/qo+B8z4xk8jdhqI58qwzdgY6IIl54l9PziOk5Qy87LwWTdiTDjnCo8xr7IjY/kueEI8W4qlMfcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/e053067ab60f0c25bce72aaa092c4fb6/8c557/serve.png\" srcset=\"/static/e053067ab60f0c25bce72aaa092c4fb6/4edbd/serve.png 175w,\n/static/e053067ab60f0c25bce72aaa092c4fb6/13ae7/serve.png 350w,\n/static/e053067ab60f0c25bce72aaa092c4fb6/8c557/serve.png 700w,\n/static/e053067ab60f0c25bce72aaa092c4fb6/e996b/serve.png 1050w,\n/static/e053067ab60f0c25bce72aaa092c4fb6/2cefc/serve.png 1400w,\n/static/e053067ab60f0c25bce72aaa092c4fb6/ae28e/serve.png 1598w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n<li>Truy cập vào <a href=\"http://127.0.0.1:8000/\">http://127.0.0.1:8000/</a> trên trình duyệt của bạn\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.42857142857144%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABD0lEQVQoz3WRyW7DMAxE/f9/2OYQ5FQjseJIlrhoc0dyEhhOa7zDiOaQA3DQmJZAs10CSyDAHQms/yDG8uzCzzgOFDPHLKkwqCuvHehe/xNJGS6KZWjvVMgHOp/5cqHTyX99B+cJxdbR5jahmyHTbsrwVKI8z36a2JhobYwp1TXmtp9EIVKpG7oLNbySFIQZr+bhvMIjSiQ5Z0y5TcZ7YhFmFdFSivYsOzOGl8oSEb+1sgKU1nVFCOxu0VhVY631aG5+VWPuzIIpG60Pt1g8vtLfpX8fm1NByIddnPNuCSEwYmMnLJN5XG/mPlvrPPA41+dmNHNM+LERc31rTe08myZNgI9mHONVPZxkz7sH/AK/kUXNwylpbgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/b2c0050e99607894903267b012ac638b/8c557/laravel.png\" srcset=\"/static/b2c0050e99607894903267b012ac638b/4edbd/laravel.png 175w,\n/static/b2c0050e99607894903267b012ac638b/13ae7/laravel.png 350w,\n/static/b2c0050e99607894903267b012ac638b/8c557/laravel.png 700w,\n/static/b2c0050e99607894903267b012ac638b/e996b/laravel.png 1050w,\n/static/b2c0050e99607894903267b012ac638b/2cefc/laravel.png 1400w,\n/static/b2c0050e99607894903267b012ac638b/8bf8a/laravel.png 1901w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span></li>\n</ul>\n<h1>Bước 7: Test Feature</h1>\n<ul>\n<li>Click vào register góc phải trên màn hình, điên đầy đủ thông tin để đăng ký 1 tài khoản\n<img src=\"/register.png\" alt=\"liveware\"></li>\n</ul>\n<p>Sau khi đăng ký thành công, sẽ điều hướng bạn tới trang Dashboard:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/c4a647a31f731c52d9006af4762e2676/9c177/dashboard.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 61.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABRklEQVQoz5VQ127EMAzL//9me72et7xHnJTyDaAvHQIjCFJoitrO87R0UJhjP/8bWx89lxyCn6Dv/I2x9z5a79/QgNpaWfmBzYeEkbHH+6VYo60lIl9KnfPAKz+gtg5yHqM7Ot4uUambMcZaW3Ke8xcb4G8h5tbG3LuxyhE567QxUiuldEP0Xmt7BjZvtXLjPI8Xuc85Y8oxpWfmIsQUQuRIXIRVgLvv+0M5pgLgP0c+pbykFhprAh60ELnPnc635BVw5srKKVdL4XIV15sSUktlhNJSGx9T68NR/LiKT6EVX9NbR8Y6vPgiQ7w5KkQoaq4NgwJnfUAJ2zjKlliDxRceymvt7CiQDyCkUtBNQOaitE4hKmPvUmjeseqnMpg3qaS2QuHURq4MTmHPCSMYYS9wJDWAA0F1Y8POC4ylugl5L/4CbdwXmqayjfKaMdAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/c4a647a31f731c52d9006af4762e2676/8c557/dashboard.png\" srcset=\"/static/c4a647a31f731c52d9006af4762e2676/4edbd/dashboard.png 175w,\n/static/c4a647a31f731c52d9006af4762e2676/13ae7/dashboard.png 350w,\n/static/c4a647a31f731c52d9006af4762e2676/8c557/dashboard.png 700w,\n/static/c4a647a31f731c52d9006af4762e2676/9c177/dashboard.png 880w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></p>\n<ul>\n<li>Test thử tính năng login với tài khoản vừa tạo, logout tài khoản rồi click vào login sẽ thấy form login như sau:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 557px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 87.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsSAAALEgHS3X78AAABzElEQVQ4y42TTYvUQBCG8wP1JnjXw/4B9+TFiwcRPK14EjyIB714EUEE9+BdV3EYxBlYZ8fZfGzSX1WddFcnVk9GGDLJYvHQaZJ6u+tNVycG7CHa2MbZrrOAcT6awySjyrq2Pxf47iMKadFO6pPxVY09fgBH9+DbDKe2nRQD2JPn+PgpfPqMdXPtzoD1UIxxXJ5bpXfzcbHzni0658JBdF3/bAdwNM5pg4knKiqpoQ5tR6HzFMd+4ojHdoDzLWd676OYQvs7NV/n69ky//7r8my+/jJbMT8W6WyRrbLmTxn2uSioMoGI1FYcpPFpCbmwWYl5xSNcFjqvsBBWGJIQ9uE3tml5Z9WXrbVG/r+Wu+J/w+3KppCV9nwjL1KdCXelA1Oo0E8OyRUZG3Y7s+dVqtnq2Xy13JhMdZsqXMO6JAF7nlnfOO881XVTNw2fReQgYiYFtsmn9a/s7QeldSWkkMoA8DFOWY1LEO15js0wDM4QQkpeUhte8aqsWPbi5Zsbt+7cvH330ZNnnCOkGRfHWrZKbYxUqqoEO3n/4fT4/kPm1eu3nMNVJsbgCIBoa8QtNsJH6Zzv29N70gZib/ONmQAHSAVCsQuuBfqL8RdQmQBXNSlGgwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png\" srcset=\"/static/1cb417fcc0da394477005c104ae0de56/4edbd/login.png 175w,\n/static/1cb417fcc0da394477005c104ae0de56/13ae7/login.png 350w,\n/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png 557w\" sizes=\"(max-width: 557px) 100vw, 557px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></li>\n</ul>\n<p>Login thành công cũng đưa bạn đến trang Dashboard, click vào profile tại menu góc màn hình\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 557px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 87.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsSAAALEgHS3X78AAABzElEQVQ4y42TTYvUQBCG8wP1JnjXw/4B9+TFiwcRPK14EjyIB714EUEE9+BdV3EYxBlYZ8fZfGzSX1WddFcnVk9GGDLJYvHQaZJ6u+tNVycG7CHa2MbZrrOAcT6awySjyrq2Pxf47iMKadFO6pPxVY09fgBH9+DbDKe2nRQD2JPn+PgpfPqMdXPtzoD1UIxxXJ5bpXfzcbHzni0658JBdF3/bAdwNM5pg4knKiqpoQ5tR6HzFMd+4ojHdoDzLWd676OYQvs7NV/n69ky//7r8my+/jJbMT8W6WyRrbLmTxn2uSioMoGI1FYcpPFpCbmwWYl5xSNcFjqvsBBWGJIQ9uE3tml5Z9WXrbVG/r+Wu+J/w+3KppCV9nwjL1KdCXelA1Oo0E8OyRUZG3Y7s+dVqtnq2Xy13JhMdZsqXMO6JAF7nlnfOO881XVTNw2fReQgYiYFtsmn9a/s7QeldSWkkMoA8DFOWY1LEO15js0wDM4QQkpeUhte8aqsWPbi5Zsbt+7cvH330ZNnnCOkGRfHWrZKbYxUqqoEO3n/4fT4/kPm1eu3nMNVJsbgCIBoa8QtNsJH6Zzv29N70gZib/ONmQAHSAVCsQuuBfqL8RdQmQBXNSlGgwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"liveware\" title=\"liveware\" src=\"/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png\" srcset=\"/static/1cb417fcc0da394477005c104ae0de56/4edbd/login.png 175w,\n/static/1cb417fcc0da394477005c104ae0de56/13ae7/login.png 350w,\n/static/1cb417fcc0da394477005c104ae0de56/30d00/login.png 557w\" sizes=\"(max-width: 557px) 100vw, 557px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></p>\n<p>Tại đây chúng ta sẽ thấy phần cập nhật Profile:</p>\n<ul>\n<li>Ảnh Profile (max: 1024KB)</li>\n<li>Sửa tên, email.</li>\n<li>Đổi mật khẩu</li>\n<li>Bật bảo mật 2 lớp</li>\n<li>Browse sessions</li>\n<li>Xoá tài khoản, bạn cần setup mail để confirm việc này:</li>\n</ul>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/afa7deed1fbf2ed5fef30971412b759a/898f6/mail.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 44.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABn0lEQVQoz3VS2VLCQBDkO6xSQc6gMZAIOYgJJJuTkCAEL+TJ8kH//72dXSCKVT507ezOTm/P9NZU7QbdXgOK0gULp9BGCtqdS7S7dTRb5+jQyvMcPN7v67/ixklcuxvdoiddIYpnSLMA2SJEMvfhTXTEiYdbpVcV7Iuu/nlkH1eE6ZwhjKZYPqTImIc8juAHDnzfhkcwTJXyLixrBEs3kKQegsAFY/dwHB2mpaHVvvghTFJfEGZ5iDwMEVgxBso1buQOlIGEwbAPqd8UdyWpif51q8LxvFLI5XKFERHOqe2X7RrPmwKJ59AYGPI8xnRmCQV/Wz0dB81Qu5NFwBXyOXLCx6clyvUCkWujILJ7V0e9cSbM4kZxcPLj+vuh2misCLncAN5ysUwPxjBsyhzMNqFpctW2bgzFPPnv4LVckEp58TMItbE+EISrVYqynGO7XWG3K/H+/ord8wPeCE+bDK90/vn1gaKIkCQumWUiDG0yZiJiVZUEKlMmtobZzIDnmXTJpvZdOIYKJgoswoTGEWNIRbLcpH9LZintAzoV4TfH0SVDIimhQwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"mail\" title=\"mail\" src=\"/static/afa7deed1fbf2ed5fef30971412b759a/8c557/mail.png\" srcset=\"/static/afa7deed1fbf2ed5fef30971412b759a/4edbd/mail.png 175w,\n/static/afa7deed1fbf2ed5fef30971412b759a/13ae7/mail.png 350w,\n/static/afa7deed1fbf2ed5fef30971412b759a/8c557/mail.png 700w,\n/static/afa7deed1fbf2ed5fef30971412b759a/898f6/mail.png 798w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span> \n<p>  Nhập email để confirm:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 542px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/45512bd5b096a6a6e8efab583afc0fce/c0388/input-mail.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 78.85714285714285%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQoz41TTW/TQBDNH+RWoSJyKKQHhJoUqlTAARDkhHqq4MQPQBxAHCpxAYGExA0KrUoBCRHlw3FiOx9er3fW8a6Xt44BN6USq6fR29l5s7PJc4XHtISIE0lKEooFnT4to3JaKYhGHu08Ek+eC6WIRf8tRqnS9Pa9WKnFu4/jH20hE9vx3+KIizJYJAQJxxVPX8TP9uLBSGAhWa75KxZSEpqXICiZzxOt5zKxBNulAqKkECuVxkKggbRZLIk3C5Kco61N4mZ0AUEr7DGYUgocI1Q4551uz/MDd+SNfN91hyPPB7F8OMQGCURnYE+GHgrHWmu5EEece74/nszGkykOgvEE0QuCaRjO5yluSFUKAiyWUtoYg0GsGGNjzEwrk+lFNFmWwxadtQox43IQMFKGtJG6iBLbFMjixIiTQCbVBj+AFQeROTh2Do96X74NPh229w/aH456H4/7n7+7+1/dbqA7vvqDrq9+eqnPNJ6R30ym67Bef+oMwr4zc1zWcSMvVIDPVCgNMMsjwBLLMVdxc/kleGkes9aDhxvN243tu9dv3N+6CbQaTfB79ead9avbr968Q1nIeKUQ5bosj/gntm61VqpXVtc2Ll7erNY2q+vXLqzVq7XG6qX6ufO1vZevC7F140nAJ3CWNQ4MI3JQzvO4cAvPTbrs7bKBozM+Jvbb3r8AgZhw5BZ9a4AAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"input mail\" title=\"input mail\" src=\"/static/45512bd5b096a6a6e8efab583afc0fce/c0388/input-mail.png\" srcset=\"/static/45512bd5b096a6a6e8efab583afc0fce/4edbd/input-mail.png 175w,\n/static/45512bd5b096a6a6e8efab583afc0fce/13ae7/input-mail.png 350w,\n/static/45512bd5b096a6a6e8efab583afc0fce/c0388/input-mail.png 542w\" sizes=\"(max-width: 542px) 100vw, 542px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span> </p>\n<p>  Sau đó sẽ có 1 mail gửi về cho bạn để hoàn thành thao tác này:\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/ca56730c5dbe9b7f3884ba462040776f/9c177/confirm-mail.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 65.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAABOElEQVQoz42SSU7EMBBF+/4XYMGWDQt2HAY20Ew9JLHjqewqj5SbqKVGooP1ZCVOff1KfW9aa8ZYIcQ8z1JKpZS1Nufc/rE2r0/Pw/EoZyWEhGX5XEptra6K0QcLqCEaHxWQBuJdOQbnBRoVvO3G7efx5ePwvp+kxfnEprcN/DlMOkzmAunQegRMgbIB7LjuxK+MC3ERs1KYC/jEeOJxWAtE8TwFfogxlVL4166JNSCXIkXGOb/bD8MoMotKabWmfEVsggKslcv64LbvXze3d/cPj+cWroq7M3VnpIBElLhRtk2pR1FXnE9i75EbPul78/RDTDHldXGMuZdybS6/Ql4Xs5tx3kHQxgsVRulHGaa5w2mtReXSbgiHCbVNBjLv2nUsJI7vTzHD18tT9v2SJEqZs15IHT7/Bphx7KgG8NzwAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"confirm mail\" title=\"confirm mail\" src=\"/static/ca56730c5dbe9b7f3884ba462040776f/8c557/confirm-mail.png\" srcset=\"/static/ca56730c5dbe9b7f3884ba462040776f/4edbd/confirm-mail.png 175w,\n/static/ca56730c5dbe9b7f3884ba462040776f/13ae7/confirm-mail.png 350w,\n/static/ca56730c5dbe9b7f3884ba462040776f/8c557/confirm-mail.png 700w,\n/static/ca56730c5dbe9b7f3884ba462040776f/9c177/confirm-mail.png 880w\" sizes=\"(max-width: 700px) 100vw, 700px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span> </p>\n<h2>Kết luận</h2>\n<ul>\n<li>Chúng ta đã tim hiểu sơ bộ về sự thay đổi của Authentication Laravel tại version 8.x. Sự thay đổi này của Laravel 8.x rất hợp lý và tích hợp + hỗ trợ thêm rất nhiều cho authentication so với các phiên bản trước, vẫn đảm bảo được việc dễ dàng cài đặt và sử dụng cho develop.</li>\n</ul>\n<h2>Tài liệu tham khảo</h2>\n<p><a href=\"https://laravel.com/docs/8.x/authentication\">https://laravel.com/docs/8.x/authentication</a></p>\n<p><em>by Ngọc Quân - Tomosia Việt Nam</em></p>","id":"2ee16996-5468-53a8-a56d-6fd476cc4629","frontmatter":{"title":"Authenticate Laravel 8.x basic (Register and Login)","date":"06-11-2020","tags":["php","laravel"]},"fields":{"slug":"/auth-register-and-login-laravel-8.x/","readingTime":{"text":"3 min read"}}}},{"node":{"excerpt":"Bài viết này mình sẽ giới thiệu các cách định nghĩa routing hay dùng khi làm việc với CakePHP 4. Các routing được định nghĩa trong file config/routes.php. Cakephp 4 sử dụng class  để mapping URL với…","snippet":"<html><head></head><body><p>B&#xE0;i vi&#x1EBF;t n&#xE0;y m&#xEC;nh s&#x1EBD; gi&#x1EDB;i thi&#x1EC7;u c&#xE1;c c&#xE1;ch &#x111;&#x1ECB;nh ngh&#x129;a routing hay d&#xF9;ng khi l&#xE0;m vi&#x1EC7;c v&#x1EDB;i CakePHP 4. C&#xE1;c routing &#x111;&#x1B0;&#x1EE3;c &#x111;&#x1ECB;nh ngh&#x129;a trong file <strong>config/routes.php</strong>. Cakephp 4 s&#x1EED; d&#x1EE5;ng <em>class</em> <code class=\"language-text\">Cake\\Routing\\RouterBuilder</code> &#x111;&#x1EC3; mapping URL v&#x1EDB;i controller action.</p> <h4>1. &#x110;&#x1ECB;nh ngh&#x129;a routing &#x111;&#x1A1;n gi&#x1EA3;n</h4> <p>&#x110;&#x1ECB;nh ngh&#x129; 1&#x2026;</p></body></html>","html":"<p>Bài viết này mình sẽ giới thiệu các cách định nghĩa routing hay dùng khi làm việc với CakePHP 4. Các routing được định nghĩa trong file <strong>config/routes.php</strong>. Cakephp 4 sử dụng <em>class</em> <code class=\"language-text\">Cake\\Routing\\RouterBuilder</code> để mapping URL với controller action.</p>\n<h3>1. Định nghĩa routing đơn giản</h3>\n<p>Định nghĩ 1 routing lấy tất cả các bài viết</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'index'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Giờ khi truy cập vào url <code class=\"language-text\">/articles</code> sẽ mapping đến method index trong controller Articles.</p>\n<h3>2. Truyền tham số cho action</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// routes.php</span>\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/articles/{id}'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setPass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setPatterns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'\\d+'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Viết ngắn ngọn hơn</span>\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/articles/{id}'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'\\d+'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'pass'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// src/Controller/ArticlesController.php</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">view</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Some code here...</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Với khai báo này ta đã validate {id} trên url bắt buộc phải là số và khi truy cập vào url <code class=\"language-text\">/articles/{id}</code> mapping với controller Articles action view và tham số id trên url sẽ là đối số $id của action view.</p>\n<h3>3. Đặt tên</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// Đặt tên cho route dùng hàm connect.</span>\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/login'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Users'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'login'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'_name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'login'</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Đặt tên khi sử dụng specific route</span>\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/logout'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Users'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'logout'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'logout'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>4. Gom nhóm route</h3>\n<p>Code chưa gom nhóm</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'index'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/articles/{id}'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'\\d+'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'pass'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Code sau khi gom nhóm</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'index'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n    <span class=\"token single-quoted-string string\">'/{id}'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'\\d+'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'pass'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Gom nhóm và set sub namespace cho controller</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/admins'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'prefix'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Admins'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'index'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n      <span class=\"token single-quoted-string string\">'/{id}'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'view'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'\\d+'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'pass'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Việc gom nhóm sẽ giúp code không bị lặp lại và quản lý code dễ dàng hơn</p>\n<h3>5. Matching Specific HTTP Methods</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// route này cho mapping với POST request.</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\n        <span class=\"token single-quoted-string string\">'/'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'store'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// route này cho mapping với POST hoặc PUT request.</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n        <span class=\"token single-quoted-string string\">'/{id}'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span>\n            <span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token single-quoted-string string\">'action'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'edit'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">setMethods</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'POST'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'PUT'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Phần này giúp validate http request đến controller action, có thể chỉ cho phép 1 phương thức HTTP hoặc nhiều.</p>\n<h3>6. Route middleware</h3>\n<p>Khi muốn sử dụng middleware trong 1 scope đầu tiên cần đăng kí middleware đó.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">use</span> <span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Middleware<span class=\"token punctuation\">\\</span>CsrfProtectionMiddleware</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Middleware<span class=\"token punctuation\">\\</span>EncryptedCookieMiddleware</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">registerMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'csrf'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CsrfProtectionMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">registerMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'cookies'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EncryptedCookieMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Sau đó mới có thể sử dụng middleware</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">use</span> <span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Middleware<span class=\"token punctuation\">\\</span>CsrfProtectionMiddleware</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Cake<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Middleware<span class=\"token punctuation\">\\</span>EncryptedCookieMiddleware</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">registerMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'csrf'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CsrfProtectionMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">registerMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'cookies'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EncryptedCookieMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/cms'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Enable CSRF &amp; cookies middleware</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'csrf'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'cookies'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/articles/{action}/*'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'controller'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>7. Resource Routes</h3>\n<p>Khi viết resfull api chúng ta sẽ rất hay sử dụng resource route, và cakePhp 4 cũng có luôn.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/api'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">resources</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'articles'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/api/articles\n/api/articles/{id}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>8. Nested Resource Routes</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">scope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/api'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">resources</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Articles'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>RouteBuilder <span class=\"token variable\">$routes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$routes</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">resources</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Comments'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">/api/articles/{article_id}/comments\n/api/articles/{article_id}/comments/{id}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>Lời kết</h3>\n<p>Trên dây là các khai báo route hay dùng khi sử dụng CakePhp 4. Hi vọng bài viết sẽ giúp ích cho mọi người.</p>\n<h3>Nguồn tham khảo</h3>\n<ul>\n<li><a href=\"https://book.cakephp.org/4/en/development/routing.html\">https://book.cakephp.org/4/en/development/routing.html</a></li>\n</ul>\n<h6><em><div style=\"text-align: right\"> [Huunv | Nguyễn Văn Hữu ] </div></em></h6>","id":"f5e0db47-d19f-50f2-9ff5-ad562c4594d9","frontmatter":{"title":"CakePHP 4: Routing","date":"05-11-2020","tags":["php","cakephp"]},"fields":{"slug":"/cakephp-4-routing/","readingTime":{"text":"4 min read"}}}},{"node":{"excerpt":"Cùng tìm hiểu về HTTP request methods\nĐối với các lập trình viên web nói chung thì chúng ta không thể nào mà không nghe đến các từ như get hoặc post,  bởi vì nó thực sự rất phổ biển…","snippet":"<html><head></head><body><ol> <li>Cu&#x300;ng ti&#x300;m hi&#xEA;&#x309;u v&#xEA;&#x300; HTTP request methods &#x110;&#xF4;&#x301;i v&#x1A1;&#x301;i ca&#x301;c l&#x1EAD;p tri&#x300;nh vi&#xEA;n web no&#x301;i chung thi&#x300; chu&#x301;ng ta kh&#xF4;ng th&#x1EC3; na&#x300;o ma&#x300; kh&#xF4;ng nghe &#x111;&#xEA;&#x301;n ca&#x301;c t&#x1B0;&#x300; nh&#x1B0; <strong>get</strong> ho&#x1EB7;c <strong>post</strong>, b&#x1EDF;i v&#xEC; no&#x301; th&#x1B0;&#x323;c s&#x1B0;&#x323; r&#x1EA5;t ph&#x1ED5; bi&#x1EC3;n.</li> </ol> <p>Nh&#x1B0;ng ngo&#xE0;i ra c&#xF2;n c&#xF3; nhi&#x1EC1;u method kh&#xE1;c m&#xE0;&#x2026;</p></body></html>","html":"<ol>\n<li>Cùng tìm hiểu về HTTP request methods\nĐối với các lập trình viên web nói chung thì chúng ta không thể nào mà không nghe đến các từ như <strong>get</strong> hoặc <strong>post</strong>,  bởi vì nó thực sự rất phổ biển.</li>\n</ol>\n<p>Nhưng ngoài ra còn có nhiều method khác mà chúng ta ít sử dụng hơn nhưng sự tồn tại của chúng cũng là rất cần thiết.</p>\n<p>Trong bài viết này, tôi sẽ giới thiệu các bạn về các request methods hiện có để nếu như các bạn cần sử dụng đến chúng có thể tìm ở ngay đây.</p>\n<h1>2. Sơ lược về các request</h1>\n<p><em>Đầu tiên phải nói đến là có tất cả 9 loại request, get và post là 2 loại thông dụng được sử dụng nhiều.</em> </p>\n<ol>\n<li>\n<p>GET:</p>\n<blockquote>\n<p>Được sử dụng để lấy thông tin từ sever theo URI đã cung cấp.</p>\n</blockquote>\n</li>\n<li>\n<p>HEAD:</p>\n<blockquote>\n<p>Giống với GET nhưng response trả về không có body, chỉ có header</p>\n</blockquote>\n</li>\n<li>\n<p>POST:</p>\n<blockquote>\n<p>Gửi thông tin tới sever thông qua các biểu mẫu http( đăng kí chả hạn..)</p>\n</blockquote>\n</li>\n<li>\n<p>PUT:</p>\n<blockquote>\n<p>Ghi đè tất cả thông tin của đối tượng với những gì được gửi lên</p>\n</blockquote>\n</li>\n<li>\n<p>PATCH:</p>\n<blockquote>\n<p>Ghi đè các thông tin được thay đổi của đối tượng.</p>\n</blockquote>\n</li>\n<li>\n<p>DELETE:</p>\n<blockquote>\n<p>Xóa tài nguyên trên server.</p>\n</blockquote>\n</li>\n<li>\n<p>CONNECT:</p>\n<blockquote>\n<p>Thiết lập một kết nối tới server theo URI.</p>\n</blockquote>\n</li>\n<li>\n<p>OPTIONS:</p>\n<blockquote>\n<p>Mô tả các tùy chọn giao tiếp cho resource.</p>\n</blockquote>\n</li>\n<li>\n<p>TRACE:</p>\n<blockquote>\n<p>Thực hiện một bài test loop - back theo đường dẫn đến resource.</p>\n</blockquote>\n<h1>3.  Đặc tính</h1>\n<p>Có 4 đặc tính nổi bật của các method là:</p>\n</li>\n</ol>\n<h3>Safe (Độ an toàn)</h3>\n<ul>\n<li>Một method được coi là safe khi nó không làm thay đổi trạng thái \"sate\" của server. </li>\n<li>Nói cách khác, an toàn là chỉ đọc mà không làm thay đổi bất kì điều gì.</li>\n<li>Các method được coi là safe chỉ có: GET, HEAD và OPTIONS.  </li>\n<li>Unsafe: PUT, DELETE, POST và PATCH.</li>\n</ul>\n<h3>Idempotent (tính bất biến)</h3>\n<ul>\n<li>Một request được xem là <strong>idempotent</strong> nếu sau \u001dnhiều lần gọi, nó vẫn trả về kết quả như nhau.</li>\n<li>\n<p>Vì điều này nên các method safe thì đều idempotent. Nhưng unsafe chưa chắc đã idempotent.\n<code class=\"language-text\">int i = 100; // idempotent</code>\n<code class=\"language-text\">i++; // not idempotent</code> </p>\n<blockquote>\n<p>Thao tác gán đầu tiên được hiểu là <strong>idempotent</strong>, vì cho dù ta <strong>thực hiện câu lệnh này bao nhiêu lần</strong>, <strong>giá trị của i cũng vẫn chỉ là 100</strong>. Ngược lại, khi giá trị i++, <strong>mỗi lần gọi sẽ tăng giá trị i lên 1</strong>. Vì vậy, <strong>i không là idempotent</strong>.</p>\n</blockquote>\n</li>\n<li>Hãy chú rằng kết quả ở đây là trạng thái của nguồn dữ liệu trên server (lưu ý rằng các mã trạng thái (200,400,403,…) không liên quan tới tính ổn định).</li>\n<li>1 số lưu ý: header dài tối đa 8kb và cũng phụ thuộc cả vào trình duyệt body thì limit của nó tùy trình duyệt.  <em>Url không dài quá 2 nghìn kí tự (ror)</em></li>\n</ul>\n<h3>Visibility (Tính che giấu thông tin)</h3>\n<ul>\n<li>\n<p>Một request trong http methods được xem là <strong>visibility</strong> khi nó <strong>không để lộ ra thông tin trên URL</strong> khi request được gửi.</p>\n<blockquote>\n<p> *Cần lưu ý rằng visibility ở đây <strong>chỉ giới hạn ở URL</strong> (phần người dùng có thể nhìn thấy được).*</p>\n</blockquote>\n</li>\n</ul>\n<h3>Cachable (Có thể cache được)</h3>\n<ul>\n<li>Một request được xem là \u001d<strong>cacheable</strong> khi <strong>sau lần gửi thứ nhất của request</strong>, kết quả phản hồi <strong>có thể được lưu</strong> vào một trong các loại cache trên websites (localStorage, <a href=\"https://45.76.152.160/tim-hieu-ve-http-cookie-cookies/\">cookies</a>, …).</li>\n<li>Các bạn có thể xóa cache trong trình duyệt của mình</li>\n</ul>\n<h1>4. So sánh Get và Post</h1>\n<p>GET và POST là hai phương thức của giao thức HTTP, đều là gửi dữ liệu về server xử lí sau khi người dùng nhập thông tin vào form và thực hiện submit. Trước khi gửi thông tin, nó sẽ được mã hóa bằng cách sử dụng một giản đồ gọi là url encoding. Giản đồ này là các cặp name/value được kết hợp với các kí hiệu = và các kí hiệu khác nhau được ngăn cách bởi dấu &#x26;.</p>\n<h2>GET</h2>\n<ul>\n<li>Phương thức GET gửi thông tin người dùng đã được mã hóa thêm vào trên yêu cầu trang:\n<code class=\"language-text\">https://example.com/index?name=value1&amp;name1=value2&amp;name2=value3</code></li>\n</ul>\n<blockquote>\n<p>Chúng ta thấy rằng GET lộ thông tin trên đường dẫn URL. Băng thông của nó chỉ khoảng 1024 kí tự vì vây GET hạn chế về số kí tự được gửi đi. GET không thể gửi dữ liệu nhị phân , hình ảnh ... Có thể cached và được bookmark (đánh dấu trên trình duyệt). Lưu trong browser history.</p>\n</blockquote>\n<h2>POST</h2>\n<p>Phương thức POST truyền thông tin thông qua HTTP header, thông tin này được mã hóa như phương thức GET. Dữ liệu đươc gửi bởi phương thức POST rất bảo mật vì dữ liệu được gửi ngầm, không đưa lên URL, bằng việc sử dụng Secure HTTP, bạn có thể chắc chắn rằng thông tin của mình là an toàn. Parameters được truyền trong request body nên có thể truyền dữ liệu lớn, hạn chế tùy thuộc vào cấu hình của Server.</p>\n<blockquote>\n<p>Không cache và bookmark được cũng như không được lưu lại trong browser history. POST không có bất kì hạn chế nào về kích thước dữ liệu sẽ gửi, có thể gửi dữ liệu nhị phân, hình ảnh.</p>\n</blockquote>\n<h2>So sánh</h2>\n<ul>\n<li>\n<p><strong>Lưu trữ (cache)</strong> </p>\n<blockquote>\n<p>Dữ liệu gửi bằng phương thức GET sẽ được lưu trữ lại trong query string và có thể được xem trong lịch sử trình duyệt.\nNgược lại thì dữ liệu và địa chỉ URL của các request gửi bằng POST không được trình duyệt lưu lại. </p>\n</blockquote>\n</li>\n<li>\n<p><strong>Tốc độ</strong></p>\n<blockquote>\n<p>GET nhanh hơn rất nhiều so với POST về quá trình thực thi vì dữ liệu gửi đi luôn được webrowser cached lại, khi dùng phương thức POST thì server luôn thực thi và trả kết quả cho client, còn dùng GET thì webrowser cached sẽ kiểm tra có kết quả tương ứng đó trong cached chưa, nếu có thì trả về ngay mà không cần đưa tới server. </p>\n</blockquote>\n</li>\n<li>\n<p><strong>Đánh dấu (bookmark)</strong> </p>\n<blockquote>\n<p>Đối với request gửi bằng phương thức GET người dùng có thể bookmark lại được trên trình duyệt. Ngược lại các request gửi bằng POST sẽ không thể bookmark được. </p>\n</blockquote>\n</li>\n<li>\n<p><strong>Gửi lại form</strong></p>\n<blockquote>\n<p>Với form gửi đi bằng phương thức GET bạn có thể gửi lại bằng cách bấm phím F5 hoặc Ctrl + R. Tuy nhiên với phương thức POST, nếu bạn muốn thực hiện việc gửi lại dữ liệu của form thì trình duyệt sẽ hiển thị một hộp thoại cảnh báo.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>Trở lại trang trước</strong></p>\n<blockquote>\n<p>Trong trường hợp bạn đã gửi form dữ liệu đi rồi sau đó bấm phím Backspace để quay lại trang trước thì với phương thức GET bạn sẽ vẫn được cùng một nội dụng (chứa form). Ngược lại với POST thì bạn sẽ thấy một trang trống.</p>\n</blockquote>\n</li>\n<li>\n<p><strong>Bảo mật</strong> </p>\n<blockquote>\n<p>Phương thức POST bảo mật hơn GET vì dữ liệu được gửi ngầm, không xuất hiện trên URL, dữ liệu cũng không được lưu lại trong khi đó với GET thì bạn có thể hiển thị lại được các dữ liệu này. </p>\n</blockquote>\n</li>\n<li>\n<p><strong>Dữ liệu</strong></p>\n<blockquote>\n<p>Phương thức POST không giới hạn dung lượng dữ liệu gửi đi cũng như loại nhữ liệu (văn bản thông thường hay file nhị phân như upload tập tin hay hình ảnh, video...). Ngược lại, với phương thức GET dữ liệu gửi đi bị giới hạn sử dụng các ký tự chữ có trong bộ ký tự ASCII. Đồng thời dữ liệu của GET được gửi trong URL thông qua query string nên sẽ bị giới hạn bởi số lượng ký tự tối đa cho phép trong URL.</p>\n</blockquote>\n</li>\n</ul>\n<h1>5. Lời cuối cùng</h1>\n<p>Ở trên chỉ là tóm tắt cơ bản về các request methods trong HTTP . Ngoài ra, để tìm hiểu thêm về bảo mật Http methods, các bạn có thể đọc thêm ở các nguồn tài liệu khác nhé.\n<strong>See ya!!</strong></p>\n<h6><em><div style=\"text-align: right\"> - by Thắng Đặng</div></em></h6>","id":"1448b36a-a881-52cc-8423-44ec93b884af","frontmatter":{"title":"Learn about HTTP request method ","date":"05-11-2020","tags":["technical"]},"fields":{"slug":"/tim-hieu-reqeust-method-http/","readingTime":{"text":"7 min read"}}}},{"node":{"excerpt":"Chúng ta khi làm việc với Laravel ít nhất vài lần sẽ gặp một task yêu cầu làm công việc tìm kiếm thông tin dựa vào 1 chuỗi đầu vào. Thường thì chúng ta sẽ viết đi viết lại 1 câu điều kiện để thực hiện…","snippet":"<html><head></head><body><p>Ch&#xFA;ng ta khi l&#xE0;m vi&#x1EC7;c v&#x1EDB;i Laravel &#xED;t nh&#x1EA5;t v&#xE0;i l&#x1EA7;n s&#x1EBD; g&#x1EB7;p m&#x1ED9;t task y&#xEA;u c&#x1EA7;u l&#xE0;m c&#xF4;ng vi&#x1EC7;c t&#xEC;m ki&#x1EBF;m th&#xF4;ng tin d&#x1EF1;a v&#xE0;o 1 chu&#x1ED7;i &#x111;&#x1EA7;u v&#xE0;o. Th&#x1B0;&#x1EDD;ng th&#xEC; ch&#xFA;ng ta s&#x1EBD; vi&#x1EBF;t &#x111;i vi&#x1EBF;t l&#x1EA1;i 1 c&#xE2;u &#x111;i&#x1EC1;u ki&#x1EC7;n &#x111;&#x1EC3; th&#x1EF1;c hi&#x1EC7;n t&#xEC;m ki&#x1EBF;m ho&#x1EB7;c s&#x1EED;&#x2026;</p></body></html>","html":"<p>Chúng ta khi làm việc với Laravel ít nhất vài lần sẽ gặp một task yêu cầu làm công việc tìm kiếm thông tin dựa vào 1 chuỗi đầu vào. Thường thì chúng ta sẽ viết đi viết lại 1 câu điều kiện để thực hiện tìm kiếm hoặc sử dụng một thư viện nào đó để làm công việc đó.</p>\n<p>Sau một thời gian copy và patse những câu lệnh where, tôi đã nghĩ ra cách để đơn giản hoá công việc tìm kiếm và có thể tái sử dụng nhiều lần. Chúng ta sẽ tìm hiểu ngay bên dưới.</p>\n<h2>I.  Bắt đầu</h2>\n<h4>1. Khởi tạo trait</h4>\n<ul>\n<li>Tạo thư mục \"App\\Traits\"</li>\n<li>\n<p>Tạo file SearchTrait.php trong thử mục \"App\\Traits\" với nội dung:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Traits</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span>Eloquent<span class=\"token punctuation\">\\</span>Builder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>Facades<span class=\"token punctuation\">\\</span>Schema</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Arr</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">trait</span>  SearchTrait\n<span class=\"token punctuation\">{</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ul>\n<h4>2. Định nghĩa những hàm để thực hiện việc tìm kiếm</h4>\n<ul>\n<li>\n<p>Lấy điều kiện join khi search được define trong model và khởi tạo scope để join với những bảng liên quan:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Get list tables with join conditions\n *\n * @return Array\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span>  Arr<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">searchable</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'joins'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Scope to join table with corresponding conditions from getJoins()\n * @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n * @return \\Illuminate\\Database\\Eloquent\\Builder\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeMakeJoins</span><span class=\"token punctuation\">(</span>Builder <span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$table</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">leftJoin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$join</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token variable\">$join</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keys</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'='</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keys</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>\n<p>Lấy những trường sẽ sẽ được tìm kiếm dựa vào định nghĩa ở model:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Get all fields, which can be search in this tables and relation table\n * @return Array\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token variable\">$model</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> Arr<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">searchable</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'columns'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$fields</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> Schema<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">getColumnListing</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">primaryKey</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getUpdatedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getCreatedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'updated_at'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">method_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'getDeletedAtColumn'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">?</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getDeletedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'deleted_at'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_diff</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$fields</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getHidden</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$others</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$fields</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Định nghĩa scope dùng để tìm kiếm, ở đây có 2 trường hợp (Tìm kiếm trên bảng hiện tại và những bảng quan hệ hoặc chỉ tìm kiếm trên bảng hiện tại):</li>\n</ul>\n<p>1: Tìm kiếm trên bảng hiện tại và những bảng quan hệ:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">\t<span class=\"token comment\">/**\n\t* Scope models are used to search by $keyword for fields on the current table and relational tables\n\t* @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n\t* @param string $keyword\n\t* @param boolean $matchAllFields\n\t*/</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeSearch</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span>  <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">makeJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">.</span>  <span class=\"token single-quoted-string string\">'.*'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">distinct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$keyword</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/\\s+/'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'%'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$field</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> \n            <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>2: Chỉ tìm kiếm trên bảng hiện tại (No Relation):</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">\t<span class=\"token comment\">/**\n\t* Scope models are used to search by $keyword for fields on the current table and relational tables\n\t* @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n\t* @param string $keyword\n\t* @param boolean $matchAllFields\n\t*/</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeSearchNoRelation</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span>  <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$keyword</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/\\s+/'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'%'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$field</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> \n            <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">return</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n</ul>\n<h4>3.  Đầy đủ</h4>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">namespace</span>  <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Traits</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span>Eloquent<span class=\"token punctuation\">\\</span>Builder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>Facades<span class=\"token punctuation\">\\</span>Schema</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span>  <span class=\"token package\">Arr</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">trait</span>  SearchTrait\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">/**\n     * Get list tables with join conditions\n     *\n     * @return Array\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span>  Arr<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">searchable</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'joins'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token comment\">/**\n     * Scope to join table with corresponding conditions from getJoins()\n     * @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n     * @return \\Illuminate\\Database\\Eloquent\\Builder\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeMakeJoins</span><span class=\"token punctuation\">(</span>Builder <span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$table</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">leftJoin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$table</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$join</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keys</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token variable\">$join</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keys</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'='</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keys</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token comment\">/**\n     * Get all fields, which can be search in this tables and relation table\n     * @return Array\n     */</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$model</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> Arr<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">searchable</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'columns'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$fields</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> Schema<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">getColumnListing</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">primaryKey</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getUpdatedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getCreatedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'updated_at'</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$others</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">method_exists</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'getDeletedAtColumn'</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token operator\">?</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getDeletedAtColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">'deleted_at'</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token variable\">$fields</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_diff</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$fields</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getHidden</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$others</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$fields</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token comment\">/**\n\t* Scope models are used to search by $keyword for fields on the current table and relational tables\n\t* @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n\t* @param string $keyword\n\t* @param boolean $matchAllFields\n\t* @return \\Illuminate\\Database\\Eloquent\\Builder\n\t*/</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeSearch</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">makeJoins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">.</span>  <span class=\"token single-quoted-string string\">'.*'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">distinct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$keyword</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/\\s+/'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'%'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$field</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> \n\t\t\t\t\t<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token comment\">/**\n\t* Scope models are used to search by $keyword for fields on the current table\n\t* @param \\Illuminate\\Database\\Eloquent\\Builder|static $query\n\t* @param string $keyword\n\t* @param boolean $matchAllFields\n\t* @return \\Illuminate\\Database\\Eloquent\\Builder\n\t*/</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeSearchNoRelation</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">return</span>  <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">use</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$keyword</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token variable\">$keyword</span> <span class=\"token operator\">=</span> <span class=\"token function\">preg_replace</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'/\\s+/'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'%'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$keyword</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getSearchFields</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$field</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$matchAllFields</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> \n\t\t\t\t\t<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$field</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'LIKE'</span><span class=\"token punctuation\">,</span> <span class=\"token double-quoted-string string\">\"%<span class=\"token interpolation\"><span class=\"token variable\">$keyword</span></span>%\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>II. Cách sử dụng</h2>\n<p><strong><em>1. Trong model:</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"<php?\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-<php? line-numbers\"><code class=\"language-<php?\">namespace  App\\Models;\nuse Illuminate\\Database\\Eloquent\\Model;\nuse App\\Traits\\SearchTrait;\n\nclass \u001dProduct extends Model\n{\n\tuse SearchTrait;\n\t\n\tprotected $searchable = [\n\t\t&#39;columns&#39; =&gt; [\n\t\t\t&#39;products.name&#39;, &#39;categories.name&#39;, &#39;users.name&#39;\n\t\t],\n\t\t&#39;joins&#39; =&gt; [\n\t\t\t&#39;category&#39; =&gt; [&#39;\u001dproducts.category_id&#39;, &#39;categories.id&#39;],\n\t\t\t&#39;user&#39; =&gt; [&#39;\u001dproducts.user_id&#39;, &#39;users.id&#39;]\n\t\t]\n\t];</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li><strong>columns</strong> : Những cột sẽ được thực hiện tìm kiếm.</li>\n<li><strong>joins</strong>: Những bảng quan hệ và điều kiện để nối bảng.</li>\n</ul>\n<p><strong><em>2. Trong \bController:</em></strong></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">namespace</span>  <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Controllers</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Models<span class=\"token punctuation\">\\</span>Product</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Http<span class=\"token punctuation\">\\</span>Request</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ProductController</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Controller</span>\n  \t<span class=\"token comment\">/**\n     * Get list products\n     * @param Request $request\n     * @return View\n     */</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span>Request <span class=\"token variable\">$request</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token variable\">$keywork</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$request</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'keywork'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$products</span> <span class=\"token operator\">=</span> Product<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$keywork</span><span class=\"token punctuation\">,</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">view</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'products.index'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">compact</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'products'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Ở đây tham số thứ 2 của hàm search()</li>\n<li>$matchAllFields: Nếu <strong>true</strong> thì tất cả các trường tìm kiếm đều phải chứa giá trị <strong>keywork</strong> và ngược lại chỉ cần một trong các trường chứa <strong>keywork</strong>.</li>\n</ul>\n<h2>III. Kết luận</h2>\n<p>Như vậy, trong blog này chúng ta đã có một cách thực hiện công việc tìm kiếm một cách đơn giản và dễ tái sử dụng bằng cách sử dụng <strong>Trait</strong> trong Laravel. Mong là bài chia sẽ này sẽ giúp được mọi người trong công việc của mình.</p>\n<h6><em><div style=\"text-align: right\"> [Tran Van Tuan Anh | Trần Văn Tuấn Anh ] </div></em></h6>","id":"c63995c7-a6e2-5f5d-85a3-35e55a86f2e2","frontmatter":{"title":"[Laravel] Create a simple laravel search by trait","date":"04-11-2020","tags":["laravel"]},"fields":{"slug":"/create-a-simple-laravel-search-by-trait/","readingTime":{"text":"6 min read"}}}},{"node":{"excerpt":"Eloquent ORM được sủ dụng rất nhiều trong 1 project Laravel, tuy nhiên để sử dụng được tối đa những gì Laravel cung cấp thì không phải ai cũng biết. Trong bài viết này mình sẽ chỉ cho các bạn một vài…","snippet":"<html><head></head><body><p>Eloquent ORM &#x111;&#x1B0;&#x1EE3;c s&#x1EE7; d&#x1EE5;ng r&#x1EA5;t nhi&#x1EC1;u trong 1 project Laravel, tuy nhi&#xEA;n &#x111;&#x1EC3; s&#x1EED; d&#x1EE5;ng &#x111;&#x1B0;&#x1EE3;c t&#x1ED1;i &#x111;a nh&#x1EEF;ng g&#xEC; Laravel cung c&#x1EA5;p th&#xEC; kh&#xF4;ng ph&#x1EA3;i ai c&#x169;ng bi&#x1EBF;t. Trong b&#xE0;i vi&#x1EBF;t n&#xE0;y m&#xEC;nh s&#x1EBD; ch&#x1EC9; cho c&#xE1;c b&#x1EA1;n m&#x1ED9;t v&#xE0;i th&#x1EE7; thu&#x1EAD;t, hi v&#x1ECD;ng s&#x1EBD; gi&#xFA;p &#xED;ch cho&#x2026;</p></body></html>","html":"<p>Eloquent ORM được sủ dụng rất nhiều trong 1 project Laravel, tuy nhiên để sử dụng được tối đa những gì Laravel cung cấp thì không phải ai cũng biết. Trong bài viết này mình sẽ chỉ cho các bạn một vài thủ thuật, hi vọng sẽ giúp ích cho các bạn trong một vài trường hợp cụ thể.</p>\n<h4>1. Increments và Decrements</h4>\n<p>Khi muốn update tăng 1 đơn vị cho 1 column thay vì viết như này.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> Post<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">view_count</span><span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Bạn có thể viết lại như này </p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$post</span> <span class=\"token operator\">=</span> Post<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'view_count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Hoặc</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">Post<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'view_count'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nPost<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$postId</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">increment</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'view_count'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// +10</span>\nProduct<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$productId</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">decrement</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'stock'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// -1</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h4>2. XorY methods</h4>\n<p> Laravel Eloquent có khả nhiều function kết hợp 2 methods kiểu như \"hãy làm X trước nếu không thì làm Y\"</p>\n<ul>\n<li><b>findOrFail</b>\nThay vì viết như này</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token function\">abort</span><span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Chúng ta có thể viết ngắn gọn như này</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">findOrFail</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>\n<p><b>firstOrCreate</b></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$email</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\nUser<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n<span class=\"token single-quoted-string string\">'email'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$email</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>↓</p>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">firstOrCreate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'email'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$email</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4>3. Model boot() method</h4>\n<p>Trong Laravel Eloquent có một function <code class=\"language-text\">boot()</code> cho phép bạn ghi đè lại các giá trị mặc định.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n    * @return void\n    */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">updating</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// do some logging</span>\n            <span class=\"token comment\">// thay thế một số property, ví dụ $model->something = transform($something);</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ứng dụng nhiều nhất của function này là set uuid cho đối tượng</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return void\n*/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    self<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">creating</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$model</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$model</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">uuid</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span>Uuid<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">generate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>4. Thêm điều kiện hoặc ordering trong relationship</h4>\n<p>Dưới đây là một cách mà các bạn thường dùng để định nghĩa một relationship</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return mixed\n*/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">users</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">hasMany</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'App\\User'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tuy nhiên bạn hoàn toàn có thể thêm <code class=\"language-text\">where</code> hoặc <code class=\"language-text\">orderBy</code> </p>\n<p>Ví dụ trong trường hợp cụ thể, bạn cần tạo quan hệ giữa bảng <code class=\"language-text\">categories</code> và <code class=\"language-text\">posts</code> nhưng thêm điều kiện là <code class=\"language-text\">post</code> phải có trạng thái là <code class=\"language-text\">APPROVED</code> và sắp xếp theo thứ tụ tăng dần.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return mixed\n*/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">posts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">hasMany</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'App\\Models\\Category'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'status'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'APPROVED'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'DESC'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>5. Model properties: timestamps, appends, ...</h4>\n<p>Có một vài parameters của Eloquent Model, được thể hiện dưới dạng properties của class đó. Một số cái phổ biến nhất có thể là:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$table</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'users'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$fillable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'password'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Những fileds có thể được set giá trị bằng cách dùng User::create()</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$dates</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'deleted_at'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Những fields sẽ được set bởi Carbon-ized</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$appends</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'field1'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'field2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Các giá trị bổ sung được trả về trong JSON </span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Khoannnnnnnnnnnnnnnnnnn, Còn nữa...</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">protected</span> <span class=\"token variable\">$primaryKey</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'uuid'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Primary key k phải lúc nào cũng bắt buộc phải là id</span>\n<span class=\"token keyword\">public</span> <span class=\"token variable\">$incrementing</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// và thậm chí k cần phải tự động tăng luông </span>\n<span class=\"token keyword\">protected</span> <span class=\"token variable\">$perPage</span> <span class=\"token operator\">=</span> <span class=\"token number\">25</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Bạn có thể override số lượng data trong 1 page khi sủ dụng pagination, giá trị này default là 15</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CREATED_AT</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">UPDATED_AT</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'updated_at'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Thay đổi được tên column created_at và updated_at luôn nè </span>\n<span class=\"token keyword\">public</span> <span class=\"token variable\">$timestamps</span> <span class=\"token operator\">=</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Hoặc khai báo là k cần sủ dụng chúng</span>\n<span class=\"token keyword\">protected</span> <span class=\"token variable\">$dateFormat</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'U'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//Hoặc bạn có thể thay đổi kiểu dữ liệu của chúng. Ví dụ chuyển created_at và updated_at sang integer thì làm như ví dụ này.</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và tất nhiên là còn nhiều hơn nữa, trên đây mình đã liệt kê những cái thú vị nhất, để biết thêm chi tiết, vui lòng kiểm tra ở <code class=\"language-text\">abstract Model Class</code></p>\n<h4>6. Find multiple entries</h4>\n<p>Chắc hẳn tất cả mọi người đều biết về <code class=\"language-text\">find()</code> method.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nhưng có rất ít người biết rằng, hàm <code class=\"language-text\">find()</code> có thể nhận nhiều ID dưới dạng 1 array.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$user</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4>7. WhereX</h4>\n<p>Bạn có thể kết hợp tên column viết dưới dạng <code class=\"language-text\">Camel</code> vào sau <code class=\"language-text\">where</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'approved'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Chuyển thành</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">whereApproved</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Ngoài ra có một số method đã được define trước trong Eloquent</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">whereDate</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Y-m-d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUser<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">whereDay</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUser<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">whereMonth</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'m'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nUser<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">whereYear</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'Y'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>8. Order by relationship</h4>\n<p>Sử dụng khi bạn cần lấy <code class=\"language-text\">post</code> mới nhất trong 1 list <code class=\"language-text\">categories</code>. Đầu tiên bạn cần define 1 relationship riêng việt cho <code class=\"language-text\">post</code> mới nhất của <code class=\"language-text\">categories</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return mixed\n*/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">latestPost</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">hasOne</span><span class=\"token punctuation\">(</span>\\<span class=\"token package\">App<span class=\"token punctuation\">\\</span>Models<span class=\"token punctuation\">\\</span>Post</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và sau đó, trong khi query bạn có thể làm được điều này:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$categories</span> <span class=\"token operator\">=</span> Category<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'latestPost'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">sortByDesc</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'latestPost.created_at'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4>9. Eloquent::when() – không còn phải sử dụng if-else’s</h4>\n<p>Khi cần thêm điều kiện vào trong query. Đa số mọi người sẽ viết như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'filter_by'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token single-quoted-string string\">'likes'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'likes'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'likes_amount'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'filter_by'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token single-quoted-string string\">'date'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'ordering_rule'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'desc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tuy nhiên bạn có thể sử dụng <code class=\"language-text\">when()</code> để viết lại như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> Author<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">when</span><span class=\"token punctuation\">(</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'filter_by'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token single-quoted-string string\">'likes'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'likes'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'likes_amount'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">when</span><span class=\"token punctuation\">(</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'filter_by'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token single-quoted-string string\">'date'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'ordering_rule'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'desc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nhìn có vẻ dài hơn cách dùng if else thông thường nhưng nó sẽ thật sự tốt trong việc phải truyền thêm tham số</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$query</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">when</span><span class=\"token punctuation\">(</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'role'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$q</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$role</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> \n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'role_id'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$role</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$authors</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>10. BelongsTo Default Models</h4>\n<p>Giả sử khí bạn phải show thông tin của 1 <code class=\"language-text\">post</code> kèo theo thông tin của tác giả:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">author</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Tuy nhiên nếu thông tin về tác giả bị xóa. Hệ thống của bạn sẽ xuất hiện 1 lỗi kiểu như <code class=\"language-text\">property of non-object</code>\nTất nhiên vẫn có cách giải quyết kiểu như</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">!</span><span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">author</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$post</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">author</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">:</span> <span class=\"token single-quoted-string string\">''</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nhưng bạn hoàn toàn có thể làm nó ở relationship</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return mixed\n*/</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">author</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'App\\Author'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">withDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n        <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Administrator'</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>11. Order by Mutator</h4>\n<p>Hãy tưởng tượng bạn có cái này:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* Get fullname by first name and last name\n* @return string\n*/</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getFullNameAttribute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> string\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">attributes</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'first_name'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">' '</span> <span class=\"token punctuation\">.</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">attributes</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'last_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Bây giờ bạn muốn order by theo <code class=\"language-text\">full_name</code> thì sao nhỉ?</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$clients</span> <span class=\"token operator\">=</span> Client<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'full_name'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Viết như này nó sẽ k chạy đâu nhé :))</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Bạn cần viết như này</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$clients</span> <span class=\"token operator\">=</span> Client<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">sortBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'full_name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> </code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Lưu ý rằng tên function khác nhau nhé. Nó k phải <code class=\"language-text\">orderBy</code> mà là <code class=\"language-text\">sortBy</code></p>\n<h4>12. Set ordering mặc định</h4>\n<p>Nếu bạn muốn <code class=\"language-text\">User:all()</code> luôn được order by name? Bạn có thể sủ dụng method <code class=\"language-text\">boot()</code> như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n* @return void\n*/</span>\n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> void\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Order by name ASC</span>\n    <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">addGlobalScope</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'order'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>Builder <span class=\"token variable\">$builder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$builder</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orderBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'asc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>13. Raw query methods</h4>\n<p>Giả sử chúng ta cần thêm 1 câu truy vấn Sql vào câu lệnh Eloquent của mình.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// whereRaw</span>\n<span class=\"token variable\">$orders</span> <span class=\"token operator\">=</span> <span class=\"token constant\">DB</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'orders'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereRaw</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'price > IF(state = \"TX\", ?, 100)'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">200</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// havingRaw</span>\nProduct<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">groupBy</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'category_id'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">havingRaw</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'COUNT(*) > 1'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// orderByRaw</span>\nUser<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'2016-01-01'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orderByRaw</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'(updated_at - created_at) desc'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>14. Replicate: tạo 1 bản copy của 1 row</h4>\n<p>Đây là cách tốt nhất để tạo 1 bản sao ò database entry:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$task</span> <span class=\"token operator\">=</span> Tasks<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$newTask</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$task</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">replicate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$newTask</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h4>15. Chunk() method for big tables</h4>\n<p>Không liên quan nhiều lắm đến Eloquent, nó thiên về Collection nhiều hơn, nhưng vẫn tốt khi muốn xử lý các dữ liệu lớn, bạn có thể chia chúng thành nhiều phần:\nThay vì viết như này:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Bạn có thể viết lại như này:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">chunk</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// ...</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>16. Tạo nhưng file bổ sung khi tạo model bằng command</h4>\n<p>Chắc hẳn tất cả mọi người đề biết về câu lệnh tạo model này:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\">php artisan make<span class=\"token punctuation\">:</span>model Company</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nhưng k phải ai cũng biết rằng có 3 flags hữu ích để tạo các tệp liên quan đến Model</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\">php artisan make<span class=\"token punctuation\">:</span>model Company <span class=\"token punctuation\">-</span>mcr</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li><code class=\"language-text\">-m</code> sẽ tạo thêm migration file</li>\n<li><code class=\"language-text\">-c</code> sẽ tạo thêm controller file </li>\n<li><code class=\"language-text\">-r</code> sẽ chỉ định controller có thêm thuộc tính --resource</li>\n</ul>\n<h4>17. Override updated_at when saving</h4>\n<p>Bạn có biết <code class=\"language-text\">save()</code> method có thể nhận thêm tham số không? Chúng ta có thể yêu cầu nó bỏ qua chức năng mặc định updated_at để được set bằng thời gian hiện tại.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$product</span> <span class=\"token operator\">=</span> Product<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$product</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">updated_at</span> <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'2019-01-01 10:00:00'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$product</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'timestamps'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean constant\">false</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Trong trường hợp này mình đã override <code class=\"language-text\">updated_at</code> mặc định bằng giá trị được xác định từ trước mà tôi muốn.</p>\n<h4>18. Kết quả của method <code class=\"language-text\">update()</code> là gì?</h4>\n<p> Bạn có biết <code class=\"language-text\">$result</code> sẽ trả về gì k?</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$products</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereNull</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'category_id'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'category_id'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Câu trả lời là số hàng được update, vì vậy nếu bạn cần kiểm tra xem có bao nhiêu hàng bị ảnh hưởng thì bạn k cần làm thêm bất kỳ cái gì khác - <code class=\"language-text\">update()</code> method sẽ trả về cho bạn con số này.</p>\n<h4>19. Nhóm các điều kiện khi sử dụng Eloquent Query</h4>\n<p>Bạn sẽ làm thế nào nếu bạn có and-or kết hợp trong SQL query kiểu như này:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token keyword\">WHERE</span> <span class=\"token punctuation\">(</span>gender <span class=\"token operator\">=</span> <span class=\"token string\">'Male'</span> <span class=\"token operator\">and</span> age <span class=\"token operator\">>=</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">or</span> <span class=\"token punctuation\">(</span>gender <span class=\"token operator\">=</span> <span class=\"token string\">'Female'</span> <span class=\"token operator\">and</span> age <span class=\"token operator\">>=</span> <span class=\"token number\">65</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Khi chuyển qua Eloquent bạn nghĩ như này có đúng?</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'gender'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'Male'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'gender'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'Female'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Sai hoàn toàn nhé. Cách đúng sẽ phức tạp hơn một chút:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'gender'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'Male'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'gender'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'Female'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'>='</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>20. orWhere with multiple parameters</h4>\n<p>Cuối cùng, bạn có thể truyền tham số vào <code class=\"language-text\">orWhere()</code> là một array.</p>\n<p>Với cách thông thường bạn sẽ phải viết như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Nhưng bạn có thể viết lại như này:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">where</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$q</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">orWhere</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'b'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'c'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<br>\n<p>Hi vọng với những mẹo này sẽ giúp các bạn nhiều hơn khi làm việc với dự án laravel </p>\n<h6><em><div style=\"text-align: right\"> [Nam Tran | Trần Thành Nam ] </div></em></h6>","id":"bb695671-20a3-529b-8a87-adbcd06d412d","frontmatter":{"title":"20 Laravel Eloquent Tips and Tricks","date":"03-11-2020","tags":["Laravel","php"]},"fields":{"slug":"/20-laravel-eloquent-tips-and-tricks/","readingTime":{"text":"9 min read"}}}}]}},"pageContext":{"limit":10,"skip":30,"numPages":10,"currentPage":4}},"staticQueryHashes":["3963689063","63159454","81262063"]}