{"componentChunkName":"component---src-pages-index-js","path":"/","result":{"data":{"site":{"siteMetadata":{"title":"TOMOSIA VIETNAM","author":"「共に」「幸せ」「灯す」","labels":[{"tag":"javascript","tech":"JavaScript","name":"M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z","size":20,"color":"yellow"},{"tag":"react","tech":"React","name":"M12 9.861A2.139 2.139 0 1 0 12 14.139 2.139 2.139 0 1 0 12 9.861zM6.008 16.255l-.472-.12C2.018 15.246 0 13.737 0 11.996s2.018-3.25 5.536-4.139l.472-.119.133.468a23.53 23.53 0 0 0 1.363 3.578l.101.213-.101.213a23.307 23.307 0 0 0-1.363 3.578l-.133.467zM5.317 8.95c-2.674.751-4.315 1.9-4.315 3.046 0 1.145 1.641 2.294 4.315 3.046a24.95 24.95 0 0 1 1.182-3.046A24.752 24.752 0 0 1 5.317 8.95zM17.992 16.255l-.133-.469a23.357 23.357 0 0 0-1.364-3.577l-.101-.213.101-.213a23.42 23.42 0 0 0 1.364-3.578l.133-.468.473.119c3.517.889 5.535 2.398 5.535 4.14s-2.018 3.25-5.535 4.139l-.473.12zm-.491-4.259c.48 1.039.877 2.06 1.182 3.046 2.675-.752 4.315-1.901 4.315-3.046 0-1.146-1.641-2.294-4.315-3.046a24.788 24.788 0 0 1-1.182 3.046zM5.31 8.945l-.133-.467C4.188 4.992 4.488 2.494 6 1.622c1.483-.856 3.864.155 6.359 2.716l.34.349-.34.349a23.552 23.552 0 0 0-2.422 2.967l-.135.193-.235.02a23.657 23.657 0 0 0-3.785.61l-.472.119zm1.896-6.63c-.268 0-.505.058-.705.173-.994.573-1.17 2.565-.485 5.253a25.122 25.122 0 0 1 3.233-.501 24.847 24.847 0 0 1 2.052-2.544c-1.56-1.519-3.037-2.381-4.095-2.381zM16.795 22.677c-.001 0-.001 0 0 0-1.425 0-3.255-1.073-5.154-3.023l-.34-.349.34-.349a23.53 23.53 0 0 0 2.421-2.968l.135-.193.234-.02a23.63 23.63 0 0 0 3.787-.609l.472-.119.134.468c.987 3.484.688 5.983-.824 6.854a2.38 2.38 0 0 1-1.205.308zm-4.096-3.381c1.56 1.519 3.037 2.381 4.095 2.381h.001c.267 0 .505-.058.704-.173.994-.573 1.171-2.566.485-5.254a25.02 25.02 0 0 1-3.234.501 24.674 24.674 0 0 1-2.051 2.545zM18.69 8.945l-.472-.119a23.479 23.479 0 0 0-3.787-.61l-.234-.02-.135-.193a23.414 23.414 0 0 0-2.421-2.967l-.34-.349.34-.349C14.135 1.778 16.515.767 18 1.622c1.512.872 1.812 3.37.824 6.855l-.134.468zM14.75 7.24c1.142.104 2.227.273 3.234.501.686-2.688.509-4.68-.485-5.253-.988-.571-2.845.304-4.8 2.208A24.849 24.849 0 0 1 14.75 7.24zM7.206 22.677A2.38 2.38 0 0 1 6 22.369c-1.512-.871-1.812-3.369-.823-6.854l.132-.468.472.119c1.155.291 2.429.496 3.785.609l.235.02.134.193a23.596 23.596 0 0 0 2.422 2.968l.34.349-.34.349c-1.898 1.95-3.728 3.023-5.151 3.023zm-1.19-6.427c-.686 2.688-.509 4.681.485 5.254.987.563 2.843-.305 4.8-2.208a24.998 24.998 0 0 1-2.052-2.545 24.976 24.976 0 0 1-3.233-.501zM12 16.878c-.823 0-1.669-.036-2.516-.106l-.235-.02-.135-.193a30.388 30.388 0 0 1-1.35-2.122 30.354 30.354 0 0 1-1.166-2.228l-.1-.213.1-.213a30.3 30.3 0 0 1 1.166-2.228c.414-.716.869-1.43 1.35-2.122l.135-.193.235-.02a29.785 29.785 0 0 1 5.033 0l.234.02.134.193a30.006 30.006 0 0 1 2.517 4.35l.101.213-.101.213a29.6 29.6 0 0 1-2.517 4.35l-.134.193-.234.02c-.847.07-1.694.106-2.517.106zm-2.197-1.084c1.48.111 2.914.111 4.395 0a29.006 29.006 0 0 0 2.196-3.798 28.585 28.585 0 0 0-2.197-3.798 29.031 29.031 0 0 0-4.394 0 28.477 28.477 0 0 0-2.197 3.798 29.114 29.114 0 0 0 2.197 3.798z","size":20,"color":"deepskyblue"},{"tag":"nodejs","tech":"Node.js","name":"M11.177 25.3a1.94 1.94 0 0 1-.969-.259l-3.086-1.826c-.46-.257-.235-.349-.083-.402.614-.213.739-.262 1.394-.635.069-.038.159-.024.231.018l2.37 1.407a.304.304 0 0 0 .287 0l9.241-5.333a.292.292 0 0 0 .141-.25V7.355a.3.3 0 0 0-.143-.255l-9.237-5.329a.29.29 0 0 0-.285 0L1.803 7.102a.296.296 0 0 0-.146.253v10.666c0 .102.056.198.145.247l2.532 1.462c1.374.687 2.215-.122 2.215-.935V8.265c0-.149.12-.266.269-.266H7.99c.146 0 .267.117.267.266v10.53c0 1.833-.998 2.885-2.736 2.885-.534 0-.955 0-2.129-.579L.969 19.706A1.953 1.953 0 0 1 0 18.02V7.355c0-.693.371-1.339.969-1.684l9.242-5.34a2.023 2.023 0 0 1 1.942 0l9.241 5.34c.599.346.971.992.971 1.684V18.02c0 .693-.372 1.337-.971 1.686l-9.241 5.335a1.942 1.942 0 0 1-.973.259zm2.855-7.348c-4.045 0-4.892-1.857-4.892-3.414 0-.148.118-.266.266-.266h1.195c.133 0 .245.096.265.226.18 1.216.717 1.831 3.164 1.831 1.946 0 2.775-.441 2.775-1.473 0-.596-.234-1.037-3.26-1.334-2.528-.25-4.093-.809-4.093-2.831 0-1.865 1.572-2.977 4.207-2.977 2.961 0 4.425 1.027 4.611 3.233a.27.27 0 0 1-.267.291h-1.2a.266.266 0 0 1-.259-.209c-.288-1.28-.988-1.689-2.886-1.689-2.126 0-2.373.74-2.373 1.295 0 .673.292.869 3.161 1.248 2.84.375 4.19.907 4.19 2.902 0 2.014-1.678 3.167-4.606 3.167z","size":20,"color":"lightgreen"},{"tag":"ruby","tech":"Ruby","name":"M20.156.083c3.033.525 3.893 2.598 3.829 4.77L24 4.822 22.635 22.71 4.89 23.926h.016C3.433 23.864.15 23.729 0 19.139l1.645-3 2.819 6.586.503 1.172 2.805-9.144-.03.007.016-.03 9.255 2.956-1.396-5.431-.99-3.9 8.82-.569-.615-.51L16.5 2.114 20.159.073l-.003.01zM0 19.089v.026-.029.003zM5.13 5.073c3.561-3.533 8.157-5.621 9.922-3.84 1.762 1.777-.105 6.105-3.673 9.636-3.563 3.532-8.103 5.734-9.864 3.957-1.766-1.777.045-6.217 3.612-9.75l.003-.003z","size":20,"color":"crimson"},{"tag":"rails","tech":"Ruby on Rails","name":"M20.8848485 15.8107143v1.1635714h1.9818182c.4060606 0 1.1030303-.315 1.1272727-1.19571427v-.45c0-.75214286-.5818182-1.1957143-1.1272727-1.1957143h-.9878788v-.54h1.9575757v-1.17h-1.8787878c-.4848485 0-1.1333334.42428573-1.1333334 1.215v.405c0 .7907143.6424243 1.1957143 1.1333334 1.1957143 1.3636363.00642857-.3272728 0 .9333333 0v.56571428l-2.0060606.0064286zm-10.6181818-.28285716s1.060606-.09642857 1.060606-1.5492857c0-1.45285715-1.2848485-1.58785715-1.2848485-1.58785715H7.72727273v4.5835714H8.8909091v-1.1057143l1.0060606 1.1057142h1.7212121l-1.3515151-1.4464286zm-.44848488-.93857143H8.8909091v-1.0478571h.93333332s.26060608.1028572.26060608.5207143c0 .4178572-.26666668.5271429-.26666668.5271429zM14.2 12.4228572h-1.1818182c-.8424242 0-1.1272727.81-1.1272727 1.1957143v3.35571427h1.1818182v-.8035714h1.1090909v.8035714h1.1454545V13.6185715c0-.97714286-.8363636-1.1957143-1.1272727-1.1957143zm-.0181818 2.44928572h-1.1151515V13.76s0-.2507143.3696969-.2507143h.4060606c.3272728 0 .3333334.2507143.3333334.2507143v1.11214286h.0060606zm1.6848485-2.44928573h1.230303v4.5514285h-1.230303v-4.5514285zm2.9575757 3.375v-3.375H17.6v4.5514285h2.8787879v-1.1764285h-1.6545455zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76363636.16714284-3.93333333 1.87071427-5.2060606 4.12071427-1.27272726 2.25-1.45454546 4.1528571-1.45454546 4.1528571zM.42424242 16.9742857h4.7878788S4.2969697 12.545 7.3272727 10.75142858c.66060607-.34071428 2.76363638-1.61357143 6.20606058 1.08642857.1090909-.09642857.2121212-.17357143.2121212-.17357143s-3.1515151-3.33642856-6.66060602-2.9635714c-1.76969696.16714284-3.93939393 1.87071427-5.2121212 4.12071427C.6 15.0714285.4242424 16.9742857.4242424 16.9742857zM10.4 9.0607143L10.4242424 8.63c-.0545454-.03214286-.2060606-.1092857-.58787876-.225l-.02424243.4242857c.2.0707143.3939394.14785716.5878788.2314286zM9.82424242 10.42357143l-.02424242.405c.2.00642857.4.03214286.6.07714286l.0242424-.3985715c-.2060606-.045-.4060606-.0707143-.59999998-.0835715zm-2.24242424-2.0057143h.06060606l-.12121212-.39214284c-.1878788 0-.38181818.0128571-.58181818.0385714l.1151515.3792857c.1757576-.0192857.35151517-.0257143.52727274-.0257143zm.2909091 2.3657143l.13939393.44357143c.1757576-.09.3515152-.16714286.5272728-.225l-.1333333-.42428572c-.2060606.06428572-.3818182.135-.5333333.2057143zM5.1212121 9.09285713l-.27272727-.44357142c-.15151515.0835715-.3090909.1735715-.47272727.2764286l.27878787.45c.15757576-.1028571.3090909-.1992857.46666667-.2828571zm1.24242424 2.89285716l.2909091.4628571c.1030303-.1607143.22424242-.3085715.35757575-.4564286L6.7393939 11.555c-.13939394.135-.26666667.28285714-.37575758.4307143zm-.87878788 2.07l.4909091.4114285C6 14.2164285 6.04242424 13.9657143 6.1030303 13.715l-.43636363-.36642857c-.07878788.23785714-.13333334.47571428-.1818182.70714286zM2.830303 11.0021428L2.4 10.60357142c-.15757576.1607143-.3090909.32142858-.44848485.48214287L2.41818182 11.51c.12727273-.17357143.26666666-.34714286.4121212-.50785714zM1 13.8757143l-.6969697-.27c-.1151515.27642856-.24242424.59785713-.3030303.77142856l.6969697.27C.77575758 14.42857143.9030303 14.11357143 1 13.8757143zm4.3939394 1.81285713c.0121212.34071428.04242424.61714286.07272727.81L6.1939394 16.775c-.05454546-.2507143-.10909092-.53357143-.14545455-.8357143l-.65454546-.25071427z","size":20,"color":"#CC0000"},{"tag":"php","tech":"php","name":"M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z","size":20,"color":"#777BB4"},{"tag":"laravel","tech":"Laravel","name":"M23.644 5.43c.009.032.014.065.014.099v5.15c0 .135-.073.26-.189.326l-4.323 2.49v4.934c0 .135-.072.258-.188.326L9.931 23.95c-.021.012-.043.02-.066.027-.008.002-.016.008-.024.01-.063.018-.13.018-.192 0-.011-.002-.02-.008-.029-.012-.021-.008-.043-.014-.063-.025L.534 18.755c-.117-.068-.189-.191-.189-.326V2.974c0-.033.005-.066.014-.098.003-.012.01-.021.014-.032.006-.02.014-.04.023-.058.004-.013.015-.022.023-.033.012-.016.021-.031.033-.045.012-.01.025-.018.037-.027.014-.012.027-.024.041-.034h.001L5.044.05c.115-.067.259-.067.375 0l4.512 2.597h.002c.015.01.027.021.041.033.012.009.025.018.037.027.013.014.021.029.033.045.008.011.02.021.025.033.011.019.017.038.024.058.003.011.011.021.013.032.01.031.014.064.014.098v9.652l3.76-2.164V5.527c0-.033.005-.066.014-.098.003-.011.009-.021.013-.032.007-.02.014-.039.024-.059.007-.012.018-.021.025-.033.012-.015.021-.03.033-.043.012-.012.025-.02.037-.028.014-.011.026-.023.041-.032h.001l4.513-2.598c.116-.067.259-.067.375 0l4.513 2.598c.016.01.027.021.042.031.012.01.025.018.036.028.013.014.022.029.034.044.008.012.019.021.024.033.011.02.018.039.024.059.006.011.012.022.015.033zm-.74 5.032V6.179l-1.578.908-2.182 1.256v4.283l3.76-2.164zm-4.511 7.75v-4.287l-2.146 1.225-6.127 3.498v4.326l8.273-4.762zM1.095 3.624v14.588l8.273 4.762v-4.326l-4.322-2.445-.002-.003h-.002c-.014-.01-.025-.021-.04-.031-.011-.01-.024-.018-.035-.027l-.001-.002c-.013-.012-.021-.025-.031-.039-.01-.012-.021-.023-.028-.037h-.002c-.008-.014-.013-.031-.02-.047-.006-.016-.014-.027-.018-.043-.004-.018-.006-.037-.008-.057-.002-.014-.006-.027-.006-.041V5.789l-2.18-1.257-1.578-.908zM5.231.81l-3.76 2.164 3.76 2.164 3.758-2.164L5.231.81zm1.956 13.505l2.182-1.256V3.624l-1.58.909-2.182 1.256v9.435l1.58-.909zM18.769 3.364l-3.76 2.164 3.76 2.163 3.759-2.164-3.759-2.163zm-.376 4.979l-2.182-1.256-1.579-.908v4.283l2.182 1.256 1.579.908V8.343zm-8.65 9.654l5.514-3.148 2.756-1.572-3.757-2.163-4.324 2.489-3.941 2.27 3.752 2.124z","size":20,"color":"#FF2D20"},{"tag":"cakephp","tech":"CakePHP","name":"M0 13.875v3.745c0 2.067 5.37 3.743 12 3.743V17.62c-6.63 0-12-1.68-12-3.743v-.002zm21.384 2.333L12 13.875v3.745l9.384 2.333C23.02 19.313 24 18.503 24 17.62v-3.745c0 .882-.98 1.692-2.616 2.333zM12 10.133v3.742c-6.627 0-12-1.677-12-3.744V6.38c0-2.064 5.37-3.743 12-3.743 6.625 0 12 1.68 12 3.744v3.75c0 .883-.98 1.69-2.616 2.334L12 10.13v.003z","size":20,"color":"#D33C43"},{"tag":"swift","tech":"Swift","name":"M21.984 16.348c.056-.112.056-.224.112-.336 1.346-5.272-1.851-11.44-7.347-14.693 2.412 3.253 3.365 7.122 2.524 10.599-.056.28-.168.617-.28.897a5.173 5.173 0 0 1-.45-.28S11.104 9.17 5.273 3.282c-.169-.168 3.14 4.71 6.841 8.58-1.738-1.01-6.673-4.542-9.758-7.403.337.617.842 1.234 1.346 1.851 2.58 3.309 5.945 7.346 9.983 10.43-2.86 1.74-6.842 1.851-10.88 0-1.01-.448-1.85-1.009-2.804-1.682 1.682 2.636 4.318 5.048 7.459 6.337 3.757 1.627 7.57 1.515 10.318 0h.057c.112-.056.224-.112.336-.224 1.346-.673 3.982-1.402 5.44 1.402.392.785 1.121-2.86-1.626-6.225z","size":20,"color":"#FA7343"},{"tag":"ios","tech":"iOS","name":"M7.078 23.55c-.473-.316-.893-.703-1.244-1.15-.383-.463-.738-.95-1.064-1.454-.766-1.12-1.365-2.345-1.78-3.636-.5-1.502-.743-2.94-.743-4.347 0-1.57.34-2.94 1.002-4.09.49-.9 1.22-1.653 2.1-2.182.85-.53 1.84-.82 2.84-.84.35 0 .73.05 1.13.15.29.08.64.21 1.07.37.55.21.85.34.95.37.32.12.59.17.8.17.16 0 .39-.05.645-.13.145-.05.42-.14.81-.31.386-.14.692-.26.935-.35.37-.11.728-.21 1.05-.26.39-.06.777-.08 1.148-.05.71.05 1.36.2 1.94.42 1.02.41 1.843 1.05 2.457 1.96-.26.16-.5.346-.725.55-.487.43-.9.94-1.23 1.505-.43.77-.65 1.64-.644 2.52.015 1.083.29 2.035.84 2.86.387.6.904 1.114 1.534 1.536.31.21.582.355.84.45-.12.375-.252.74-.405 1.1-.347.807-.76 1.58-1.25 2.31-.432.63-.772 1.1-1.03 1.41-.402.48-.79.84-1.18 1.097-.43.285-.935.436-1.452.436-.35.015-.7-.03-1.034-.127-.29-.095-.576-.202-.856-.323-.293-.134-.596-.248-.905-.34-.38-.1-.77-.148-1.164-.147-.4 0-.79.05-1.16.145-.31.088-.61.196-.907.325-.42.175-.695.29-.855.34-.324.096-.656.154-.99.175-.52 0-1.004-.15-1.486-.45zm6.854-18.46c-.68.34-1.326.484-1.973.436-.1-.646 0-1.31.27-2.037.24-.62.56-1.18 1-1.68.46-.52 1.01-.95 1.63-1.26.66-.34 1.29-.52 1.89-.55.08.68 0 1.35-.25 2.07-.228.64-.568 1.23-1 1.76-.435.52-.975.95-1.586 1.26z","size":20,"color":"#403f3f"},{"tag":"kotlin","tech":"Kotlin","name":"M1.3 24l11.3-11.5L24 24zM0 0h12L0 12.5zM13.4 0L0 14v10l12-12L24 0z","size":20,"color":"#0095D5"},{"tag":"android","tech":"Android","name":"M24 19H0a13.6 13.6 0 0 1 2.21-6.07A11.2 11.2 0 0 1 5.87 9.4l.41-.23-2.02-3.41a.51.51 0 0 1 .17-.7.5.5 0 0 1 .69.18l2.08 3.5a12.62 12.62 0 0 1 4.84-.9 12.2 12.2 0 0 1 4.75.9l2.07-3.5a.5.5 0 0 1 .7-.17.51.51 0 0 1 .16.7L17.7 9.19l.5.28a11.38 11.38 0 0 1 3.63 3.62A14.48 14.48 0 0 1 24 19zm-7.5-4.48a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1zm-11 0a1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1 1 1 0 0 0-1 1z","size":20,"color":"#3DDC84"},{"tag":"git","tech":"Git","name":"M23.546 10.93L13.067.452c-.604-.603-1.582-.603-2.188 0L8.708 2.627l2.76 2.76c.645-.215 1.379-.07 1.889.441.516.515.658 1.258.438 1.9l2.658 2.66c.645-.223 1.387-.078 1.9.435.721.72.721 1.884 0 2.604-.719.719-1.881.719-2.6 0-.539-.541-.674-1.337-.404-1.996L12.86 8.955v6.525c.176.086.342.203.488.348.713.721.713 1.883 0 2.6-.719.721-1.889.721-2.609 0-.719-.719-.719-1.879 0-2.598.182-.18.387-.316.605-.406V8.835c-.217-.091-.424-.222-.6-.401-.545-.545-.676-1.342-.396-2.009L7.636 3.7.45 10.881c-.6.605-.6 1.584 0 2.189l10.48 10.477c.604.604 1.582.604 2.186 0l10.43-10.43c.605-.603.605-1.582 0-2.187","size":20,"color":"#403f3f"},{"tag":"aws","tech":"AWS","name":"M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167c.279-.144.614-.264 1.005-.36a4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144.287-.096.543-.271.758-.51.128-.152.224-.32.272-.512.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926-.144.272-.336.511-.583.703-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zM21.698 16.207c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zM22.792 14.961c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z","size":20,"color":"#232F3E"},{"tag":"instagram","tech":"Instagram","name":"M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z","size":20,"color":"#E4405F"},{"tag":"facebook","tech":"Facebook","name":"M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z","size":20,"color":"#1877F2"},{"tag":"gitlab ci","tech":"Gitlab CI","name":"M4.844.904a1.007 1.007 0 00-.955.692l-2.53 7.783c0 .007-.005.012-.007.02L.07 13.335a1.437 1.437 0 00.522 1.607l11.072 8.045a.566.566 0 00.67-.004l11.074-8.04a1.436 1.436 0 00.522-1.61l-1.26-3.867a.547.547 0 00-.031-.104l-2.526-7.775a1.004 1.004 0 00-.957-.684.987.987 0 00-.949.69l-2.406 7.408H8.203l-2.41-7.408a.987.987 0 00-.943-.69h-.006zm-.006 1.42l2.174 6.678H2.674l2.164-6.678zm14.328 0l2.168 6.678h-4.342l2.174-6.678zm-10.594 7.81h6.862l-2.15 6.618L12 20.693 8.572 10.135zm-5.515.005h4.322l3.086 9.5-7.408-9.5zm13.568 0h4.326l-6.703 8.588-.709.914 2.959-9.108.127-.394zM2.1 10.762l6.978 8.947-7.818-5.682a.305.305 0 01-.112-.341l.952-2.924zm19.8 0l.952 2.922a.305.305 0 01-.11.341v.002l-7.82 5.68.025-.035 6.953-8.91Z","size":20,"color":"#FCA121"}]}},"allMarkdownRemark":{"totalCount":96,"edges":[{"node":{"excerpt":"Chào mọi người. Hẳn ai làm việc với Vuejs cũng sẽ đã làm việc với Api trong component hoặc vuex rồi. Nhưng bạn đã từng đặt ra câu hỏi, nếu như api đó dùng ở nhiều Component, nhưng ở phía backend lại…","snippet":"<html><head></head><body><p>Ch&#xE0;o m&#x1ECD;i ng&#x1B0;&#x1EDD;i. H&#x1EB3;n ai l&#xE0;m vi&#x1EC7;c v&#x1EDB;i Vuejs c&#x169;ng s&#x1EBD; &#x111;&#xE3; l&#xE0;m vi&#x1EC7;c v&#x1EDB;i Api trong component ho&#x1EB7;c vuex r&#x1ED3;i. Nh&#x1B0;ng b&#x1EA1;n &#x111;&#xE3; t&#x1EEB;ng &#x111;&#x1EB7;t ra c&#xE2;u h&#x1ECF;i, n&#x1EBF;u nh&#x1B0; api &#x111;&#xF3; d&#xF9;ng &#x1EDF; nhi&#x1EC1;u Component, nh&#x1B0;ng &#x1EDF; ph&#xED;a backend l&#x1EA1;i &#x111;&#x1ED5;i endpoint th&#xEC; ch&#xFA;ng ta ph&#x1EA3;i x&#x1EED; l&#xFD;&#x2026;</p></body></html>","html":"<p>Chào mọi người. Hẳn ai làm việc với Vuejs cũng sẽ đã làm việc với Api trong component hoặc vuex rồi. Nhưng bạn đã từng đặt ra câu hỏi, nếu như api đó dùng ở nhiều Component, nhưng ở phía backend lại đổi endpoint thì chúng ta phải xử lý như thế nào? Phải chạy qua từng componet để sửa đường dẫn hay là một cách nào đó. Nếu sử dụng API như trên thì sẽ xảy ra một số vấn đề sau:</p>\n<ul>\n<li>Việc viết API trực tiếp trong component sẽ rất khó cho việc viết unit test.</li>\n<li>Vì API được định nghĩa trong component nên muốn thay đổi API hay logic sẽ phải sửa trong nhiều file khác.\nVà còn rất nhiều vấn đề nữa…</li>\n</ul>\n<p>Sau khi tìm hiểu thì mình thấy có rất nhiều design pattern có thể áp dụng cho việc gọi API. Nhưng có 1 design pattern mà mình thấy tốt nhất đó là <strong>Repository Factory</strong>.</p>\n<h2>I. Mục đích:</h2>\n<ul>\n<li>Biết cách áp dụng design pattern vào việc call API. Đặc biệt là Repository Factory pattern.</li>\n<li>Mặc dù bài viết lấy ví dụ là VueJS nhưng mà Angular, ReactJS đều có thể áp dụng được.</li>\n</ul>\n<h2>II. Vì sao lại dùng Repository Pattern:</h2>\n<p>Mình sẽ dùng repository pattern để truy cập vào tài nguyên theo cách độc lập, không có bất kì logic nào ngoài việc trả về dữ liệu.</p>\n<p>Chắc hẳn mọi người đọc example hay tutorial cũng đều thấy axios luôn được sử dụng trong component. Vậy có vấn đề gì xảy ra chỗ này:</p>\n<ul>\n<li>Điều gì sẽ xảy ra nếu chúng ta muốn tái sử dụng việc call api?</li>\n<li>Điều gì xảy ra nếu endpoint thay đổi?</li>\n<li>Điều gì xảy ra nếu muốn tái sử dụng việc call api cho dự án khác?</li>\n<li>Mình có nhiều hơn 1 cái resource, thế bây giờ phải định nghĩa tận 4 cái endpoint?</li>\n<li>Làm thế nào có thể dùng 1 cái mock api cho việc test?</li>\n</ul>\n<h2>III. Bắt đầu:</h2>\n<h3>1. Tạo file <strong>constants/index.js</strong> để lưu endpoint và một số thông tin cần thiết:</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d05a35b1efabe56cad2bb2678e09df10/1ac29/constant.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.142857142857142%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAf0lEQVQI1y2MTQ6CMBgFuYaglK8mhUKlP4kEEVmYuPD+BxorupjkvUwyhdaa2AUWN6GtR/uZcn5yeLyprhvWZ5dGFj+wxQtrcMxjz2sK+/9u1xnqWmVqCtHCYIYc9YjpkT5wcpFjmKjSjTLdOZuWYA3etogIjVJ7oGl+KPUnBz8H6jti2vjthgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"constant\"\n        title=\"constant\"\n        src=\"/static/d05a35b1efabe56cad2bb2678e09df10/8c557/constant.png\"\n        srcset=\"/static/d05a35b1efabe56cad2bb2678e09df10/4edbd/constant.png 175w,\n/static/d05a35b1efabe56cad2bb2678e09df10/13ae7/constant.png 350w,\n/static/d05a35b1efabe56cad2bb2678e09df10/8c557/constant.png 700w,\n/static/d05a35b1efabe56cad2bb2678e09df10/1ac29/constant.png 1022w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>2. Tạo file <strong>repository/repository.js</strong> để làm nhiệm vụ kết nối tới các resources.</h3>\n<p>Cái này mọi người đặt tên gì cũng được, Service hay là API, cá nhân mình thì nghĩ trong trường hợp này Repository sẽ là 1 cái tên hợp lý\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/534ebf74df256299a2bbd649afc37923/7a1fb/repository.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 159.42857142857144%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAgCAYAAAASYli2AAAACXBIWXMAABYlAAAWJQFJUiTwAAADsUlEQVRIx51W2XLjNhDkZ0QWL1zEQYKkDkralZx1xZX8/x91GpCd9SZWbPmhCyQlNnsGMz0otnbCJm4Rj2fMw4x9CIidgVMSXit4o1DXNaqqyutHKIRxaPsZ6/mIctyj6gK0D5ijh5ISbdPcR6jDgN3TnzCbA5pxB6U1FNVpdSVLRK9knyEtEsEwDBh9h6GTsEogMMyOhEqIu9RlQtN1EJ2DtgZSS6x+W2G9LrEuS5TlfeoyYW0DmnlBGya4cYthf0TXj+gG3jtzJXvnxVsfKFRnEc9/oJv2UCRUiVxpCG2QfmvaFhXV1i+5/CinRUq8prp2uUBc/oL+9oThcEbcH7A5HmHihAf+vo47tK5Hx02UUt1W2NQVpO3hz89w+xP8vEfYHRHniZvl4JjXvuPGpRwrxbyWWfEtlUVDhUpITPMJZn/GasuwtwtTsGAeByybHmPvMPSeFSAhTMdUuNshJ8KW5eGnEWGhumWB3H+HODzCbhYEZ6GlYJELGNlmQvkRoWIoouEfViuUDw9Yc10/rHJ4qXQyqiuq/Gx9O+SWu2hlh8YYVFSTSsU4D0kl9f/UXnUDRQpF1myxpkXJkLRscvIF01BRSV2Vd6FoLcvAD/BDD2U8lfaoqbgUGhXXe1G0XQ/pBjj2s3YBgiXU0nFqZYmvENoIFUb4kYgj1UZolkxS3lBxReJKuU8jh6xCRBgjCSNsP6AlUVJ5/aq9C9eQcw4HtlVPc00h91ld/ZUcSvapovW7cWJPR5JPEEStPXedX+V6D4qau6k4O2IwCF5nxxZ0G2V9NoKavZ7r8ZPIM0VOOwi2WUdn0SRs2Ns1O6hhbb7a1T8d89o1L9f597eF3dFF7OEb7et3jJcnjJsNDTbC0GRTClJOQ7Doe4tp8tmB0n1aY3SwfL+qfrZgYTg/zO5AwkeM3y8Y4pDDdX1PEroMp980BXjOnHSfSBJh7qQ3rfmTkF7nlyMErWs4neHmZF8njLstlmXEctzgdNpgtxtxPM75Wbru+J6mV7Zt84tRFMkMDo8nDHRnzd2WHAVic2KoPqvS9moYPlDhYGF57fg8PUv4t9KiojG4acL28cLTwwnzhr44kpjDy4gWgSrSKUInz1TX6/TMsjLaVmSL+yVkydNB8kJrePTgF1N+kuG+N+maW1b2VmHPFpuGyOnWYLV6yDP5bU4+wn8cO+Xh+fmEHz+WvINV+Xmy98CyoUMzH53RMDx11S+Ho6+i8DQBT9txROlGVDyJNZy79R3nmbf4G6e1hVgT5+UdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"repository\"\n        title=\"repository\"\n        src=\"/static/534ebf74df256299a2bbd649afc37923/8c557/repository.png\"\n        srcset=\"/static/534ebf74df256299a2bbd649afc37923/4edbd/repository.png 175w,\n/static/534ebf74df256299a2bbd649afc37923/13ae7/repository.png 350w,\n/static/534ebf74df256299a2bbd649afc37923/8c557/repository.png 700w,\n/static/534ebf74df256299a2bbd649afc37923/7a1fb/repository.png 1030w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>3. Tiếp theo chúng ta sẽ đi định nghĩa cho từng Entity của project. Ở đây mình ví dụ là <strong>repository/entity/authRepository.js</strong>:</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7258fc20d9c6f25098ec3eca26847d27/05fb0/entity.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABN0lEQVQoz22RXW7DIBCEc44YDAZjbP5jW0maRFUfev8rTRfSRorUh9EuWvMxOz4kG3FLV8TrA/nzG/n2hX1/wNkF5xhxzx4fOcBNBnZUmEcNISWEEP/qYLVFMB5mtJh9whQytI9QSmNSE6xWcEZjIdBcgdTXi33f/ysCTrisG0oo2E5XLC7QBdmGjHVgnKNjjPpaOY7U83amWe1pXr+tterQix7Je6Qlod/vpAckwUt2GBePLm7oygXH9Qa1BBQ7whhav+xwpx2S1v+DNofDMGBbE3IgALmb1gumtMJYC6U12KDA1QimDWU3QEnRIFIp0nP9N2Bz6DxOlJ8oZwhyORAwJQdDD3RhRZfPL4fZmpapNpQ5OZxjfq3cgJpcVJc1I15z488q6KFanxJN9YJ4/QDxm7V4A/4AtZXHnrQTO70AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"entity\"\n        title=\"entity\"\n        src=\"/static/7258fc20d9c6f25098ec3eca26847d27/8c557/entity.png\"\n        srcset=\"/static/7258fc20d9c6f25098ec3eca26847d27/4edbd/entity.png 175w,\n/static/7258fc20d9c6f25098ec3eca26847d27/13ae7/entity.png 350w,\n/static/7258fc20d9c6f25098ec3eca26847d27/8c557/entity.png 700w,\n/static/7258fc20d9c6f25098ec3eca26847d27/e996b/entity.png 1050w,\n/static/7258fc20d9c6f25098ec3eca26847d27/05fb0/entity.png 1138w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>4. Tiếp theo chúng ta sẽ đi định nghĩa <strong>Factory</strong> để đăng ký và gọi repository ở <strong>repository/factory.js</strong>:</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/804c6323c6537cf7eaebf9df8222385f/a4262/factory.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABo0lEQVQoz4WS63KbMBCFeYkkgG6ABAhxszDGxk4ddybJTH/0/R/ndCFN61wm+fHNHjHs0V4UnNoZbVGjcjXa+Qx/eUZ3uqA53KPa7mHpu7c9fLVBniU4tA6jK9E7C6kUhBCQUv4j0FkOoRLITENp84LJodIUCbEkKamQLP9QQposWhJqPX803BygXQc23oPtzpDTGeJwgWl61HVDxtma9Aq/0q9m16ZBUxaYmgpGZ8i7Ae3xgv78SPEBbjfD+hGC8zdVXPOhQiU5OIsh/yLiiAhfNGPgZHad9N7gPYHQFlwXiMsacV6BF/8ROqeZJchoZowu4nTBd6ZBR9s0fof052+kp0cwPyM6PiH68Qvx9IDUT6g2W9h+QFHVX7a/Go7ewZYGrvOwtAiVZOCuB+vGNUa1R9LSbPcn2G7zvWEYx4iJKLojQpoZtUVahjdrVIQIb8FubxCHd282/BnB1Ixo6GEPzmOsB9S2BdsewQei34H7PcQwr9oNI70GvVailvf5CUFbNjCphjUWjpZiMkOtdmu7onQQluZmG3DShma4LOmrlv8AD9E2eLsinsQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"factory\"\n        title=\"factory\"\n        src=\"/static/804c6323c6537cf7eaebf9df8222385f/8c557/factory.png\"\n        srcset=\"/static/804c6323c6537cf7eaebf9df8222385f/4edbd/factory.png 175w,\n/static/804c6323c6537cf7eaebf9df8222385f/13ae7/factory.png 350w,\n/static/804c6323c6537cf7eaebf9df8222385f/8c557/factory.png 700w,\n/static/804c6323c6537cf7eaebf9df8222385f/a4262/factory.png 814w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>5. Áp dụng vào trong component:</h3>\n<ul>\n<li>Gọi repository <strong>auth</strong> từ factory:</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b95803a130b3a002114d079b19fd4723/65654/comp1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABE0lEQVQY0z2Q226DMBAF+Y8C5k5ssM0thEBCoGmVh/b/f2dqoSoPq5X2YXbO8dK8pLQTmR5I0ow4y4mSFBHFRHFMkhfHLRSCWCREIiKJhNsC3w8IgoAwDN/b00XNo12RDmwuM+32wiw7el6pxhlzf2KnFSU1Y9XQypqxPjFoRZ7EBzh8Q/+Be/tAZiWqG+i+fg9wN9yw7UhnagYpueqWyUg3iqupeHSai62OJB++72z9w9KzJ83TGerK0m/ftKszcmbdeaEZrgzWsujOQZRLUjMfQMXNwUYHtqcCK52MUkctXioNql0QzYVw+yG4vxDTTjhtlE2PdZGb+RMzLpzvO52rwg4jt6Xn0mhW96S3mqIojth/sI6YIcNKzUUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"comp1\"\n        title=\"comp1\"\n        src=\"/static/b95803a130b3a002114d079b19fd4723/8c557/comp1.png\"\n        srcset=\"/static/b95803a130b3a002114d079b19fd4723/4edbd/comp1.png 175w,\n/static/b95803a130b3a002114d079b19fd4723/13ae7/comp1.png 350w,\n/static/b95803a130b3a002114d079b19fd4723/8c557/comp1.png 700w,\n/static/b95803a130b3a002114d079b19fd4723/65654/comp1.png 872w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>Gọi dùng hàm <strong>login</strong> của repository <strong>auth</strong>:</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a5cbc8ec72d80d3db91c62d276841fa/350de/comp2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACT0lEQVQ4y5VU2XLbMBDzb9S6b5Ki7tNKfGSSzrT//0EoSCdpmjZu8oBZymMtASxWu1YPaIoKh2pEJRXSOELg+/DfwfO8v377F3bDw08o3WKpNHSeopU5giCA67rwnT28/bfXZqb+DzvR9Dg8nDDOHXQtIYocNRunSQKvWxBN9zzHn2dYVQKX84TvTyvriLrvoccDinqAaHtMd3eI49iyDsPA1lvYJRkZTTOmdcB2vsNy3NAOLTJVwzfSHQeO477CWnGLYRhTmuwhxg318QlFOyOtJ8jljHZZMQ4lhqHCPDesNaQUNz3dRVGMRCgkUiMpBCLjHZmZF8IwpNzI1ii6wpxv+Wkbqn7Ccrmg3e6htzMyxsejNO8DFrditAuC0Gbv8TJgXBe0hxNyxigMfHrG2HjulzJJhgwyZYSavq0XiMsPVGyq2gGKzxntcF3n40EY1n8Mhc3SNEUsSoT00W1mZGVF2SWj0yFlCqz8j8L80vSZtZVcMMwrp9h2DaSuEWUCCS8JfPNCYBUYmBgZXJ+vyt7bcJXMP6mCW1IxFpQqSlYlWCk3VciqDmraYLYqZRKMAjWuKPsZHnPqvhmUbWhkB5mETzhCw8sl8jyB2aKmkai5kmVZoCg1UqUhutFaktIiyUtiE7X3DKOG6zYdUR4fMXJbtq3H6WHDdDpj2DboUiLJc4IMaYvJbJwXtrHp8cbDgMZnSMuGAS+husHKMdP1KDfkp819Xjmzhmbi7n7/+2yj9Uayok92yrzFfZnmc/Vf8ImvzCvDoiis5K+8dAu/AJtZ/i4vzE8BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"comp2\"\n        title=\"comp2\"\n        src=\"/static/9a5cbc8ec72d80d3db91c62d276841fa/8c557/comp2.png\"\n        srcset=\"/static/9a5cbc8ec72d80d3db91c62d276841fa/4edbd/comp2.png 175w,\n/static/9a5cbc8ec72d80d3db91c62d276841fa/13ae7/comp2.png 350w,\n/static/9a5cbc8ec72d80d3db91c62d276841fa/8c557/comp2.png 700w,\n/static/9a5cbc8ec72d80d3db91c62d276841fa/350de/comp2.png 998w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Nhìn vào chúng ta thấy khá là dễ hiểu phải không nào? Vì phần logic đã được tách ra ở 1 chỗ khác nên việc dùng 1 endpoint khác là một việc không hề khó.</p>\n<h2>IV. Kết luận:</h2>\n<p>Hiện tại pattern này mình đang áp dụng vào dự án thấy có thể control và scale ổn. Nhưng điều đó cũng không có nghĩa là nó phù hợp với dự án của bạn được. Nên các bạn cần đánh giá về độ phức tạp của dự án trước để đưa ra một giải pháp phù hợp. Cảm ơn mọi người đã đọc bài viết.</p>\n<p><code class=\"language-text\">[[author | Tran Van Tuan Anh ]]</code></p>","id":"ff76991c-1815-5c5e-883f-41a9a991fe34","frontmatter":{"title":"Call API in Vuejs with Repository Pattern","date":"04-12-2021","tags":["Javascript","Vuejs"]},"fields":{"slug":"/call-api-in-vuejs-with-repository-pattern/","readingTime":{"text":"3 min read"}}}},{"node":{"excerpt":"1. Giới thiệu Khi xây dựng ứng dụng web mà có kết nối đến database, bạn cần và luôn luôn phải cân nhắc đến 2 mục tiêu đó là: Hai mục tiêu này có thể có ảnh hưởng mạnh đến hiệu năng ứng dụng của bạn…","snippet":"<html><head></head><body><h3>1. Gi&#x1EDB;i thi&#x1EC7;u</h3> <p>Khi x&#xE2;y d&#x1EF1;ng &#x1EE9;ng d&#x1EE5;ng web m&#xE0; c&#xF3; k&#x1EBF;t n&#x1ED1;i &#x111;&#x1EBF;n database, b&#x1EA1;n c&#x1EA7;n v&#xE0; lu&#xF4;n lu&#xF4;n ph&#x1EA3;i c&#xE2;n nh&#x1EAF;c &#x111;&#x1EBF;n 2 m&#x1EE5;c ti&#xEA;u &#x111;&#xF3; l&#xE0;:</p> <p>Hai m&#x1EE5;c ti&#xEA;u n&#xE0;y c&#xF3; th&#x1EC3; c&#xF3; &#x1EA3;nh h&#x1B0;&#x1EDF;ng m&#x1EA1;nh &#x111;&#x1EBF;n hi&#x1EC7;u n&#x103;ng &#x1EE9;ng d&#x1EE5;ng c&#x1EE7;a b&#x1EA1;n. Ch&#xFA;ng ta th&#x1B0;&#x1EDD;ng kh&#xE1;&#x2026;</p></body></html>","html":"<h2>1. Giới thiệu</h2>\n<p>Khi xây dựng ứng dụng web mà có kết nối đến database, bạn cần và luôn luôn phải cân nhắc đến 2 mục tiêu đó là:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">  Sử dụng một số lượng tối thiểu query.\n  Sử dụng bộ nhớ ít nhất có thể.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Hai mục tiêu này có thể có ảnh hưởng mạnh đến hiệu năng ứng dụng của bạn.\nChúng ta thường khá tốt về mục tiêu thứ nhất, chúng ta nhận thức được về vấn đề N+1 và sử dụng kỹ thuật gọi là eager-loading để giảm thiểu số lượng database query. Nhưng với mục tiêu thứ hai thì không phải ai cũng nhận thức được. Thực tế, trong một số trường hợp việc giảm số lượng query có thể làm tốn thêm rất nhiều bộ nhớ.</p>\n<h2>2. Đặt vấn đề</h2>\n<p>Cho ví dụ sau. Bạn có một trang danh sách users trong web app, thể hiện thông tin user và lần login cuối cùng của user. Nghe có vẻ đơn giản nhưng thực tế thì nó có một số sự phức tạp thú vị.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Name            | Email                       | Last Login\n-----------------------------------------------------------------------\nJonathan        | jonathan@reinink.com        | Jun 2, 2018 at 5:30am\nAdam Wathan     | admawathan@reinink.com      | Nov 2, 2018 at 8:30am\nTaylor Otwell   | taylo.otwell@laravel.com    | Never\nAdam Campbell   | adam.campbell@laravel.com   | Nov 10, 2018 at 12:01pm</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Thông tin login của user sẽ dươch lưu trong bảng <code class=\"language-text\">logins</code>, dưới đây là bảng cơ sở dữ liệu:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">Schema<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'users'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>Blueprint <span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">increments</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'email'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">timestamps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nSchema<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'logins'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>Blueprint <span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">increments</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">integer</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'user_id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'ip_address'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">timestamp</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và đây là model tương ứng và relations:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Model User.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * Relationship logins.\n     *\n     * @return HasMany\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">logins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">hasMany</span><span class=\"token punctuation\">(</span>Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Model Login.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Login</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * Relationship user.\n     *\n     * @return BelongsTo\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">user</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span>User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Vậy làm thế nào đế chúng ta hiển thị trang users như yêu cầu ở trên? Hay cụ thể là làm thế nào để chúng ta lấy ra last login date?\nMột cách đơn giản nhất có thể là:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">email</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span>\n            @<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$lastLogin</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">logins</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$lastLogin</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">created_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            @<span class=\"token keyword\">else</span>\n                Never\n            @<span class=\"token keyword\">endif</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n@<span class=\"token keyword\">endforeach</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Oh, nhưng bạn có thể thấy ngay vấn đề ở đây đó là N+1, với mỗi user được hiển thị chúng ta cần thêm 1 câu query để lấy ra last login date của user đó. Nếu trang của chúng ta có 50 users thì số lượng query sẽ là 51.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"users\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span> <span class=\"token keyword\">where</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">and</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span> <span class=\"token keyword\">where</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">and</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span> <span class=\"token keyword\">where</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">49</span> <span class=\"token operator\">and</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span> <span class=\"token keyword\">where</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">50</span> <span class=\"token operator\">and</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">is</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span> <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Bắt đầu tối ưu lại. Cách đầu tiên đơn giản đó là eager load all Login records:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'logins'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">email</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span>\n            @<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">logins</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">isNotEmpty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">logins</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">sortByDesc</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">created_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            @<span class=\"token keyword\">else</span>\n                Never\n            @<span class=\"token keyword\">endif</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n@<span class=\"token keyword\">endforeach</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Giải pháp này chỉ cần sử dụng 2 câu query, 1 để lấy ra danh sách users và 1 để lấy ra tất cả login records của danh sách users. Tuy nhiên, vấn đề về memory có thể xuất hiện ở đây. Chắc chắn là chúng ta đã tránh được vấn đề N+1, nhưng chúng ta lại tạo ra 1 vấn đề lớn hơn đó là big memory:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Users per page\t            | 50 users\nAverage logins per user\t    | 250 logins\nTotal login records loaded\t| 12,500 records</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Hiện giờ thì chúng ta đang load 12500 login records chỉ để lấy ra last login date cho mỗi user. Điều này không chỉ tiêu tốn bộ nhớ mà còn tốn thời gian tính toán, vì mỗi record sẽ được convert thành Eloquent Model.</p>\n<h2>3. Giải quyết</h2>\n<h3>3.1. Caching</h3>\n<p>Bạn có thể suy nghĩ, \"Không có vấn đề gì lớn cả, tôi sẽ cache lại last login\":</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\">Schema<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'users'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>Blueprint <span class=\"token variable\">$table</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token variable\">$table</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">integer</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'last_login_id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Khi user logged in, chúng ta sẽ tạo mới một bản ghi Login và update khóa ngoại last<em>login</em>id trên bảng users. Chúng ta sẽ tạo 1 relationship gọi là lastLogin và eager load nó:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'lastLogin'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Đây là một giải pháp đúng đắn. Nhưng thực tế caching thường không đơn giản như thế này.</p>\n<h3>3.2. Subquery</h3>\n<p>Có một cách giải quyết khác đó là sử dụng subquery. Subquery cho phép chúng ta select thêm các extra columns ngay trong câu query chính. Laravel hỗ trợ subquery qua method selectSub:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$lastLogin</span> <span class=\"token operator\">=</span> Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereColumn</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'user_id'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'users.id'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'users.*'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">selectSub</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$lastLogin</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'last_login_at'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n@<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">email</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span>\n            @<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">last_login_at</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">last_login_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            @<span class=\"token keyword\">else</span>\n                Never\n            @<span class=\"token keyword\">endif</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n@<span class=\"token keyword\">endforeach</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Trong ví dụ này chúng ta thực tế chưa sử dụng relationship. Ở đây chúng ta mới chỉ sử dụng subquery để lấy last login date của mỗi user như một thuộc tính của user, hãy xem câu lệnh SQL thực tế được chạy:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">select</span>\n    <span class=\"token string\">\"users\"</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">select</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span>\n        <span class=\"token keyword\">where</span> <span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"users\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"id\"</span>\n        <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span>\n        <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token string\">\"last_login_at\"</span>\n<span class=\"token keyword\">from</span> <span class=\"token string\">\"users\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Kỹ thuật này giúp cải thiện đáng kể hiệu năng khi chúng ta đã đạt được cả 2 mục tiêu đó là giảm số lượng query và memory, cộng thêm là chúng ta không cần dùng đến cache.</p>\n<h3>3.3. Macro</h3>\n<p>Trước khi đi xa hơn, tôi muốn show cho bạn một macro tôi thường sử dụng để làm cho việc sử dụng subquery ngắn gọn hơn. Macro được khai báo trong AppServiceProvider@boot:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span>Query<span class=\"token punctuation\">\\</span>Builder</span><span class=\"token punctuation\">;</span>\n\nBuilder<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">macro</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'addSubSelect'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$column</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_null</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">columns</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">from</span><span class=\"token punctuation\">.</span><span class=\"token single-quoted-string string\">'.*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">selectSub</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">limit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$column</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và bây giờ chúng ta có thể sử dụng macro:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">addSubSelect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'last_login_at'</span><span class=\"token punctuation\">,</span> Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereColumn</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'user_id'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'users.id'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>3.4. Scopes</h3>\n<p>Thêm một bước nữa là đóng gói subquery trong User model scope để đơn giản hóa controller và có thể tái sử dụng:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Model User.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * Create scope.\n     * @param $query query\n     *\n     * @return query\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeWithLastLoginDate</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addSubSelect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'last_login_at'</span><span class=\"token punctuation\">,</span> Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'created_at'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereColumn</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'user_id'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'users.id'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withLastLoginDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>3.5. Dynamic relationship</h3>\n<p>Vâng, bây giờ là đến phần chúng ta đang xây dựng. Sử dụng subquery để lấy last login date thì ok rồi nhưng nếu chúng ta muốn thêm một số thông tin khác về login thì sao? Ví dụ, có thể chúng ta sẽ muốn hiện thông tin IP của login. Làm thế nào đây?</p>\n<p>Một lựa chọn đó là viết thêm 1 model scope nữa:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withLastLoginDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">withLastLoginIpAddress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">last_login_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">last_login_ip_address</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Và dĩ nhiên cách này hoạt động được, nhưng có lẽ là tốt hơn nếu có cách nào để lấy trực tiếp từ model Login, đặc biệt là khi model có sử dụng các accessors hay relationship.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withLastLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">lastLogin</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">created_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>  <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">lastLogin</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">ip_address</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Chúng ta sẽ bắt đầu định nghĩa một relationship mới lastLogin belongs to relationship. Thông thường để khai báo relationship, table cần có 1 khóa ngoại, ví dụ ở đây là last<em>login</em>id như trong solution sử dụng cache ở trên. Nhưng ở đây, chúng ta không sử dụng cache, thay vào đó sẽ sử dụng subquery.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Model User.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * Relationship lastLogin.\n     *\n     * @return BelongsTo\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">lastLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">belongsTo</span><span class=\"token punctuation\">(</span>Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * Create scope.\n     * @param $query query\n     *\n     * @return query\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scopeWithLastLogin</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">addSubSelect</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'last_login_id'</span><span class=\"token punctuation\">,</span> Login<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'id'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">whereColumn</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'user_id'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'users.id'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">latest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">with</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'lastLogin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$users</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withLastLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">&lt;</span>table<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>th<span class=\"token operator\">></span>Name<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>th<span class=\"token operator\">></span>Email<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>th<span class=\"token operator\">></span>Last Login<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>th<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n    @<span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span> <span class=\"token keyword\">as</span> <span class=\"token variable\">$user</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">&lt;</span>tr<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">name</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">email</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>td<span class=\"token operator\">></span>\n                @<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">lastLogin</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token variable\">$user</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">lastLogin</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">created_at</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'M j, Y \\a\\t g:i a'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n                @<span class=\"token keyword\">else</span>\n                    Never\n                @<span class=\"token keyword\">endif</span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>tr<span class=\"token operator\">></span>\n    @<span class=\"token keyword\">endforeach</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>table<span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và kết quả là có hai query được thực thi, đầu tiên đó là query lấy users:</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">select</span>\n    <span class=\"token string\">\"users\"</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">select</span> <span class=\"token string\">\"id\"</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span>\n        <span class=\"token keyword\">where</span> <span class=\"token string\">\"user_id\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"users\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"id\"</span>\n        <span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span> <span class=\"token string\">\"created_at\"</span> <span class=\"token keyword\">desc</span>\n        <span class=\"token keyword\">limit</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token string\">\"last_login_id\"</span>\n<span class=\"token keyword\">from</span> <span class=\"token string\">\"users\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nó khá giống với subquery select last login date, chỉ thay login date bằng login id. Từ đó chúng ta có column last<em>login</em>id mà không cần sử dụng cache.</p>\n<p>Và query thứ hai sẽ tự đông được chạy khi chúng ta eager load with('lastLogin'):</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-sql line-numbers\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"logins\"</span> <span class=\"token keyword\">where</span> <span class=\"token string\">\"logins\"</span><span class=\"token punctuation\">.</span><span class=\"token string\">\"id\"</span> <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> <span class=\"token number\">676</span><span class=\"token punctuation\">,</span> <span class=\"token number\">686</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Subquery cho phép chúng ta select duy nhất 1 bảng ghi last login của user và sử dụng như model Login.</p>\n<h3>3.6. Lazy-loading dynamic relationship</h3>\n<p>Một điều cần biết đó là bạn không thể sử dụng lazy-loading với kỹ thuật này bởi vì scope withLastLogin không phải là mặc định.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$lastLogin</span> <span class=\"token operator\">=</span> User<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">lastLogin</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// will return null</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Nếu bạn muốn sử dụng lazy loading thì bạn vẫn có thể sử global model scope:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">/**\n * Model User.\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">User</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Model</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">parent</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">boot</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">static</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">addGlobalScope</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$query</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$query</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">withLastLogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Cách này không được tối ưu, cá nhân tối thích eager load dynamic relationship một cách rõ ràng khi cần.</p>\n<h2>4. Tổng kết</h2>\n<p>Mình hy vọng qua bài viết cung cấp cho mọi người cái nhìn tổng quan tốt về cách mọi người có thể sử dụng truy vấn con để tạo mối quan hệ động trong Laravel. Đây là một kỹ thuật mạnh mẽ cho phép mọi người đẩy nhiều công việc hơn vào lớp cơ sở dữ liệu của ứng dụng. Điều này có thể có tác động rất lớn đến hiệu suất bởi cho phép mọi người giảm đáng kể số lượng truy vấn cơ sở dữ liệu được thực thi và bộ nhớ tổng thể được sử dụng.</p>\n<p>Link tham khảo: <a href=\"https://reinink.ca/articles/dynamic-relationships-in-laravel-using-subqueries\">https://reinink.ca/articles/dynamic-relationships-in-laravel-using-subqueries</a></p>\n<p>--- Cảm ơn mọi người đã đọc bài viết của mình. Chúc một ngày vui vẻ!!! ---</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">AnhLee </div><div class=\"custom-block-body\"></div></div>","id":"9a2bd551-f405-5fed-abe6-b1ac46ace4a1","frontmatter":{"title":"Dynamic relationships in Laravel using subqueries","date":"12-04-2021","tags":["php","laravel"]},"fields":{"slug":"/dynamic-relationships-in-laravel-using-subqueries/","readingTime":{"text":"9 min read"}}}},{"node":{"excerpt":"Laravel http client allowing you to quickly make outgoing HTTP requests to communicate with other web applications. Bài viết này mình sẽ giới thiệu về http client phiên bản laravel 8, dùng để tạo HTTP…","snippet":"<div class=\"custom-block-body\"><p>Laravel http client allowing you to quickly make outgoing HTTP requests to communicate with other web applications.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Laravel http client allowing you to quickly make outgoing HTTP requests to communicate with other web applications.</p></div></div>\n<p>Bài viết này mình sẽ giới thiệu về http client phiên bản laravel 8, dùng để tạo HTTP request giúp các web application giao tiếp với nhau.</p>\n<h2>1. Http là gì?</h2>\n<p>HTTP (Hyper Text Transfer Protocol) là một giao thức truyền siêu văn bản (text, image, sound bar, video…) nằm ở tầng ứng dụng (Application layer) của tập giao thức TCP/IP, sử dụng để truyền nhận dữ liệu giữa các hệ thống phân tán thông qua internet, cụ thể giao thức hoạt động theo mô hình Client-Server bằng cách thực hiện các quá trình request-response giữa các hệ thống máy tính khác nhau. Giao thức HTTP quy định cấu trúc của các gói tin và cách thức truyền nhận dữ liệu giữa client và server thông qua môi trường internet. HTTP hiện là nền tảng truyền dẫn dữ liệu của ứng dụng duyệt web hiện nay.</p>\n<h2>2. Http client là gì</h2>\n<p>Khi ta truy cập một website và tương tác với các thành phần của website để gửi thông tin thì bản chất của việc đó là browser thay ta gửi đi các HTTP requests. Khi đó browser mà chúng ta đang dùng đóng vai trò một HTTP client.Bất kỳ phần mềm nào có thể gửi HTTP request và nhận được response từ HTTP server thì đều là HTTP client cả.</p>\n<h2>3. Create http client với PHP</h2>\n<p>Guzzle là một PHP HTTP client giúp gửi các HTTP request giao tiếp với các web application khác trở lên đơn giản.</p>\n<h2>4. Laravel HTTP client</h2>\n<p>Laravel http client sử dụng Guzzle http client giúp việc gửi http request để giao tiếp với các ứng dụng web khác đơn giản dễ dàng. Trước khi sử dụng cần chắc chắn rằng bạn đã cài Guzzle package như để 1 dependency của ứng dụng. Ở các phiên bản laravel mới mặc định package này đã được cài sẵn.</p>\n<h2>5. Tạo Http request với Laravel http client</h2>\n<p>Để tạo http request có thể sử dụng các phương thức, get, post, put, patch, delete được cung cấp sẵn bởi http facade</p>\n<h3>1. Http get request</h3>\n<p>Tạo get request đến trang <a href=\"http://example.com\">http://example.com</a></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>Facades<span class=\"token punctuation\">\\</span>Http</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Tạo get request kèm theo query string, giống như truy cập đến trang <a href=\"http://example.com/users?name=huunv&#x26;page=1\">http://example.com/users?name=huunv&#x26;page=1</a></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Huunv'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'page'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>2. Http post request</h3>\n<p>Sử dụng method post của facade http, dữ liệu gửi lên là một mảng truyền vào ở đối số thứ 2 của hàm, mặc định dữ liệu sẽ gửi theo application/json content type.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>Facades<span class=\"token punctuation\">\\</span>Http</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Steve'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'role'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Network Administrator'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tạo Form URL Encoded Requests, gửi dữ liệu application/x-www-form-urlencoded content type.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">asForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Sara'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'role'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Privacy Consultant'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>3. Http put, patch request</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users/1'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Steve'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'role'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Network Administrator'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">patch</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users/1'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Steve'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'role'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Network Administrator'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>4. Http delete request</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users/1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>5. Add header to http request</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'X-First'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'foo'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token single-quoted-string string\">'X-Second'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'bar'</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'name'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'Taylor'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>6. Create http request với authentication</h3>\n<p>Basic authentication...</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withBasicAuth</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'taylor@laravel.com'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'secret'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Digest authentication...</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withDigestAuth</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'taylor@laravel.com'</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'secret'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Authentication with beaer token</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withToken</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'token'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>7. Set timeout http request</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">timeout</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>8. Guzzle Options</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">withOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token single-quoted-string string\">'debug'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean constant\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com/users'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h3>9. Dumping Requests</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token keyword\">return</span> Http<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">dd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'http://example.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h3>10. Http response</h3>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-php line-numbers\"><code class=\"language-php\"><span class=\"token comment\">// Convert response from http request to string</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">body</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Convert response from http request to array</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">array</span><span class=\"token operator\">|</span>mixed<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Convert response from http request to collection</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> Illuminate\\<span class=\"token package\">Support<span class=\"token punctuation\">\\</span>Collection</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">status</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> int<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response = 200</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">ok</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> bool<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response >=200 and &lt; 300</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">successful</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> bool<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response >=400</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">failed</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> bool<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response >=500</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">serverError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> bool<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Status code of response >=400 and &lt; 500</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">clientError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> bool<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// The header from the response</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$header</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// The headers from the response</span>\n<span class=\"token variable\">$response</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">array</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Lời kết</h2>\n<p>Cảm ơn mọi người đã dành thời gian đọc bài viết của mình. Hi vọng bài viết giúp ích được cho mọi người khi làm các tính năng liên quan đến việc giao tiếp giữa các web application với nhau.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Huunv </div><div class=\"custom-block-body\"></div></div>","id":"902458ab-2e3d-56e5-931f-4d0689135c42","frontmatter":{"title":"Laravel Http Client","date":"07-04-2021","tags":["php","laravel"]},"fields":{"slug":"/laravel-http-client/","readingTime":{"text":"4 min read"}}}},{"node":{"excerpt":"Trong thời kỳ công nghiệp 4.0 như hiện nay, lập trình như một ngành HOT được mọi người nhắm đến. Mọi người đến với lập trình với nhiều mục đích khác nhau. Nhưng... với tôi \"Lập trình là thứ tôi đam mê…","snippet":"<html><head></head><body><p>Trong th&#x1EDD;i k&#x1EF3; c&#xF4;ng nghi&#x1EC7;p 4.0 nh&#x1B0; hi&#x1EC7;n nay, l&#x1EAD;p tr&#xEC;nh nh&#x1B0; m&#x1ED9;t ng&#xE0;nh HOT &#x111;&#x1B0;&#x1EE3;c m&#x1ECD;i ng&#x1B0;&#x1EDD;i nh&#x1EAF;m &#x111;&#x1EBF;n. M&#x1ECD;i ng&#x1B0;&#x1EDD;i &#x111;&#x1EBF;n v&#x1EDB;i l&#x1EAD;p tr&#xEC;nh v&#x1EDB;i nhi&#x1EC1;u m&#x1EE5;c &#x111;&#xED;ch kh&#xE1;c nhau. Nh&#x1B0;ng... v&#x1EDB;i t&#xF4;i &quot;L&#x1EAD;p tr&#xEC;nh l&#xE0; th&#x1EE9; t&#xF4;i &#x111;am m&#xEA; nh&#x1EA5;t , n&#xEA;n t&#xF4;i s&#x1EBD; theo &#x111;u&#x1ED5;i n&#xF3;&#x2026;</p></body></html>","html":"<p>Trong thời kỳ công nghiệp 4.0 như hiện nay, lập trình như một ngành HOT được mọi người nhắm đến. Mọi người đến với lập trình với nhiều mục đích khác nhau. Nhưng... với tôi \"Lập trình là thứ tôi đam mê nhất , nên tôi sẽ theo đuổi nó !\"</p>\n<h3>Giới thiệu</h3>\n<p>Để làm nghề lập trình, trước hết các bạn phải hiểu <strong>thế nào là lập trình viên</strong>. Lập trình viên là người <strong>thiết kế</strong>, <strong>xây dựng</strong> và <strong>bảo trì</strong> các <strong>chương trình máy tính</strong> (phần mềm). Bằng cách <strong>thao tác các đoạn mã</strong> (các ngôn ngữ) trên các công cụ lập trình, họ có thể tạo ra các <strong>chương trình mới</strong>, <strong>sửa lỗi</strong> hay <strong>nâng cấp chương trình</strong> đó để <strong>tăng tính hiệu quả của việc sử dụng máy tính</strong>.</p>\n<h3>Nội dung</h3>\n<h3>Tương lai của nghề lập trình</h3>\n<p>Chỉ trong vòng 3 năm trở lại đây, số lượng việc làm ngành IT gia tăng mạnh mẽ, nhu cầu tuyển dụng IT tăng dần đều qua các năm. Đặc biệt, năm 2020 tăng 45% so với cùng kỳ năm 2018, và dự báo đến năm 2021 thị trường tuyển dụng IT cần tới 350 000 lập trình viên tức tăng gấp 20 lần so với năm 2018. Trong khi đó, hiện tại chúng ta chỉ mới đáp ứng được khoảng 200 000 lập trình viên, tương đương thị trường đang thiếu khoảng 150 000 lập trình viên. Tuy nhiên nhiều chuyên gia nhận định rằng đây chỉ là sự thiếu hụt ngắn hạn.</p>\n<p><em>Mức lương theo cấp bậc</em></p>\n<p><img src=\"https://www.devpro.edu.vn/public/uploads/images/kinda%20useless/1/5.png\"></p>\n<p><em>Năm 2021, nên học lập trình ngôn ngữ nào?</em></p>\n<p><img src=\"https://collegelearners.com/wp-content/uploads/2021/02/best-programming-language-for-beginners.png\"></p>\n<p>Bên cạnh Javascript đang dẫn đầu xu thế công nghệ thế giới, Big Data, Internet of Things (IoT), Docker, điện toán đám mây và an ninh mạng cũng đang là các xu hướng mà các lập trình viên hướng tới. Những công nghệ này góp phần tối ưu hoá cuộc sống thời hiện tại của chúng ta.</p>\n<h3>Ai cũng có thể tiếp cận lập trình</h3>\n<p>Nghề lập trình có lẽ sẽ là tấm vé giúp bạn trở thành một công dân toàn cầu.</p>\n<p>Một điều dễ nhận thấy là công nghệ phần cứng thay đổi với tốc độ quá nhanh, trong khi đó, các công nghệ hay các ngôn ngữ lập trình gần như chẳng mấy thay đổi trong suốt nhiều năm.</p>\n<p>Gần đây, các công ty công nghệ lớn đều muốn xây dựng lợi thế của riêng mình bằng cách tự xây dựng ngôn ngữ mới. Nhưng đừng lo lắng, nếu bạn biết ngôn ngữ Ruby thì về cơ bản, bạn đã biết ngôn ngữ Scala hoặc Golang, hoặc nếu bạn biết C++ thì sẽ chẳng khó khăn gì để học ngôn ngữ Swift của Apple…</p>\n<p>Khoảng 10 năm trước, khi người ta còn nói rằng tiếng Anh là kỹ năng mang lại lợi thế lớn để hội nhập thì giờ nó trở thành một kỹ năng cơ bản nếu bạn muốn có một công việc tốt. Đến thời điểm hiện tại và trong tương lai gần, nếu bạn biết một vài ngôn ngữ lập trình thì đó sẽ là lợi thế cạnh tranh rất lớn để có thể được chấp nhận làm việc ở mọi nơi trên thế giới.</p>\n<p>Dù làm việc ở đâu, các lập trình viên cũng dùng ngôn ngữ lập trình như nhau nên ngôn ngữ lập trình trong tương lai có thể thay thế vai trò của ngoại ngữ như tiếng Anh để trở thành ngôn ngữ quốc tế.</p>\n<h3>Vậy lập trình có phải đích đến ?</h3>\n<p>Trước khi bước vào cuộc đời của một lập trình viên bạn nên tự đặt cho mình những câu hỏi:\nMột người cần học lập trình trong bao nhiêu lâu là đủ? Chỉ bốn năm đại học? Hay bốn năm đại học cộng 3 năm đi làm  (tức bảy năm)? Hay hai tháng sau khi hoàn thành khoá intern Ruby ở Tomosia? Hay đơn giản là 1 tháng (đọc xong “Ruby and Scala”)?  <em><strong>Với lập trình không bao giờ là \"đủ\"!</strong></em>  Bạn đến với lập trình vì kiếm tiền?, vì muốn cống hiến cho xã hội?, v.v\n1234567890JQK xì gì gì đó =)) Tuy nhiên, hãy đến với lập trình bằng sự đam mê vì  <strong>\"đam mê là chìa khóa thành công\"</strong></p>\n<h3>Đam mê là chìa khóa thành công</h3>\n<p><img src=\"https://viblo.asia/uploads/a21b9567-2e71-41db-822e-3c8c714baa00.jpg\"></p>\n<p>Tôi tâm đắc một câu nói rằng:\"  <em>…muốn theo đuổi ngành lập trình nói riêng và bất kỳ ngành nào nói chung, điều quan trọng nhất vẫn là đam mê. Không có đam mê mà chỉ làm việc vì cơm áo gạo tiền thì không “sướng”, và khi đã không “sướng” thì đến một lúc nào đó sẽ cảm thấy nhàm chán. Chỉ có theo đuổi đam mê thì công việc mới bền lâu được…</em>\"</p>\n<p>Bạn có biết:<em>\"Cơ hội thành công khi theo đuổi đam mê sẽ cao gấp 488 lần so với khi theo đuổi kiếm tiền\"</em></p>\n<p>Nghề lập trình không phải là một nghề dễ. Lập trình viên đòi hỏi sự sáng tạo và tư duy logic. Có thể nói, suy nghĩ logic là một điều quan trọng nhất trong lập trình. Bạn phải có đủ nhạy bén, linh hoạt và khả năng phán xét cao để giải quyết một vấn đề triệt để bằng phương pháp logic. Vì thế, nếu không có khả năng suy luận logic thì chắc chắn một điều nghề lập trình không thích hợp với bạn. Bạn sẽ cảm thấy nhàm chán và nhức đầu khi theo đuổi các đoạn code của chương trình, các vấn đề về debug (gỡ rối), về lỗi, về dấu chấm, dấu phẩy…</p>\n<p>Hãy chú ý, ngoài khả năng sáng tạo và logic, bạn cần có các kỹ năng làm việc theo nhóm và độc lập. Đây là yếu tố giúp bạn hoàn thành công việc nhanh hay chậm, khoa học hay không khoa học, hiệu quả hay thất bại. Thời gian rất quan trọng, bạn cần phải lập kế hoạch cụ thể, lên trình tự cho công việc của bạn để bạn hoàn thành dự án đúng quy định.</p>\n<p><strong>Tôi luôn chiêm nghiệm rằng:  <em>\"Kinh nghiệm và tư duy có thể trau dồi theo thời gian, nhưng thứ mà mỗi lập trình viên không thể thiếu đó chính là đam mê\"</em></strong>.</p>\n<h3>Lời kết</h3>\n<p>Lập trình không phải là nghề dễ. Nó sẽ khó với những ai không đam mê. Hãy bỏ qua các giới hạn về thời gian, ngôn ngữ,... Và đến với lập trình bằng cả nhiệt huyết của mình, cánh cửa thành công đang đến gần hơn với bạn rồi đó !!!  </p>\n<p>by Hà Tiến Đạt - Tomosia Việt Nam</p>","id":"30556501-90f8-5db1-b622-4865929b1c86","frontmatter":{"title":"Tôi đến với lập trình là vì đam mê","date":"01-04-2021","tags":["other"]},"fields":{"slug":"/toi-den-voi-lap-trinh-la-vi-dam-me/","readingTime":{"text":"6 min read"}}}},{"node":{"excerpt":"Trong 1 dự án không ít thì nhiều cũng tiềm ẩn các đoạn code vô dụng hoặc duplicate. Hôm nay mình sẽ giới thiệu cho mọi người 2 công cụ để loại bỏ chúng, làm cho project sạch đẹp hơn nhé. Trước mắt…","snippet":"<div class=\"custom-block-body\"><p>Trong 1 d&#x1EF1; &#xE1;n kh&#xF4;ng &#xED;t th&#xEC; nhi&#x1EC1;u c&#x169;ng ti&#x1EC1;m &#x1EA9;n c&#xE1;c &#x111;o&#x1EA1;n code v&#xF4; d&#x1EE5;ng ho&#x1EB7;c duplicate. H&#xF4;m nay m&#xEC;nh s&#x1EBD; gi&#x1EDB;i thi&#x1EC7;u cho m&#x1ECD;i ng&#x1B0;&#x1EDD;i 2 c&#xF4;ng c&#x1EE5; &#x111;&#x1EC3; lo&#x1EA1;i b&#x1ECF; ch&#xFA;ng, l&#xE0;m cho project s&#x1EA1;ch &#x111;&#x1EB9;p h&#x1A1;n nh&#xE9;.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Trong 1 dự án không ít thì nhiều cũng tiềm ẩn các đoạn code vô dụng hoặc duplicate. Hôm nay mình sẽ giới thiệu cho mọi người 2 công cụ để loại bỏ chúng, làm cho project sạch đẹp hơn nhé.</p></div></div>\n<p><strong>Trước mắt cùng tìm hiểu xem khái niệm của 2 loại code trên là gì</strong></p>\n<p>Dead code: Các đoạn mã không thể được thực thi trong project.\nCopy code: Các đoạn mã (gần như) giống hệt nhau được sao chép trong các file. </p>\n<h3>A/ Periphery</h3>\n<img alt=\"Periphery logo\" class=\"uu vi t u v iv aj c\" width=\"289\" height=\"60\" src=\"https://miro.medium.com/max/578/1*Jo7KjUPYaBePkf62KI0OQA.png\" srcset=\"https://miro.medium.com/max/552/1*Jo7KjUPYaBePkf62KI0OQA.png 276w, https://miro.medium.com/max/578/1*Jo7KjUPYaBePkf62KI0OQA.png 289w\" sizes=\"289px\">\n<p>Periphery là một công cụ để xác định dead code. Nó khá thông minh và có thể phát hiện không chỉ các hàm không được sử dụng mà còn cả các cấu trúc, enum và thậm chí là các parameter được khai báo trong các function.</p>\n<h3>1/ Cấu hình</h3>\n<p>Chạy 2 command dưới đây</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">brew tap peripheryapp/periphery</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">brew install periphery</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"https://gyazo.com/be14bac262ea8bc23fdaa3b85736d72b\"><img src=\"https://i.gyazo.com/be14bac262ea8bc23fdaa3b85736d72b.jpg\" alt=\"Image from Gyazo\" width=\"1663\"></a></p>\n<p>Sau khi cài đặt, chúng ta cần phải cấu hình nó. Periphery đi kèm với một quy trình tương tác cho phép bạn tạo cấu hình thích hợp cho dự án của mình. Chúng ta chỉ cần chạy lệnh sau để khởi tạo quá trình:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">periphery scan --verbose --setup</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"https://gyazo.com/a7f6bd759b185d4ecfbc77e069e44460\"><img src=\"https://i.gyazo.com/a7f6bd759b185d4ecfbc77e069e44460.jpg\" alt=\"Image from Gyazo\" width=\"885\"></a></p>\n<p><a href=\"https://gyazo.com/7c42d76afb3c792b86ce31e7332befec\"><img src=\"https://i.gyazo.com/7c42d76afb3c792b86ce31e7332befec.png\" alt=\"Image from Gyazo\" width=\"885\"></a></p>\n<p>--verbose :  Periphery sẽ tạo 1 file yaml. Khi các cấu hình đó được log ra trong console, chúng ta có thể sao chép vào file periphery.yaml: và tuỳ biến thêm nếu muốn.</p>\n<p>--setup: Chỉ cần thêm cờ này cho lần chạy đầu tiên. Vì cờ này được sử dụng để bắt đầu thực thi configuration. </p>\n<h3>2/ Sử dụng</h3>\n<p>Sau lần chạy cấu hình đầu tiên, chúng ta chỉ có thể sử dụng công cụ bằng cách chạy:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">periphery scan</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Đây là kết quả:\n<a href=\"https://gyazo.com/ef5f3d8370095667d954ea5421ea89d2\"><img src=\"https://i.gyazo.com/ef5f3d8370095667d954ea5421ea89d2.jpg\" alt=\"Image from Gyazo\" width=\"1363\"></a></p>\n<p>Nhìn chung, việc có một công cụ như vậy là cực kỳ quan trọng để giảm code dư thừa và đảm bảo rằng  không tồn tại một số code không được sử dụng.</p>\n<h3>B/ Copy-Paste-Detector (CPD)</h3>\n<img alt=\"Logo\" class=\"uu vi t u v iv aj c\" width=\"360\" height=\"264\" src=\"https://miro.medium.com/max/720/1*jELaHRZ6bUher88yYr_Mvw.png\" srcset=\"https://miro.medium.com/max/552/1*jELaHRZ6bUher88yYr_Mvw.png 276w, https://miro.medium.com/max/720/1*jELaHRZ6bUher88yYr_Mvw.png 360w\" sizes=\"360px\">\n<p>Copy-Paste Detector (CPD) là một công cụ có thể sử dụng để phát hiện code đã được sao chép trong project. </p>\n<h3>1/ Cấu hình</h3>\n<p>Công cụ này được viết bằng Java. Do đó, nó yêu cầu một chút công cụ bổ sung</p>\n<ul>\n<li>Tải xuống và cài đặt Java 8 cho Mac. (<a href=\"https://www.java.com/en/download/\">https://www.java.com/en/download/</a>)</li>\n<li>Tải xuống tool từ GitHub(<a href=\"https://github.com/pmd/pmd/releases\">https://github.com/pmd/pmd/releases</a>)</li>\n<li>Giải nén và chạy lệnh trong Terminal:\nopen /usr/local</li>\n<li>Sao chép thư mục lib từ folder đã giải nén vào thư mục lib của đường dẫn / usr / local /.</li>\n<li>Sao chép thư mục bin từ folder đã giải nén vào thư mục bin của đường dẫn / usr / local /. Lưu ý: Bạn nên thay đổi tên của tệp run.sh thành một cái gì đó có ý nghĩa hơn.</li>\n<li>\n<p>Sau các bước này, chúng ta có thể gõ run.sh (hoặc tên bạn đã chọn ở bước trên) để chạy tool.</p>\n<h3>2/ Sử dụng</h3>\n<p>Để sử dụng công cụ này, chúng ta cần điều hướng vào thư mục của dự án Swift của chúng ta.</p>\n</li>\n</ul>\n<p>Sau đó, chúng ta chạy lệnh sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">run.sh cpd --minimum-tokens &lt;N&gt; --files . --language swift</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>--minimum-tokens và --files là bắt buộc.\nVề các parameter, các bạn có thể tìm hiểu thêm ở link sau <a href=\"https://pmd.github.io/latest/pmd_userdocs_cpd.html#cli-options-reference\">https://pmd.github.io/latest/pmd_userdocs_cpd.html#cli-options-reference</a></p>\n<p>Đây là kết quả:\n<a href=\"https://gyazo.com/b13eb1b44f6d665c3013f26d77c28eb7\"><img src=\"https://i.gyazo.com/b13eb1b44f6d665c3013f26d77c28eb7.jpg\" alt=\"Image from Gyazo\" width=\"1307\"></a></p>\n<h3>C/ Tổng kết</h3>\n<p>Những công cụ này có thể được chạy 1-2 tháng một lần. Team có thể lên kế hoạch để dọn dẹp lại code, cải thiện khả năng tư duy, duy trì sự \"sạch sẽ\" trong code và cải thiện chất lượng của dự án.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Quốc Lê - Tomosia Việt Nam </div><div class=\"custom-block-body\"></div></div>","id":"41868d7d-c83a-5d84-8a42-9d4a368807cf","frontmatter":{"title":"Tools for detect dead code and duplicate in Xcode project.","date":"31-03-2021","tags":["iOS"]},"fields":{"slug":"/cong-cu-de-phat-hien-dead-code-va-clone-code-trong-du-an-ios/","readingTime":{"text":"4 min read"}}}},{"node":{"excerpt":"Trước tiên, Medium là gì, thì có lẽ tôi và các bạn cũng không lạ gì nữa. Đó là một kho thông tin đồ sộ. Nhưng dạo này, việc truy cập gặp nhiều khó khăn quá. Đã có rất nhiều phương pháp nhưng đều lỗi…","snippet":"<div class=\"custom-block-body\"><p>Tr&#x1B0;&#x1EDB;c ti&#xEA;n, Medium l&#xE0; g&#xEC;, th&#xEC; c&#xF3; l&#x1EBD; t&#xF4;i v&#xE0; c&#xE1;c b&#x1EA1;n c&#x169;ng kh&#xF4;ng l&#x1EA1; g&#xEC; n&#x1EEF;a. &#x110;&#xF3; l&#xE0; m&#x1ED9;t kho th&#xF4;ng tin &#x111;&#x1ED3; s&#x1ED9;. Nh&#x1B0;ng d&#x1EA1;o n&#xE0;y, vi&#x1EC7;c truy c&#x1EAD;p g&#x1EB7;p nhi&#x1EC1;u kh&#xF3; kh&#x103;n qu&#xE1;. &#x110;&#xE3; c&#xF3; r&#x1EA5;t nhi&#x1EC1;u ph&#x1B0;&#x1A1;ng ph&#xE1;p nh&#x1B0;ng &#x111;&#x1EC1;u l&#x1ED7;i sau m&#x1ED9;t th&#x1EDD;i gian.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Trước tiên, Medium là gì, thì có lẽ tôi và các bạn cũng không lạ gì nữa. Đó là một kho thông tin đồ sộ. Nhưng dạo này, việc truy cập gặp nhiều khó khăn quá. Đã có rất nhiều phương pháp nhưng đều lỗi sau một thời gian.</p></div></div>\n<p><strong>Tôi phải đi tìm cách để có thể truy cập medium.com một cách bình thường thôi.</strong></p>\n<p>Khi truy cập một trang web bị chặn, tôi thường thay đổi DNS, sửa file host hoặc dùng một VPN.</p>\n<p>Với suy nghĩ simple như thế, tôi đã thay đổi DNS để có thể truy cập Medium, nhưng tình hình không khả quan một chút nào.</p>\n<p>Cách thứ 2, tôi thêm vào file host: <code class=\"language-text\">/etc/hosts</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">162.159.152.4 medium.com</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Lần này thì tốt hơn chút, nhưng vẫn có lỗi: <code class=\"language-text\">Secure Connection Failed</code></p>\n<p>Thế thì chỉ còn 1 cách dùng VPN, và tất nhiên <a href=\"https://1.1.1.1\">https://1.1.1.1</a> là phương án đầu tiên tôi nghĩ ra.</p>\n<p>Nó hoạt động tốt. Ơ, thế tại sao lại có bài viết này ? Có cái này thôi cũng phải nói.</p>\n<p>Sau khi sử dụng phương án 1.1.1.1 trên, nó hoạt động. Nhưng với tôi, đó là tốt chứ chưa đủ.</p>\n<p>1.1.1.1 là 1 server nước ngoài, khi bật VPN lên thì mọi traffic của tôi đều phải đi qua nó. Nó dẫn đến một số website hoạt động không nhanh.</p>\n<p>Thế là, tôi nghĩ đến phương án, tìm một VPN có thể chỉ bật khi vào medium.com thôi. Còn các website khác, tôi vẫn truy cập trực tiếp. Ngay lúc này, tôi nghĩ đến tìm extension VPN cho Chrome mà không nghĩ đến phần mềm VPN.</p>\n<p>Có một số lý do:</p>\n<ul>\n<li>Dùng extension thì VPN chỉ tác động lên trình duyệt được cài đặt. Các traffic khác như Git, SVN vẫn hoạt động độc lập mà không bị theo dõi</li>\n<li>Chỉ có trình duyệt mới filter url một cách tốt nhất (cảm quan cá nhân của tôi).</li>\n</ul>\n<h3>Hướng dẫn vào medium.com qua VPN</h3>\n<p>Và sau một hồi lần mò trên <a href=\"https://chrome.google.com/webstore/category/extensions?hl=en\">Chrome Web Store</a> , tôi tìm được một thư viện đúng với yêu cầu của mình <a href=\"https://chrome.google.com/webstore/detail/free-vpn-for-chrome-vpn-p/majdfhpaihoncoakbjgbdhglocklcgno\">Free VPN for Chrome - VPN Proxy VeePN</a></p>\n<p>Dưới đây là hướng dẫn sử dụng, nó không đúng với tên bài viết, nên tôi chỉ nói qua đơn giản thôi</p>\n<ul>\n<li>Step 1: Truy cập vào medium.com và nhấn vào icon của extension</li>\n</ul>\n<img src=\"https://i.ibb.co/mFrWp7Q/Screen-Shot-2021-03-30-at-16-51-20.png\" alt=\"https://i.ibb.co/mFrWp7Q/Screen-Shot-2021-03-30-at-16-51-20.png\" style=\"zoom:33%;\">\n<ul>\n<li>Step 2: Nhấn vào nút khiên như hình trên.</li>\n<li>\n<p>Step 3: Nhấn vào <code class=\"language-text\">Add current site</code></p>\n<img src=\"https://i.ibb.co/nLddXZw/Screen-Shot-2021-03-30-at-16-59-26.png\" style=\"zoom:50%;\">\n</li>\n<li>\n<p>Step 4: Reload lại website và tận hưởng thành quả nhé</p>\n<p>Hãy để ý, chỉ có website bạn cho vào danh sách, VPN mới bật <img src=\"https://i.ibb.co/XxW7Yz4/Screen-Shot-2021-03-30-at-17-02-28.png\" style=\"zoom: 50%;\"></p>\n<p>Còn các website khác, VPN trong trạng thái tắt, không làm ảnh hưởng đến trải nghiệm sử dụng internet của các bạn</p>\n</li>\n</ul>","id":"071f468d-ad6d-5f08-98e9-511be40b14b9","frontmatter":{"title":"I'm trying to figure out how to access the blocked website, include Medium","date":"30-03-2021","tags":["medium"]},"fields":{"slug":"/toi-da-di-tim-cach-truy-cap-website-bi-chan-nhu-the-nao-trong-do-co-medium/","readingTime":{"text":"3 min read"}}}},{"node":{"excerpt":"Navigation Component là 1 libs xịn xò do chủ nhà Google cung cấp, giúp anh em lập trình viên dễ dàng navigate, pass-data, add animation ... giữa các màn. Tuy nhiên sau khi sử dụng, mình gặp phải 1 vài…","snippet":"<div class=\"custom-block-body\"><p>Navigation Component l&#xE0; 1 libs x&#x1ECB;n x&#xF2; do ch&#x1EE7; nh&#xE0; Google cung c&#x1EA5;p, gi&#xFA;p anh em l&#x1EAD;p tr&#xEC;nh vi&#xEA;n d&#x1EC5; d&#xE0;ng navigate, pass-data, add animation ... gi&#x1EEF;a c&#xE1;c m&#xE0;n. Tuy nhi&#xEA;n sau khi s&#x1EED; d&#x1EE5;ng, m&#xEC;nh g&#x1EB7;p ph&#x1EA3;i 1 v&#xE0;i Issues &#x111;&#x1ED1;i v&#x1EDB;i lib n&#xE0;y.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Navigation Component là 1 libs xịn xò do chủ nhà Google cung cấp, giúp anh em lập trình viên dễ dàng navigate, pass-data, add animation ... giữa các màn. Tuy nhiên sau khi sử dụng, mình gặp phải 1 vài Issues đối với lib này.</p></div></div>\n<p>Còn nếu bạn chưa biết về Navigation Component, có thể tham khảo docx của google: <a href=\"https://developer.android.com/guide/navigation\">https://developer.android.com/guide/navigation</a><br></br></p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://www.youtube.com/embed/Y0Cs2MQxyIs\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<h1>1. Lỗi khi người dùng nhấn nút chuyển màn quá nhanh:</h1>\n<p>Lỗi này xảy ra khi action có sử dụng animation. Ở đây mình ví dụ có 2 sự kiện click để navigate từ màn A sang màn B, và từ màn A sang màn C</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">val action1 <span class=\"token operator\">=</span> AFragmentDirections.actionAFragmentToBFragment<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nfindNavController<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.navigate<span class=\"token punctuation\">(</span>action1<span class=\"token punctuation\">)</span>\n<span class=\"token builtin class-name\">.</span>\n<span class=\"token builtin class-name\">.</span>\nval action2 <span class=\"token operator\">=</span> AFragmentDirections.actionAFragmentToCFragment<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nfindNavController<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.navigate<span class=\"token punctuation\">(</span>action2<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Khi người dùng click để <strong>navigate(1)</strong> từ A sang B và đồng thời tiếp tục click để <strong>navigate(2)</strong> sang C. Hệ thống sẽ nhận sự kiện navigate(1) trước, nhưng cũng đồng thời chạy sự kiện navigate(2). Khi đó hệ thống sẽ nhận destination ở B, nên sự kiện navigate(2) không thể xử lý và gây ra crash:\n<code class=\"language-text\">action_aFragment_to_bFragment cannot be found from the current destination Destination</code><br>\nĐể giải quyết ta có 2 solution như sau:</p>\n<h2>Chặn multi-click và chặn click khi đang navigate (khi animation đang chạy):</h2>\n<p>Thêm thuộc tính block multi touch vào <code class=\"language-text\">themes.xml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">    &lt;style name=&quot;Theme.MyStyle&quot; parent=&quot;Theme.MaterialComponents.Light.NoActionBar&quot;&gt;\n        ...\n        &lt;!--Block multi touch--&gt;\n        &lt;item name=&quot;android:splitMotionEvents&quot;&gt;false&lt;/item&gt;\n        ...\n    &lt;/style&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Tạo biến check <code class=\"language-text\">isNavigate</code> và xử lý không cho click khi <code class=\"language-text\">isNavigate == true</code> ở Activity:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">    var isNavigating = false\n    override fun dispatchTouchEvent(ev: MotionEvent?): Boolean {\n        return if (isNavigating) {\n            true\n        } else {\n            super.dispatchTouchEvent(ev)\n        }\n    }</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Ở Fragment, ta lắng nghe việc Animation có đang được thực hiện hay không, rồi thay đổi biến <code class=\"language-text\">isNavigate</code> ở Activity.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">    override fun onCreateAnimation(transit: Int, enter: Boolean, nextAnim: Int): Animation? {\n        if (nextAnim == 0 || !enter) return super.onCreateAnimation(transit, enter, nextAnim)\n        else {\n            return AnimationUtils.loadAnimation(requireContext(), nextAnim).apply {\n                setAnimationListener(object : Animation.AnimationListener {\n                    override fun onAnimationStart(animation: Animation?) {\n                        (activity as MainActivity)?.isNavigating = true\n                    }\n                    override fun onAnimationEnd(animation: Animation?) {\n                        (activity as MainActivity).isNavigating = false\n                    }\n                    override fun onAnimationRepeat(animation: Animation?) {\n                    }\n                })\n            }\n        }\n    }</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Tạo function safe-navigate:</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">    fun Fragment.safeNavigateFromNavController(directions: NavDirections) {\n        val navController = findNavController()\n        val nav = navController.currentDestination\n        if (nav is FragmentNavigator.Destination &amp;&amp; javaClass.name == nav.className) {\n            navController.navigate(directions)\n        }\n    }</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Function này giúp ta check đc, destination có đang ở A hay không, nếu không thì sẽ không thực hiện việc navigate.\nTa thay thế <code class=\"language-text\">findNavController().navigate(action)</code> như sau:</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">val action1 = AFragmentDirections.actionAFragmentToBFragment()\nsafeNavigateFromNavController(action1)\n.\n.\nval action2 = AFragmentDirections.actionAFragmentToCFragment()\nsafeNavigateFromNavController(action2)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>2. Bất tiện trong việc tái sự dụng màn và action:</h2>\n<p>Khi sử dụng lại 1 dãy fragment của 1 <strong>nav_</strong> khác, bạn cần phải khai báo lại toàn bộ <strong>id</strong> của fragment, <strong>id</strong> của action, <strong>name and type</strong> của argument giống hệt với các thông số của <strong>nav_</strong> đó, thì mới có thể sử dụng navigate theo cách khai báo direction. Nếu không IDE sẽ báo error ngay khi compile vì nó chỉ nhận direction của 1 bên nav.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">var object = Object(1,&quot;Hello&quot;)\nval action = AFragmentDirections.actionAFragmentToCFragment(object)\nfindNavController().navigate(action)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Bạn có thể pass data theo cách khai báo bundle, làm điều này sẽ không cần thiết cần phải khai báo các thông số giống nhau nữa:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">var object = Object(1,&quot;Hello&quot;)\nval bundle = bundleOf(&quot;{name_of_argument}&quot; to object)\t\nfindNavController().navigate(R.action.{id_of_action})</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<blockquote>\n<p>Tuy nhiên khi khai báo qua bundle rất dễ bị sai sót trong việc viết code</p>\n</blockquote>\n<h2>3. Chỉ có thể replace hoặc add fragment:</h2>\n<p>Đúng vậy, khi sử dụng navigation component, bạn chỉ có thể chọn 1 trong 2 loại là <strong>add</strong> hoặc <strong>replace</strong> fragment.<br></br>\nĐiều này xảy ra khá nhiều khó khăn, ví dụ như khi <strong>replace</strong>, nếu cần <code class=\"language-text\">swipe to back</code> thì do màn sau đã thay thế màn trước, nên khi swipe, màn dưới đã destroy nên sẽ hiển thị trắng<br></br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0a71dc6b0f3af0103a0f8ca1baab4750/47311/swipte_empty.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 205.71428571428575%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAApABQDASIAAhEBAxEB/8QAGQAAAwEBAQAAAAAAAAAAAAAAAAIFAwEE/8QAFgEBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHJ2coHpGYbo7VY1EgvS4upoH//xAAeEAABAwQDAAAAAAAAAAAAAAACEBEyAAEDEhMUMf/aAAgBAQABBQLjChxBt18CBNkCe1kCbWQJsSD7X//EABYRAAMAAAAAAAAAAAAAAAAAAAAgIf/aAAgBAwEBPwEq/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAdEAACAgEFAAAAAAAAAAAAAAABEABxICIxMjOR/9oACAEBAAY/AuIg0idQ8Qti2LYub4f/xAAcEAACAwADAQAAAAAAAAAAAAAAARARoSFBYZH/2gAIAQEAAT8hKdW6rQ4lhDs+cjCPJ/IwjyjCO60iP//aAAwDAQACAAMAAAAQsB8zwC//xAAWEQEBAQAAAAAAAAAAAAAAAAAQEQD/2gAIAQMBAT8Q1Ef/xAAWEQADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQIBAT8Qln//xAAeEAEAAgIDAQEBAAAAAAAAAAABABEhMRBR8HFBYf/aAAgBAQABPxDDWH5Go0SVsuIcrXDzO4jLd4/jjzO5YtV2l2zx5ncAKBXHudwS0Cq1ijP5iOmafpNJ/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"swipte_empty.jpg\"\n        title=\"swipte_empty.jpg\"\n        src=\"/static/0a71dc6b0f3af0103a0f8ca1baab4750/29d31/swipte_empty.jpg\"\n        srcset=\"/static/0a71dc6b0f3af0103a0f8ca1baab4750/e52aa/swipte_empty.jpg 175w,\n/static/0a71dc6b0f3af0103a0f8ca1baab4750/70ebb/swipte_empty.jpg 350w,\n/static/0a71dc6b0f3af0103a0f8ca1baab4750/29d31/swipte_empty.jpg 700w,\n/static/0a71dc6b0f3af0103a0f8ca1baab4750/9ecec/swipte_empty.jpg 1050w,\n/static/0a71dc6b0f3af0103a0f8ca1baab4750/47311/swipte_empty.jpg 1080w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span> <br></br>\nCòn khi <strong>add</strong>, nếu add quá nhiều fragment, quá nhiều backstack sẽ dẫn đến việc sử dụng quá nhiều bộ nhớ, giảm hiệu năng app.</p>\n<h2>Kết luận:</h2>\n<p>Trong bài viết này, mình đã nêu các vấn đề của Navigation Architecture Component mà mình đã gặp phải và cách giải quyết.<br> <br>\nThanks for reading. Bye! See you later.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Hung Nguyen 1 </div><div class=\"custom-block-body\"></div></div>","id":"d5ff1595-0e07-51d9-9992-6499b600888c","frontmatter":{"title":"Issues about Navigation Component","date":"29-03-2021","tags":["android","kotlin"]},"fields":{"slug":"/issues-about-navigation-component/","readingTime":{"text":"4 min read"}}}},{"node":{"excerpt":"Sử dụng RecyclerView để tạo hiệu ứng paging, scale animation giống như ViewPager. Ngoài ra còn có thể tùy chỉnh nhiều thứ hơn... 1. Mục đích Tạo ra một ứng dụng đơn giản : Hiển thị ảnh dưới dạng page…","snippet":"<div class=\"custom-block-body\"><p>S&#x1EED; d&#x1EE5;ng RecyclerView &#x111;&#x1EC3; t&#x1EA1;o hi&#x1EC7;u &#x1EE9;ng paging, scale animation gi&#x1ED1;ng nh&#x1B0; ViewPager. Ngo&#xE0;i ra c&#xF2;n c&#xF3; th&#x1EC3; t&#xF9;y ch&#x1EC9;nh nhi&#x1EC1;u th&#x1EE9; h&#x1A1;n...</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Sử dụng RecyclerView để tạo hiệu ứng paging, scale animation giống như ViewPager. Ngoài ra còn có thể tùy chỉnh nhiều thứ hơn...</p></div></div>\n<h2>1. Mục đích</h2>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 206.89655172413794%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://giphy.com/embed/3Fu63e8GAbVLZwflgn\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe><p><a href=\"https://giphy.com/gifs/3Fu63e8GAbVLZwflgn\"></a></p> </div>\n<p>Tạo ra một ứng dụng đơn giản :</p>\n<ul>\n<li>Hiển thị ảnh dưới dạng page.</li>\n<li>Hoạt ảnh hấp dẫn : ảnh chính được phóng to và hiển thị ở trung tâm, ảnh phụ thu nhỏ</li>\n<li>\n<p>Ảnh được giữ nguyên tỷ lệ khung hình.\nThông thường trong trường hợp này chúng ta sẽ sử dụng ViewPager2. Nhưng sử dụng ViewPager2 thì bạn sẽ gặp rất nhiều vấn đề liên quan đến xử lý ảnh như : kích thước, tỷ lệ ảnh tùy biến,...\nVì thế chúng ta sẽ xử dụng RecyclerView vạn năng, dễ dàng tùy chỉnh để tạo ra một ví dụ đơn giản cho một ứng dụng trình chiếu ảnh.</p>\n<h2>2. Khởi tạo project</h2>\n<p>Ở project này mình sẽ sử dụng một RecyclerView với thuộc tính :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">android:layout_width=&quot;match_parent&quot;\nandroid:layout_height=&quot;wrap_content&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Item đổ vào RecyclerView mình để một ImageView với thuộc tính :</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">android:layout_width=&quot;wrap_content&quot;\nandroid:layout_height=&quot;wrap_content&quot;\nandroid:scaleType=&quot;fitXY&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Như vậy các ảnh hiển thị lên bây giỡ sẽ có khung hình tương ứng với kích thước của nó.\nTiếp theo chúng ta sẽ cần thêm nguồn ảnh để hiển thị. Mình sẽ xử dụng ảnh từ một nguồn free khá hay từ trang <a href=\"https://unsplash.com/developers\">https://unsplash.com/developers</a>, các bạn có thể tham khảo cách setup từ tài liệu có sẵn của họ. Sử dụng retrofit2 để lấy data và sau đó sử dụng Glide để load ảnh lên mình có kết quả như sau đây.</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 206.89655172413794%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://giphy.com/embed/nAVO6aTjIgov1Ey9nd\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe><p><a href=\"https://giphy.com/gifs/nAVO6aTjIgov1Ey9nd\"></a></p> </div>\n</li>\n</ul>\n<p><a href=\"https://github.com/LamPham030921/PagerWithRecyclerView/tree/set_up_project\">Source Code Setup Project</a></p>\n<h2>3. Chỉnh sửa kích thước ảnh</h2>\n<p>Sửa lại thuộc tính chiều cao của RecyclerView thành giá trị cố định </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">android:layout_height=&quot;@dimen/recycler_height&quot;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Trong onBindViewHolder của PhotoAdapter, ta thêm đoạn code</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">val recyclerHeight = \nit.context.resources.getDimensionPixelSize(R.dimen.recycler_height)\nval percent: Float = photo.width!!.toFloat() / photo.height!!.toFloat()\nit.layoutParams =  ConstraintLayout.LayoutParams((recyclerHeight * percent).toInt(), recyclerHeight)</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Như vậy chúng ta đã thay đổi lại kích thước của các ảnh mà vẫn giữ nguyên tỷ lệ. Ngoài ra mình cũng sẽ thêm vào một callback để thực hiện load thêm ảnh mỗi khi người dùng cuộn đến gần cuối của list ảnh hiện tại </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">private fun initRecyclerViewItemListener() {\n        val layoutManager = binding.rvPhotos.layoutManager as LinearLayoutManager  \n        binding.rvPhotos.addOnScrollListener(object : RecyclerView.OnScrollListener() {  \n            override fun onScrolled(recyclerView: RecyclerView, dx: Int, dy: Int) {  \n                super.onScrolled(recyclerView, dx, dy)  \n                val lastPosition = layoutManager.findLastCompletelyVisibleItemPosition()  \n                if (lastPosition == listPhoto.size - 2) viewModel.loadMoreImage()  \n            }  \n        })\n       }</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Và kết quả....</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 206.89655172413794%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://giphy.com/embed/iLcllIzqpGuRDKwFHw\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe><p><a href=\"https://giphy.com/gifs/iLcllIzqpGuRDKwFHw\"></a></p> </div>\n<p><a href=\"https://github.com/LamPham030921/PagerWithRecyclerView/tree/fix_photo_size\">Source Code Fix Image Size</a></p>\n<h2>4. Hiệu ứng phân trang</h2>\n<p>Hiện tại RecyclerView đang được cuộn một cách tự do nhưng chúng ta cần phải hiển thị ảnh đang được chọn một cách nổi bật ở trung tâm. Thật may là RecyclerView đã hỗ trờ chúng ta việc phân trang bằng cách sử dụng <code class=\"language-text\">SnapHelpers</code>.Chỉ với một  dòng code đơn giản : <code class=\"language-text\">PagerSnapHelper().attachToRecyclerView(binding.rvPhotos)</code>\nNhư vậy chúng ta đã có khả năng phân trang cũng như hiển thị ảnh hiện tại ở chính giữa như hiệu ứng mà ViewPager mang lại.\nTiếp đến chúng ta sẽ custom thêm<code class=\"language-text\">ProminentLayoutManager</code> kế thừa từ <code class=\"language-text\">LinearLayoutManager</code> để tạo hiệu ứng cho RecyclerView.\nChi tiết bạn có thể xem trong <code class=\"language-text\">PhotosAdapter</code> . Trong đó quan trọng nhất là thuộc tính <code class=\"language-text\">scaleDownBy</code>, thuộc tính này thể hiện cho độ chênh lệch giữa item được làm nổi bật và các item phụ ( Được tính : item phụ sẽ bằng 1 - <code class=\"language-text\">scaleDownBy</code> * 100%).\nMình sẽ để chênh lệch là 30 % : <code class=\"language-text\">private val scaleDownBy: Float = 0.3f</code></p>\n<p>Thành quả thu được ...</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 206.89655172413794%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://giphy.com/embed/kzLXEKad2mzOzvgrpY\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe><p><a href=\"https://giphy.com/gifs/kzLXEKad2mzOzvgrpY\"></a></p> <p><a href=\"https://github.com/LamPham030921/PagerWithRecyclerView/tree/add_paging\">Soucre Code Add Paging </a></p> </div>\n<h2>5. Hoàn thiện</h2>\n<p>Một lỗi nhỏ gặp phải khi thực hiện hiệu ứng phóng to - thu nhỏ là khoảng trắng chúng ta đặt để phân chia các item nhỏ cũng sẽ bị thay đổi theo.\nChúng ta sẽ xử lý bằng cách tính toán đoạn khoảng trắng bị phóng to ra của item chính giữa <code class=\"language-text\">translationXFromScale</code>. Sau đó thêm nó vào cho item phụ bị thu nhỏ .\nCuối cùng chúng ta thêm một callback để lắng nghe khi RecyclerView ngừng cuộn thì chúng ta sẽ đặt background là hình ảnh đang ở trung tâm của RecyclerView.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">override fun onScrollStateChanged(recyclerView: RecyclerView, newState: Int) {  \n        super.onScrollStateChanged(recyclerView, newState)  \n        if (newState == RecyclerView.SCROLL_STATE_IDLE) {  \n            val firstPosition = layoutManager.findFirstCompletelyVisibleItemPosition()  \n            Glide.with(context!!).load(listPhoto[firstPosition].urls?.regular)  \n                .into(binding.ivBackground)  \n        }  \n    }</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Thành quả cuối cùng mà chúng ta thu được.</p>\n<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 206.89655172413794%; position: relative; height: 0; overflow: hidden; \" > <iframe src=\"https://giphy.com/embed/3Fu63e8GAbVLZwflgn\" frameborder=\"0\" class=\"giphy-embed\" allowfullscreen style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe><p><a href=\"https://giphy.com/gifs/3Fu63e8GAbVLZwflgn\"></a></p> <p><a href=\"https://github.com/LamPham030921/PagerWithRecyclerView/tree/fix_scale_space\">Source Code Final Version</a></p> </div>\n<h2>6. Tổng Kết</h2>\n<p>Qua bài viết mình đã giới thiệu qua cho mọi người một phương pháp để tạo ra một hiệu ứng khá thú vị và rất dễ chỉnh sửa. Mong nhận được sự ủng hộ cũng như nhận xét của mọi người.\nHẹn gặp lại mọi người ở các bài viết sau.\nLink bài viết gốc : <a href=\"https://medium0.com/m/global-identity?redirectUrl=https%3A%2F%2Fproandroiddev.com%2Fpaging-image-gallery-with-recyclerview-f059d035b7e7\">https://medium0.com/m/global-identity?redirectUrl=https%3A%2F%2Fproandroiddev.com%2Fpaging-image-gallery-with-recyclerview-f059d035b7e7</a></p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Lam Pham </div><div class=\"custom-block-body\"></div></div>","id":"57bfa062-ae24-50df-a391-d4fb49e587e2","frontmatter":{"title":"Paging Image with RecyclerView","date":"29-03-2021","tags":["kotlin","android"]},"fields":{"slug":"/paging-image-with-recyclerview/","readingTime":{"text":"5 min read"}}}},{"node":{"excerpt":"Laravel Mix là một công cụ để biên dịch và tối ưu hóa nội dung trong dự án Laravel. Nó tương tự như một công cụ xây dựng như gulp, Grunt,... Với những dự án nhỏ thì có vẻ bạn cảm thấy không có gì khác…","snippet":"<div class=\"custom-block-body\"><p>Laravel Mix l&#xE0; m&#x1ED9;t c&#xF4;ng c&#x1EE5; &#x111;&#x1EC3; bi&#xEA;n d&#x1ECB;ch v&#xE0; t&#x1ED1;i &#x1B0;u h&#xF3;a n&#x1ED9;i dung trong d&#x1EF1; &#xE1;n Laravel. N&#xF3; t&#x1B0;&#x1A1;ng t&#x1EF1; nh&#x1B0; m&#x1ED9;t c&#xF4;ng c&#x1EE5; x&#xE2;y d&#x1EF1;ng nh&#x1B0; gulp, Grunt,... V&#x1EDB;i nh&#x1EEF;ng d&#x1EF1; &#xE1;n nh&#x1ECF; th&#xEC; c&#xF3; v&#x1EBB; b&#x1EA1;n c&#x1EA3;m th&#x1EA5;y kh&#xF4;ng c&#xF3; g&#xEC; kh&#xE1;c bi&#x1EC7;t l&#x1EAF;m, nh&#x1B0;ng v&#x1EDB;i nh&#x1EEF;ng d&#x1EF1; &#xE1;n l&#x1EDB;n th&#xEC; &#x111;i&#x1EC1;u n&#xE0;y th&#x1EF1;c s&#x1EF1; c&#x1EA7;n thi&#x1EBF;t, b&#x1EA1;n s&#x1EBD; th&#x1EA5;y r&#xF5; &#x111;&#x1B0;&#x1EE3;c s&#x1EF1; kh&#xE1;c bi&#x1EC7;t khi ch&#xFA;ng ta t&#x1ED1;i &#x1B0;u n&#xF3;. Vi&#x1EC7;c t&#x1ED1;i &#x1B0;u n&#xE0;y s&#x1EBD; gi&#xFA;p ch&#xFA;ng ta gi&#x1EA3;m k&#xED;ch th&#x1B0;&#x1EDB;c l&#x1B0;u tr&#x1EEF; v&#xE0; t&#x1ED1;i &#x1B0;u b&#x103;ng th&#xF4;ng. Vi&#x1EC7;c l&#xE0;m n&#xE0;y s&#x1EBD; gi&#xFA;p trang web c&#x1EE7;a ch&#xFA;ng ta t&#x1EA3;i nhanh h&#x1A1;n, mang t&#x1EDB;i ng&#x1B0;&#x1EDD;i d&#xF9;ng c&#xF3; tr&#x1EA3;i nghi&#x1EC7;m t&#x1ED1;t h&#x1A1;n. Laravel Mix &#x111;&#x1B0;&#x1EE3;c x&#xE2;y d&#x1EF1;ng d&#xE0;nh ri&#xEA;ng cho Laravel nh&#x1B0;ng c&#x169;ng c&#xF3; th&#x1EC3; &#x111;&#x1B0;&#x1EE3;c s&#x1EED; d&#x1EE5;ng b&#xEA;n ngo&#xE0;i nh&#x1B0; m&#x1ED9;t g&#xF3;i npm.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>Laravel Mix là một công cụ để biên dịch và tối ưu hóa nội dung trong dự án Laravel. Nó tương tự như một công cụ xây dựng như gulp, Grunt,... Với những dự án nhỏ thì có vẻ bạn cảm thấy không có gì khác biệt lắm, nhưng với những dự án lớn thì điều này thực sự cần thiết, bạn sẽ thấy rõ được sự khác biệt khi chúng ta tối ưu nó. Việc tối ưu này sẽ giúp chúng ta giảm kích thước lưu trữ và tối ưu băng thông. Việc làm này sẽ giúp trang web của chúng ta tải nhanh hơn, mang tới người dùng có trải nghiệm tốt hơn. Laravel Mix được xây dựng dành riêng cho Laravel nhưng cũng có thể được sử dụng bên ngoài như một gói npm.</p></div></div>\n<p>Nói ngắn gọn: Laravel Mix quản lý tất cả tài nguyên (assets) như img, css, js trong dự án của bạn, đồng thời nó dựa trên base là webpack build tất cả các file css, js pre-processors như SCSS, SASS thành css, chuyển ES6 thành ES5 (trình duyệt không hiểu cú pháp ES6).</p>\n<h2>I. Cài đặt Laravel Mix</h2>\n<h3>Với Laravel</h3>\n<p>Nếu bạn đang sử dụng Laravel 5.4 trở về sau, thì mix đã được cài đặt. Tất cả những gì bạn phải làm là chạy <code class=\"language-text\">npm install</code>.</p>\n<h3>Với các dự án độc lập</h3>\n<p>Từ gốc ứng dụng của bạn, hãy chạy các commands sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">npm</span> init -y\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> laravel-mix --save-dev\n<span class=\"token function\">cp</span> node_modules/laravel-mix/setup/webpack.mix.js ./</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Trong file <code class=\"language-text\">package.json</code> hãy thêm đoạn sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token string\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run development\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"development\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env NODE_ENV=development node_modules/webpack/bin/webpack.js --progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"watch\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run development -- --watch\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"hot\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env NODE_ENV=development node_modules/webpack-dev-server/bin/webpack-dev-server.js --inline --hot --config=node_modules/laravel-mix/setup/webpack.config.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"prod\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm run production\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"production\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env NODE_ENV=production node_modules/webpack/bin/webpack.js --no-progress --hide-modules --config=node_modules/laravel-mix/setup/webpack.config.js\"</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>II. Configure Laravel Mix</h2>\n<p>Chúng ta có thể cấu hình và gọi các phương thức khác nhau để biên dịch các tệp CSS, JS và đưa vào một thư mục public. Các file được tạo ra bao gồm các file đã cấu hình bên trong tệp <code class=\"language-text\">webpack.mix.js</code>. Tệp tin <code class=\"language-text\">webpack.mix.js</code> sẽ nằm trong thư mục gốc của dự án Laravel. Hãy coi tệp này là cơ sở chính của bạn cho tất cả cấu hình front-end.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> mix <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'laravel-mix'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmix<span class=\"token punctuation\">.</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/js/app.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/js'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/sass/app.scss'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/css'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nó đã được preconfigured để compile 1 file ở resources/js/app.js vào file public/js và resources/sass/app.scss vào public/css.<br>\nCó rất nhiều phương thức Mix khác và bạn có thể thấy tất cả các methods đó trong file default webpack.mix.js.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">// Full API</span>\n<span class=\"token comment\">// mix.js(src, output);</span>\n<span class=\"token comment\">// mix.react(src, output); &lt;-- Identical to mix.js(), but registers React Babel compilation.</span>\n<span class=\"token comment\">// mix.preact(src, output); &lt;-- Identical to mix.js(), but registers Preact compilation.</span>\n<span class=\"token comment\">// mix.coffee(src, output); &lt;-- Identical to mix.js(), but registers CoffeeScript compilation.</span>\n<span class=\"token comment\">// mix.ts(src, output); &lt;-- TypeScript support. Requires tsconfig.json to exist in the same folder as webpack.mix.js</span>\n<span class=\"token comment\">// mix.extract(vendorLibs);</span>\n<span class=\"token comment\">// mix.sass(src, output);</span>\n<span class=\"token comment\">// mix.less(src, output);</span>\n<span class=\"token comment\">// mix.stylus(src, output);</span>\n<span class=\"token comment\">// mix.postCss(src, output, [require('postcss-some-plugin')()]);</span>\n<span class=\"token comment\">// mix.browserSync('my-site.test');</span>\n<span class=\"token comment\">// mix.combine(files, destination);</span>\n<span class=\"token comment\">// mix.babel(files, destination); &lt;-- Identical to mix.combine(), but also includes Babel compilation.</span>\n<span class=\"token comment\">// mix.copy(from, to);</span>\n<span class=\"token comment\">// mix.copyDirectory(fromDir, toDir);</span>\n<span class=\"token comment\">// mix.minify(file);</span>\n<span class=\"token comment\">// mix.sourceMaps(); // Enable sourcemaps</span>\n<span class=\"token comment\">// mix.version(); // Enable versioning.</span>\n<span class=\"token comment\">// mix.disableNotifications();</span>\n<span class=\"token comment\">// mix.setPublicPath('path/to/public');</span>\n<span class=\"token comment\">// mix.setResourceRoot('prefix/for/resource/locators');</span>\n<span class=\"token comment\">// mix.autoload({}); &lt;-- Will be passed to Webpack's ProvidePlugin.</span>\n<span class=\"token comment\">// mix.webpackConfig({}); &lt;-- Override webpack.config.js, without editing the file directly.</span>\n<span class=\"token comment\">// mix.babelConfig({}); &lt;-- Merge extra Babel configuration (plugins, etc.) with Mix's default.</span>\n<span class=\"token comment\">// mix.then(function () {}) &lt;-- Will be triggered each time Webpack finishes building.</span>\n<span class=\"token comment\">// mix.override(function (webpackConfig) {}) &lt;-- Will be triggered once the webpack config object has been fully generated by Mix.</span>\n<span class=\"token comment\">// mix.dump(); &lt;-- Dump the generated webpack config object to the console.</span>\n<span class=\"token comment\">// mix.extend(name, handler) &lt;-- Extend Mix's API with your own components.</span>\n<span class=\"token comment\">// mix.options({</span>\n<span class=\"token comment\">//   extractVueStyles: false, // Extract .vue component styling to file, rather than inline.</span>\n<span class=\"token comment\">//   globalVueStyles: file, // Variables file to be imported in every component.</span>\n<span class=\"token comment\">//   processCssUrls: true, // Process/optimize relative stylesheet url()'s. Set to false, if you don't want them touched.</span>\n<span class=\"token comment\">//   purifyCss: false, // Remove unused CSS selectors.</span>\n<span class=\"token comment\">//   terser: {}, // Terser-specific options. https://github.com/webpack-contrib/terser-webpack-plugin#options</span>\n<span class=\"token comment\">//   postCss: [] // Post-CSS options: https://github.com/postcss/postcss/blob/master/docs/plugins.md</span>\n<span class=\"token comment\">// });</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Với các phương thức này, bạn có thể gói gọn nhiều nhất có thể và không cần phải lo lắng về webpack build căn bản.</p>\n<h3>Một số phương thức hay được sử dụng</h3>\n<p>Laravel có các phương thức như <code class=\"language-text\">less()</code>, <code class=\"language-text\">sass()</code>, <code class=\"language-text\">stylus()</code> để hỗ trợ compile các css pre-prosessor ra các file css mà trình duyệt có thể hiểu được. Cú pháp thực hiện như sau:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">mix<span class=\"token punctuation\">.</span><span class=\"token function\">less</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/style.less'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/assets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmix<span class=\"token punctuation\">.</span><span class=\"token function\">sass</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/style.less'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/assets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmix<span class=\"token punctuation\">.</span><span class=\"token function\">stylus</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/style.less'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/assets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Để compile các file css thông thường thành 1 file ta dùng phương thức <code class=\"language-text\">styles()</code>, và tương tự với js ta dùng <code class=\"language-text\">scripts()</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">mix<span class=\"token punctuation\">.</span><span class=\"token function\">styles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'resources/assets/css/bootstrap-datepicker.css'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'resources/assets/css/jquery.timepicker.min.css'</span>\n <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/css/datetimepicker.css'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmix<span class=\"token punctuation\">.</span><span class=\"token function\">scripts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n     <span class=\"token string\">'resources/assets/js/bootstrap-datepicker.js'</span><span class=\"token punctuation\">,</span>\n     <span class=\"token string\">'resources/assets/js/jquery.timepicker.min.js'</span>\n <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/js/datetimepicker.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Hoặc chỉ đơn giản là <code class=\"language-text\">copyDirectory()</code> (copy thư mục) hay <code class=\"language-text\">copy()</code> (copy file):</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">mix<span class=\"token punctuation\">.</span><span class=\"token function\">copyDirectory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/admin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/assets/admin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmix<span class=\"token punctuation\">.</span><span class=\"token function\">copy</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/admin.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/assets/admin.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Đánh dấu phiên bản đầu ra:<br>\nTính năng này khá hay. Thông thường các trình duyệt sẽ cache các file css, js trong một khoảng thời gian. Để khắc phục điều này ta sẽ dùng phương thức <code class=\"language-text\">version()</code>. Phương thức này sẽ ép trình duyệt xóa cache và tải các file với phiên bản mới nhất. Phương thức này sẽ thêm một mã hash tại thời điểm chạy.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">mix<span class=\"token punctuation\">.</span><span class=\"token function\">js</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resources/assets/js/app.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public/js'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">version</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Để biết kết quả sau khi sử dụng phương thức <code class=\"language-text\">version()</code> bạn hãy tìm đến file <code class=\"language-text\">mix-manifest.json</code> trong thư mục public. Nó sẽ trông như thế này.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token string\">\"/static/js/app.js\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/static/js/app.js?id=8b71863dc9a7570ebc77\"</span><span class=\"token punctuation\">,</span> \n<span class=\"token string\">\"/static/css/app.css\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/static/css/app.css?id=b8a621a46db684d19bc4\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Khi sử dụng phương thức <code class=\"language-text\">version()</code> bạn cần lấy được version của laravel mix hiện tại. Laravel hỗ trợ việc này, đơn giản bạn chỉ cần gọi phương thức <code class=\"language-text\">mix()</code> trong view của mình.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{{ mix('/css/app.css') }}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>III. Compiling</h2>\n<p>Sau khi configure những file cần mix trong ứng dụng của bạn, có rất nhiều commands mà chúng ta có thể chạy để có thể build file này.\nCũng giống như composer sử dụng file composer.json để quản lý các package, npm sử dụng file package để quản lý các các thư viện được sử dụng trong dự án. Một số commands cơ bản để compiling bạn có thể thấy chúng trong file package.json đã được đề cập trong phần cài đặt laravel mix.</p>\n<ul>\n<li><code class=\"language-text\">npm run dev</code> Câu lệnh này sẽ thực thi mix các file một lần.</li>\n<li><code class=\"language-text\">npm run watch</code> Câu lệnh này sẽ thực thi mix các file hiện tại và theo dõi các file cần mix (là những file trong thư mục webpack.mix.js) khi có sự thay đổi thì nó sẽ mix cho chúng ta luôn. Cái này chúng ta rất hay sử dụng trong dự án.</li>\n<li><code class=\"language-text\">npm run hot</code> Câu lệnh này thực thi tất cả các tác vụ mix nhưng vẫn active và theo dõi sự thay đổi các tài nguyên, nếu có sự thay đổi, nó thực hiện cập nhật chỉ các module có sự thay đổi, sau đó nó báo cáo với ứng dụng về sự thay đổi và cập nhật mã trong trình duyệt mà không có tải lại tài nguyên.</li>\n<li><code class=\"language-text\">npm run prod</code> Thực thi tất cả các tác vụ Mix và tối ưu (minify) các file kết quả đầu ra, khi đó bạn có thể sử dụng các kết quả để triển khai ứng dụng trên máy chủ.</li>\n</ul>\n<p>Đây là kết quả sau khi sử dung <code class=\"language-text\">npm run prod</code> trong dự án của mình.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 695px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/49ac074436f05eeb4a740d86c2db28c1/83b75/laravel-mix.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABB0lEQVQY00WQWXLEIAxEfZqUAbPaCONlMl+5/406jTyVfHQ1CJBeM9WfL/jsKIslUsk8TrlodG+MgbXuI/vnoz7Ps7pzT21aPB8v/2pNkFLk2kFkw7qurDU+sB859RCC1vd91zuj2TibUrKo1bJoIXQRj5wWbGtAbwnej31GYIooVpMUUufk2axrw967DlBCqQbnbdAP+mWwHzNKcTj2iOuIeimGhCQO67dB5NC2GazF47peOM8T7/dbKUf0yS8P2aBs8qwj/69uJCDtiBdjQuCQ1Bi18KwYTSHSKFHKUor+5zSm7d3gIN1xck1lPhpx7zNrwxTzQ/h6CGX9EN4vUl646SN2rRW/45+71GGLaLoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"laravel-mix.png\"\n        title=\"laravel-mix.png\"\n        src=\"/static/49ac074436f05eeb4a740d86c2db28c1/83b75/laravel-mix.png\"\n        srcset=\"/static/49ac074436f05eeb4a740d86c2db28c1/4edbd/laravel-mix.png 175w,\n/static/49ac074436f05eeb4a740d86c2db28c1/13ae7/laravel-mix.png 350w,\n/static/49ac074436f05eeb4a740d86c2db28c1/83b75/laravel-mix.png 695w\"\n        sizes=\"(max-width: 695px) 100vw, 695px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>IV. Kết luận</h2>\n<p>Trong bài viết này, chúng ta đã tìm hiểu cách làm việc với Laravel Mix trong các ứng dụng để giúp cho việc biên dịch css, js,.. trở nên dễ dàng. Bài viết này chỉ là phần giới thiệu cơ bản, để tìm hiểu thêm về Laravel Mix bạn hãy truy cập <a href=\"https://laravel.com/docs/8.x/mix\">trang tài liệu</a> chính thức của Laravel hoặc truy cập <a href=\"https://laravel-mix.com/docs/3.0/installation\">trang web</a> Laravel Mix.<br>\nHy vọng sau bài viết này, mọi người có thể áp dụng được Laravel Mix vào các dự án của mình. Mong nhận được nhiều đóng góp từ mọi người để các bài viết sau có thể hoàn thiện hơn ạ.</p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Phu Thai </div><div class=\"custom-block-body\"></div></div>","id":"ff25fe25-6507-5327-a939-18a5115d054d","frontmatter":{"title":"How to use Laravel Mix for compiling assets","date":"21-03-2021","tags":["php","laravel"]},"fields":{"slug":"/how-to-use-laravel-mix-for-compiling-assets/","readingTime":{"text":"7 min read"}}}},{"node":{"excerpt":"LocalStorage, SessionStorage và cookie là ba cách lưu trữ dữ liệu khác nhau trong trình duyệt. 1. localStorage Bạn có thể lưu trữ giá trị các biến vào localStorage của trình duyệt, biến đã lưu vào đây…","snippet":"<div class=\"custom-block-body\"><p>LocalStorage, SessionStorage v&#xE0; cookie l&#xE0; ba c&#xE1;ch l&#x1B0;u tr&#x1EEF; d&#x1EEF; li&#x1EC7;u kh&#xE1;c nhau trong tr&#xEC;nh duy&#x1EC7;t.</p></div>","html":"<div class=\"custom-block snippet\"><div class=\"custom-block-body\"><p>LocalStorage, SessionStorage và cookie là ba cách lưu trữ dữ liệu khác nhau trong trình duyệt.</p></div></div>\n<h2>1. localStorage</h2>\n<ul>\n<li>Bạn có thể lưu trữ giá trị các biến vào localStorage của trình duyệt, biến đã lưu vào đây thì không bị quá hạn. Biến sẽ tồn tại cho đến khi bạn xóa nó bằng JavaScript hoặc xóa cache của trình duyệt.</li>\n<li>localStorage cho phép bạn lưu thông tin tương đối lớn, lên đến 10MB.</li>\n<li>Các biến trong localStorage không được trình duyệt gửi lên server như cookie.</li>\n</ul>\n<h4>Cách xem các biến localStorage</h4>\n<ul>\n<li>Để xem localStorage bằng trình duyệt các bạn vào trang web cần xem rồi click chuột phải vào tràn web cần xem sau đó chọn Inspect rồi chọn mục Application khi đó chúng ta sẽ thấy biến phần lưu biến localStorage.</li>\n<li>Bạn sẽ thấy các biến và giá trị của  nó, có thể xóa nếu muốn.</li>\n</ul>\n<h4>Cách lưu giá trị của biến vào localStorage</h4>\n<ul>\n<li>Dùng 1 trong 3 cách sau:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlocalStorage<span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">;</span>\nlocalStorage<span class=\"token punctuation\">[</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Trong đó: key là tên biến, value là giá trị của biến.</li>\n</ul>\n<h4>Cách lấy giá trị biến trong localStorage</h4>\n<ul>\n<li>Để lấy giá trị localStorage, dùng 1 trong 2 cách:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlocalStorage<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h4>Cách xóa biến trong localStorage</h4>\n<ul>\n<li>Để xóa 1 biến trong localStorage, sử dụng removeItem(tên_key):</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">removeItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlocalStorage<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// xóa tất cả các biến trong localStorage</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2>2. Session Storage</h2>\n<ul>\n<li>SessionStorage là nơi lưu trữ biến trong trình duyệt. Dữ liệu bạn lưu ở đây sẽ tự động bị xóa khi đóng tab. Các biến trong sessionStorage không được gửi lên Server khi request. Thông tin lưu trữ trong sessionStorage lưu nhiều hơn cookie (lớn nhất 5MB)</li>\n</ul>\n<h4>Cách xem các biến sessionStorage</h4>\n<ul>\n<li>Tương tự như xem các ở phần localStorage thì ta chọn vào phần sessionStorage.</li>\n</ul>\n<h4>Cách lưu giá trị của biến vào sessionStorage</h4>\n<ul>\n<li>Ta có 3 cách sau bạn có thể dùng 1 trong 3 cách sau.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">sessionStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsessionStorage<span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">;</span>\nsessionStorage <span class=\"token punctuation\">[</span><span class=\"token string\">'key'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h4>Cách lấy ra biến trong sessionStorage</h4>\n<ul>\n<li>Để lấy giá trị của 1 biến trong sessionStorage, dùng 1 trong 2 cách:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">sessionStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsessionStorage<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h4>Xóa biến trong sessionStorage</h4>\n<ul>\n<li>Để xóa 1 biến trong sessionStorage, sử dụng removeItem(tên_key)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">sessionStorage<span class=\"token punctuation\">.</span><span class=\"token function\">removeItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsessionStorage<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// xóa tất cả các biến trong sessionStorage</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<ul>\n<li>Dữ liệu được lưu trong localStorage là tách biệt theo domain của website. Do đó, website A không thể truy xuất dữ liệu trong localStorage của website B và ngược lại. Đây là một tính năng bảo mật quan trọng. Ngay cả sub-domain cũng được coi như một domain name riêng.</li>\n<li>Giới hạn của LocalStorage là khác nhau giữa các trình duyệt, thường từ 5MB đến 10MB. Vì LocalStorage chỉ dùng lưu data dưới dạng từng cặp key-value, nên với kích thước bộ nhớ như vậy là quá đủ với một web app thông thường.</li>\n<li>Với sessionStorage, một trang web được mở trong hai tab của cùng một trình duyệt cũng không thể truy xuất dữ liệu lẫn nhau. Khi bạn đóng trang web thì dữ liệu lưu trong sessionStorage hiện tại bị xóa. Còn với localStorage: có thể truy xuất lẫn nhau giữa các cửa sổ trình duyệt, và dữ liệu sẽ được lưu trữ không giới hạn thời gian.</li>\n</ul>\n<h2>3. Cookie</h2>\n<ul>\n<li>Cookie là nơi lưu trữ các biến đặc biệt trong trình duyệt, nó có thời điểm quá hạn và nó được http gửi tự động lên server mỗi khi có request từ client. Đây là 2 điểm mà cookie khác với localStorage và sessionStorage.</li>\n<li>Cookie chỉ có thể lưu trữ tối đa 4KB với vài chục biến cookie cho một domain.</li>\n</ul>\n<h4>Tạo biến cookie</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">document.cookie = &#39;username=teo&#39;;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>có thể tạo biến đồng thời khai báo thời điểm quá hạn cho cookie</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">document.cookie = &#39;username=teo; expires=Web, 15 July 2020 8:00:00 UTC&#39;;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>Hoặc đặt giờ sau bao lâu cookie sẽ hết hạn với max-age (tính bằng giây)</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">document.cookie = &#39;username=teo; max-age=84000&#39;;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4>Lấy ra giá trị tất cả các biến cookie</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> x <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<ul>\n<li>Lệnh document.cookie sẽ trả lại tất cả các biến cookie trong một chuỗi tring kiểu như: cookie1 = giá trị; cookie2 = giá trị; cookie3 = giá trị;</li>\n</ul>\n<h4>Lấy ra giá trị 1 biến cookie</h4>\n<ul>\n<li>Bạn cần viết hàm lấy giá trị của 1 cookie như sau:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getCookie</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cname</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> cname <span class=\"token operator\">+</span> <span class=\"token string\">'='</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> decodedCookie <span class=\"token operator\">=</span> <span class=\"token function\">decodeURIComponent</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> ca <span class=\"token operator\">=</span> decodedCookie<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">';'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span>ca<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">var</span> c <span class=\"token operator\">=</span> ca<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span><span class=\"token function\">charAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">' '</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            c <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> c<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>Ví dụ muốn lấy giá trị của cookie tên là abc:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> abc <span class=\"token operator\">=</span> <span class=\"token function\">getCookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">'abc'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>abc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h4>Thay đổi giá trị cookie</h4>\n<ul>\n<li>Trong javascript, có thể thay đổi 1 cookie giống như cách tạo ra cookie, tức là ghi đè giá trị mới lên cookie đã có:</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">document<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> <span class=\"token string\">\"username=ty; expires=Thu, 16 Jyly 2020 9:00:00 UTC\"</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4>Xóa 1 biến cookie</h4>\n<ul>\n<li>Để xóa một biến cookie chỉ cần gán lại giá trị ngày hết hạn expires về một thời điểm quá khứ</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">document<span class=\"token punctuation\">.</span>cookie <span class=\"token operator\">=</span> <span class=\"token string\">'username=; expires=Thu, 01 Jan 1970 00:00:00 UTC'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Kết luận</h2>\n<ul>\n<li>Vì localStorage và sessionStorage được lưu trữ trên trình duyệt của người dùng, nên các bạn cần phải xem xét nội dung lưu trữ có liên quan đến vấn đề bảo mật hay không.</li>\n<li>Và cũng chính vì localStorage và sessionStorage được lưu trữ trên trình duyệt nên việc sử dụng nó sẽ không ảnh hưởng đến hiệu xuất của trang web nhưng nó sẽ làm nặng trình duyệt của người dùng (không đáng kể).</li>\n<li>Về phạm vi: sessionStorage: giới hạn trong một cửa sổ hoăc thẻ của trình duyệt. Một trang web được mở trong hai thẻ của cùng một trình duyệt cũng không thể truy xuất dữ liệu lẫn nhau. Như vậy, khi bạn đóng trang web thì dữ liệu lưu trong sessionStorage hiện tại cũng bị xóa. Còn localStorage: có thể truy xuất lẫn nhau giữa các cửa sổ trình duyệt. Dữ liệu sẽ được lưu trữ không giới hạn thời gian.</li>\n</ul>\n<p><i>Cảm ơn mọi người đã dành thời gian đọc bài viết. Thank you!</i></p>\n<div class=\"custom-block author\"><div class=\"custom-block-heading\">Phan Trung </div><div class=\"custom-block-body\"></div></div>","id":"429b5e4b-3015-5aec-a800-34bbef8422ae","frontmatter":{"title":"Use LocalStorage, SessionStorage and Cookie","date":"21-03-2021","tags":["javascript"]},"fields":{"slug":"/use-localstorage-sessionstorage-and-cookie/","readingTime":{"text":"6 min read"}}}}]}},"pageContext":{}},"staticQueryHashes":["3963689063","63159454","81262063"]}